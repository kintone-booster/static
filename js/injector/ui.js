/*
* FileName "ui.js"
* Version: 1.0.0
* Copyright (c) 2023 Pandafirm LLC
* Distributed under the terms of the GNU Lesser General Public License.
* https://opensource.org/licenses/LGPL-2.1
*/
'use strict';window.KintoneBoosterAttachment=class{constructor(){}show(e,k=!0){kb.file.download(e).then(q=>{try{var l=()=>{var d=kb.create("a").css({display:"none"}).attr("href",kb.field.objectUrl(q,e.contentType)).attr("target","_blank").attr("download",e.name);kb.elm("body").append(d);d.click();document.body.removeChild(d)};switch(e.contentType){case "application/javascript":fetch(new Request(kb.field.objectUrl(q,e.contentType))).then(d=>d.text()).then(d=>{var f=d.split("\n");kb.create("div").append((a=>{f.each((g,
h)=>a.append(kb.create("code").css({display:"block"}).text(g)));return a})(kb.create("pre"))).popup("full","full",k?[{src:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADwAAAA8CAYAAAFN++nkAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAA1FJREFUeNpiYKA66J8y8T8ynwmfJE6dQHYAjM9CtAlIihJIcjRAANHD71hdDxIA+RVdAbKf1wMFqeRXgACiqdcbQBiXPBMB/fVQTLxmoG3riRHDlXwWgIjCnHxGJOkPMHmYOCMx0QwDaIZRBgACaDgiYMDtxydPKJE4UKIZL8AVzwZA6jySkCEwji8QtBmoUQBIgbAhTCOIDxXHX4DgSl3Y5CjyMwspaRuvn6EJfwEOtQtIyhiEEsnAAYAAGkV0A4wUFDH/KSmPmYaEj4nJpcT6niQfQw01xCFtSEqQMxLwYT+QKsDmI6RyGV4eYwmRCUC5QpIsRjJEEaj5ARmJTwFI3ccV/CxEmHEfS2svEWjYArQG33yKi3ooCAQ1MXHIzQdaRqxFjtRI1aDgA5X+ClikQdHhSE60jAKaAoAAGkWjYBSgtF8pacOyUGC3AyUOH7Cmz8izmJGUxEREvB4AVouOtGhlvod2Y7GBD0BLBWnWoMdhOUmWEh3HoDYVrKkDteADNktBaogdcGMksZnTCLSkAcnnDEiWgsTriW0KMRKZkEDd8kQiQwcUMgmEEhwLgVKJ5LiDOjARKS04kFNkCkAb9h+gwXaBgG8NoNEjQK2yGmTQeWjD/gCozQ10xAekkaL1pJbduCz+gMfVIAve4x1LxjSLuOwEjdcNVCgZN+BKI4xEpFKi4w3JhwTTA6lFJqjL2o8rQQMtm0CPFgjesfhRMAoGDAAEaNdqbxCEgWhjGKAjMAKbyAg6ATM4gWECGQE2cBRGcAS5eI1VGvt110C8F/hDSNvX69217yqPQCAQbBnF69iuikbJevrh3ywshIUwrf82Md93E7QSjpXJR81NRelE4ixEi6alQOKsRMkI4+XCo/rU7wxAiBo9xFdEsU1X0XhY3sluk5VwhHo2q5c+dTHKm8Pi3fL2LotiP6DAAvHa09ddWQofNWHXvQ8YMMh6Y2iniStJ4wTARDWpuzWKtNTgkm6ZQ4FxnawUVhEOpv26kDFblp8jLFlblqypZ61itAgMFtTVqyVkP9C3J/UWwM3q0KoAYglDUeOW0Z/GaH4i5nEO/THneh7r0vNkgGhXYdt4YBWRKoiNmHeHPe60uh++any7595pCQQCgWDLeALGLWqyLWBxZQAAAABJRU5ErkJggg==",
handler:l}]:[]).show()});break;case "application/json":fetch(new Request(kb.field.objectUrl(q,e.contentType))).then(d=>d.text()).then(d=>{kb.create("div").html(d.replace(/\n/g,"<br>")).popup("full","full",k?[{src:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADwAAAA8CAYAAAFN++nkAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAA1FJREFUeNpiYKA66J8y8T8ynwmfJE6dQHYAjM9CtAlIihJIcjRAANHD71hdDxIA+RVdAbKf1wMFqeRXgACiqdcbQBiXPBMB/fVQTLxmoG3riRHDlXwWgIjCnHxGJOkPMHmYOCMx0QwDaIZRBgACaDgiYMDtxydPKJE4UKIZL8AVzwZA6jySkCEwji8QtBmoUQBIgbAhTCOIDxXHX4DgSl3Y5CjyMwspaRuvn6EJfwEOtQtIyhiEEsnAAYAAGkV0A4wUFDH/KSmPmYaEj4nJpcT6niQfQw01xCFtSEqQMxLwYT+QKsDmI6RyGV4eYwmRCUC5QpIsRjJEEaj5ARmJTwFI3ccV/CxEmHEfS2svEWjYArQG33yKi3ooCAQ1MXHIzQdaRqxFjtRI1aDgA5X+ClikQdHhSE60jAKaAoAAGkWjYBSgtF8pacOyUGC3AyUOH7Cmz8izmJGUxEREvB4AVouOtGhlvod2Y7GBD0BLBWnWoMdhOUmWEh3HoDYVrKkDteADNktBaogdcGMksZnTCLSkAcnnDEiWgsTriW0KMRKZkEDd8kQiQwcUMgmEEhwLgVKJ5LiDOjARKS04kFNkCkAb9h+gwXaBgG8NoNEjQK2yGmTQeWjD/gCozQ10xAekkaL1pJbduCz+gMfVIAve4x1LxjSLuOwEjdcNVCgZN+BKI4xEpFKi4w3JhwTTA6lFJqjL2o8rQQMtm0CPFgjesfhRMAoGDAAEaNdqbxCEgWhjGKAjMAKbyAg6ATM4gWECGQE2cBRGcAS5eI1VGvt110C8F/hDSNvX69217yqPQCAQbBnF69iuikbJevrh3ywshIUwrf82Md93E7QSjpXJR81NRelE4ixEi6alQOKsRMkI4+XCo/rU7wxAiBo9xFdEsU1X0XhY3sluk5VwhHo2q5c+dTHKm8Pi3fL2LotiP6DAAvHa09ddWQofNWHXvQ8YMMh6Y2iniStJ4wTARDWpuzWKtNTgkm6ZQ4FxnawUVhEOpv26kDFblp8jLFlblqypZ61itAgMFtTVqyVkP9C3J/UWwM3q0KoAYglDUeOW0Z/GaH4i5nEO/THneh7r0vNkgGhXYdt4YBWRKoiNmHeHPe60uh++any7595pCQQCgWDLeALGLWqyLWBxZQAAAABJRU5ErkJggg==",
handler:l}]:[]).show()});break;case "application/pdf":"other"!=kb.device()?window.open(kb.field.objectUrl(q,e.contentType)):kb.create("iframe").css({border:"none",height:"100%",outline:"none",width:"100%"}).attr("src",kb.field.objectUrl(q,e.contentType)+"#toolbar=0&navpanes=0").popup("full","full",k?[{src:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADwAAAA8CAYAAAFN++nkAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAA1FJREFUeNpiYKA66J8y8T8ynwmfJE6dQHYAjM9CtAlIihJIcjRAANHD71hdDxIA+RVdAbKf1wMFqeRXgACiqdcbQBiXPBMB/fVQTLxmoG3riRHDlXwWgIjCnHxGJOkPMHmYOCMx0QwDaIZRBgACaDgiYMDtxydPKJE4UKIZL8AVzwZA6jySkCEwji8QtBmoUQBIgbAhTCOIDxXHX4DgSl3Y5CjyMwspaRuvn6EJfwEOtQtIyhiEEsnAAYAAGkV0A4wUFDH/KSmPmYaEj4nJpcT6niQfQw01xCFtSEqQMxLwYT+QKsDmI6RyGV4eYwmRCUC5QpIsRjJEEaj5ARmJTwFI3ccV/CxEmHEfS2svEWjYArQG33yKi3ooCAQ1MXHIzQdaRqxFjtRI1aDgA5X+ClikQdHhSE60jAKaAoAAGkWjYBSgtF8pacOyUGC3AyUOH7Cmz8izmJGUxEREvB4AVouOtGhlvod2Y7GBD0BLBWnWoMdhOUmWEh3HoDYVrKkDteADNktBaogdcGMksZnTCLSkAcnnDEiWgsTriW0KMRKZkEDd8kQiQwcUMgmEEhwLgVKJ5LiDOjARKS04kFNkCkAb9h+gwXaBgG8NoNEjQK2yGmTQeWjD/gCozQ10xAekkaL1pJbduCz+gMfVIAve4x1LxjSLuOwEjdcNVCgZN+BKI4xEpFKi4w3JhwTTA6lFJqjL2o8rQQMtm0CPFgjesfhRMAoGDAAEaNdqbxCEgWhjGKAjMAKbyAg6ATM4gWECGQE2cBRGcAS5eI1VGvt110C8F/hDSNvX69217yqPQCAQbBnF69iuikbJevrh3ywshIUwrf82Md93E7QSjpXJR81NRelE4ixEi6alQOKsRMkI4+XCo/rU7wxAiBo9xFdEsU1X0XhY3sluk5VwhHo2q5c+dTHKm8Pi3fL2LotiP6DAAvHa09ddWQofNWHXvQ8YMMh6Y2iniStJ4wTARDWpuzWKtNTgkm6ZQ4FxnawUVhEOpv26kDFblp8jLFlblqypZ61itAgMFtTVqyVkP9C3J/UWwM3q0KoAYglDUeOW0Z/GaH4i5nEO/THneh7r0vNkgGhXYdt4YBWRKoiNmHeHPe60uh++any7595pCQQCgWDLeALGLWqyLWBxZQAAAABJRU5ErkJggg==",
handler:l}]:[]).show();break;case "audio/mpeg":case "audio/x-m4a":kb.create("audio").css({outline:"none"}).attr("controls","controls").attr("src",kb.field.objectUrl(q,e.contentType)).popup(null,null,k?[{src:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADwAAAA8CAYAAAFN++nkAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAA1FJREFUeNpiYKA66J8y8T8ynwmfJE6dQHYAjM9CtAlIihJIcjRAANHD71hdDxIA+RVdAbKf1wMFqeRXgACiqdcbQBiXPBMB/fVQTLxmoG3riRHDlXwWgIjCnHxGJOkPMHmYOCMx0QwDaIZRBgACaDgiYMDtxydPKJE4UKIZL8AVzwZA6jySkCEwji8QtBmoUQBIgbAhTCOIDxXHX4DgSl3Y5CjyMwspaRuvn6EJfwEOtQtIyhiEEsnAAYAAGkV0A4wUFDH/KSmPmYaEj4nJpcT6niQfQw01xCFtSEqQMxLwYT+QKsDmI6RyGV4eYwmRCUC5QpIsRjJEEaj5ARmJTwFI3ccV/CxEmHEfS2svEWjYArQG33yKi3ooCAQ1MXHIzQdaRqxFjtRI1aDgA5X+ClikQdHhSE60jAKaAoAAGkWjYBSgtF8pacOyUGC3AyUOH7Cmz8izmJGUxEREvB4AVouOtGhlvod2Y7GBD0BLBWnWoMdhOUmWEh3HoDYVrKkDteADNktBaogdcGMksZnTCLSkAcnnDEiWgsTriW0KMRKZkEDd8kQiQwcUMgmEEhwLgVKJ5LiDOjARKS04kFNkCkAb9h+gwXaBgG8NoNEjQK2yGmTQeWjD/gCozQ10xAekkaL1pJbduCz+gMfVIAve4x1LxjSLuOwEjdcNVCgZN+BKI4xEpFKi4w3JhwTTA6lFJqjL2o8rQQMtm0CPFgjesfhRMAoGDAAEaNdqbxCEgWhjGKAjMAKbyAg6ATM4gWECGQE2cBRGcAS5eI1VGvt110C8F/hDSNvX69217yqPQCAQbBnF69iuikbJevrh3ywshIUwrf82Md93E7QSjpXJR81NRelE4ixEi6alQOKsRMkI4+XCo/rU7wxAiBo9xFdEsU1X0XhY3sluk5VwhHo2q5c+dTHKm8Pi3fL2LotiP6DAAvHa09ddWQofNWHXvQ8YMMh6Y2iniStJ4wTARDWpuzWKtNTgkm6ZQ4FxnawUVhEOpv26kDFblp8jLFlblqypZ61itAgMFtTVqyVkP9C3J/UWwM3q0KoAYglDUeOW0Z/GaH4i5nEO/THneh7r0vNkgGhXYdt4YBWRKoiNmHeHPe60uh++any7595pCQQCgWDLeALGLWqyLWBxZQAAAABJRU5ErkJggg==",
handler:l}]:[]).show();break;case "image/bmp":case "image/gif":case "image/jpeg":case "image/png":kb.create("img").css({maxHeight:"calc(100vh - 4em)",maxWidth:"calc(100vw - 2em)"}).attr("src",kb.field.objectUrl(q,e.contentType)).popup(null,null,k?[{src:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADwAAAA8CAYAAAFN++nkAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAA1FJREFUeNpiYKA66J8y8T8ynwmfJE6dQHYAjM9CtAlIihJIcjRAANHD71hdDxIA+RVdAbKf1wMFqeRXgACiqdcbQBiXPBMB/fVQTLxmoG3riRHDlXwWgIjCnHxGJOkPMHmYOCMx0QwDaIZRBgACaDgiYMDtxydPKJE4UKIZL8AVzwZA6jySkCEwji8QtBmoUQBIgbAhTCOIDxXHX4DgSl3Y5CjyMwspaRuvn6EJfwEOtQtIyhiEEsnAAYAAGkV0A4wUFDH/KSmPmYaEj4nJpcT6niQfQw01xCFtSEqQMxLwYT+QKsDmI6RyGV4eYwmRCUC5QpIsRjJEEaj5ARmJTwFI3ccV/CxEmHEfS2svEWjYArQG33yKi3ooCAQ1MXHIzQdaRqxFjtRI1aDgA5X+ClikQdHhSE60jAKaAoAAGkWjYBSgtF8pacOyUGC3AyUOH7Cmz8izmJGUxEREvB4AVouOtGhlvod2Y7GBD0BLBWnWoMdhOUmWEh3HoDYVrKkDteADNktBaogdcGMksZnTCLSkAcnnDEiWgsTriW0KMRKZkEDd8kQiQwcUMgmEEhwLgVKJ5LiDOjARKS04kFNkCkAb9h+gwXaBgG8NoNEjQK2yGmTQeWjD/gCozQ10xAekkaL1pJbduCz+gMfVIAve4x1LxjSLuOwEjdcNVCgZN+BKI4xEpFKi4w3JhwTTA6lFJqjL2o8rQQMtm0CPFgjesfhRMAoGDAAEaNdqbxCEgWhjGKAjMAKbyAg6ATM4gWECGQE2cBRGcAS5eI1VGvt110C8F/hDSNvX69217yqPQCAQbBnF69iuikbJevrh3ywshIUwrf82Md93E7QSjpXJR81NRelE4ixEi6alQOKsRMkI4+XCo/rU7wxAiBo9xFdEsU1X0XhY3sluk5VwhHo2q5c+dTHKm8Pi3fL2LotiP6DAAvHa09ddWQofNWHXvQ8YMMh6Y2iniStJ4wTARDWpuzWKtNTgkm6ZQ4FxnawUVhEOpv26kDFblp8jLFlblqypZ61itAgMFtTVqyVkP9C3J/UWwM3q0KoAYglDUeOW0Z/GaH4i5nEO/THneh7r0vNkgGhXYdt4YBWRKoiNmHeHPe60uh++any7595pCQQCgWDLeALGLWqyLWBxZQAAAABJRU5ErkJggg==",
handler:l}]:[]).show();break;case "text/plain":case "text/css":fetch(new Request(kb.field.objectUrl(q,e.contentType))).then(d=>d.text()).then(d=>{kb.create("div").html(d.replace(/\n/g,"<br>")).popup("full","full",k?[{src:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADwAAAA8CAYAAAFN++nkAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAA1FJREFUeNpiYKA66J8y8T8ynwmfJE6dQHYAjM9CtAlIihJIcjRAANHD71hdDxIA+RVdAbKf1wMFqeRXgACiqdcbQBiXPBMB/fVQTLxmoG3riRHDlXwWgIjCnHxGJOkPMHmYOCMx0QwDaIZRBgACaDgiYMDtxydPKJE4UKIZL8AVzwZA6jySkCEwji8QtBmoUQBIgbAhTCOIDxXHX4DgSl3Y5CjyMwspaRuvn6EJfwEOtQtIyhiEEsnAAYAAGkV0A4wUFDH/KSmPmYaEj4nJpcT6niQfQw01xCFtSEqQMxLwYT+QKsDmI6RyGV4eYwmRCUC5QpIsRjJEEaj5ARmJTwFI3ccV/CxEmHEfS2svEWjYArQG33yKi3ooCAQ1MXHIzQdaRqxFjtRI1aDgA5X+ClikQdHhSE60jAKaAoAAGkWjYBSgtF8pacOyUGC3AyUOH7Cmz8izmJGUxEREvB4AVouOtGhlvod2Y7GBD0BLBWnWoMdhOUmWEh3HoDYVrKkDteADNktBaogdcGMksZnTCLSkAcnnDEiWgsTriW0KMRKZkEDd8kQiQwcUMgmEEhwLgVKJ5LiDOjARKS04kFNkCkAb9h+gwXaBgG8NoNEjQK2yGmTQeWjD/gCozQ10xAekkaL1pJbduCz+gMfVIAve4x1LxjSLuOwEjdcNVCgZN+BKI4xEpFKi4w3JhwTTA6lFJqjL2o8rQQMtm0CPFgjesfhRMAoGDAAEaNdqbxCEgWhjGKAjMAKbyAg6ATM4gWECGQE2cBRGcAS5eI1VGvt110C8F/hDSNvX69217yqPQCAQbBnF69iuikbJevrh3ywshIUwrf82Md93E7QSjpXJR81NRelE4ixEi6alQOKsRMkI4+XCo/rU7wxAiBo9xFdEsU1X0XhY3sluk5VwhHo2q5c+dTHKm8Pi3fL2LotiP6DAAvHa09ddWQofNWHXvQ8YMMh6Y2iniStJ4wTARDWpuzWKtNTgkm6ZQ4FxnawUVhEOpv26kDFblp8jLFlblqypZ61itAgMFtTVqyVkP9C3J/UWwM3q0KoAYglDUeOW0Z/GaH4i5nEO/THneh7r0vNkgGhXYdt4YBWRKoiNmHeHPe60uh++any7595pCQQCgWDLeALGLWqyLWBxZQAAAABJRU5ErkJggg==",
handler:l}]:[]).show()});break;case "text/csv":fetch(new Request(kb.field.objectUrl(q,e.contentType))).then(d=>d.text()).then(d=>{var f=d.parseCSV();0!=f.length&&(a=>{f.each((g,h)=>{a.append((n=>{g.each((m,u)=>n.append(kb.create("td").css({padding:"0.25em"}).html(m.replace(/\n/g,"<br>"))));return n})(kb.create("tr")))});return a})(kb.create("table")).popup(null,"full",k?[{src:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADwAAAA8CAYAAAFN++nkAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAA1FJREFUeNpiYKA66J8y8T8ynwmfJE6dQHYAjM9CtAlIihJIcjRAANHD71hdDxIA+RVdAbKf1wMFqeRXgACiqdcbQBiXPBMB/fVQTLxmoG3riRHDlXwWgIjCnHxGJOkPMHmYOCMx0QwDaIZRBgACaDgiYMDtxydPKJE4UKIZL8AVzwZA6jySkCEwji8QtBmoUQBIgbAhTCOIDxXHX4DgSl3Y5CjyMwspaRuvn6EJfwEOtQtIyhiEEsnAAYAAGkV0A4wUFDH/KSmPmYaEj4nJpcT6niQfQw01xCFtSEqQMxLwYT+QKsDmI6RyGV4eYwmRCUC5QpIsRjJEEaj5ARmJTwFI3ccV/CxEmHEfS2svEWjYArQG33yKi3ooCAQ1MXHIzQdaRqxFjtRI1aDgA5X+ClikQdHhSE60jAKaAoAAGkWjYBSgtF8pacOyUGC3AyUOH7Cmz8izmJGUxEREvB4AVouOtGhlvod2Y7GBD0BLBWnWoMdhOUmWEh3HoDYVrKkDteADNktBaogdcGMksZnTCLSkAcnnDEiWgsTriW0KMRKZkEDd8kQiQwcUMgmEEhwLgVKJ5LiDOjARKS04kFNkCkAb9h+gwXaBgG8NoNEjQK2yGmTQeWjD/gCozQ10xAekkaL1pJbduCz+gMfVIAve4x1LxjSLuOwEjdcNVCgZN+BKI4xEpFKi4w3JhwTTA6lFJqjL2o8rQQMtm0CPFgjesfhRMAoGDAAEaNdqbxCEgWhjGKAjMAKbyAg6ATM4gWECGQE2cBRGcAS5eI1VGvt110C8F/hDSNvX69217yqPQCAQbBnF69iuikbJevrh3ywshIUwrf82Md93E7QSjpXJR81NRelE4ixEi6alQOKsRMkI4+XCo/rU7wxAiBo9xFdEsU1X0XhY3sluk5VwhHo2q5c+dTHKm8Pi3fL2LotiP6DAAvHa09ddWQofNWHXvQ8YMMh6Y2iniStJ4wTARDWpuzWKtNTgkm6ZQ4FxnawUVhEOpv26kDFblp8jLFlblqypZ61itAgMFtTVqyVkP9C3J/UWwM3q0KoAYglDUeOW0Z/GaH4i5nEO/THneh7r0vNkgGhXYdt4YBWRKoiNmHeHPe60uh++any7595pCQQCgWDLeALGLWqyLWBxZQAAAABJRU5ErkJggg==",
handler:l}]:[]).show()});break;case "video/mp4":case "video/mpeg":kb.create("video").css({maxHeight:"calc(100vh - 4em)",maxWidth:"calc(100vw - 2em)",outline:"none"}).attr("controls","controls").attr("src",kb.field.objectUrl(q,e.contentType)).popup(null,null,k?[{src:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADwAAAA8CAYAAAFN++nkAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAA1FJREFUeNpiYKA66J8y8T8ynwmfJE6dQHYAjM9CtAlIihJIcjRAANHD71hdDxIA+RVdAbKf1wMFqeRXgACiqdcbQBiXPBMB/fVQTLxmoG3riRHDlXwWgIjCnHxGJOkPMHmYOCMx0QwDaIZRBgACaDgiYMDtxydPKJE4UKIZL8AVzwZA6jySkCEwji8QtBmoUQBIgbAhTCOIDxXHX4DgSl3Y5CjyMwspaRuvn6EJfwEOtQtIyhiEEsnAAYAAGkV0A4wUFDH/KSmPmYaEj4nJpcT6niQfQw01xCFtSEqQMxLwYT+QKsDmI6RyGV4eYwmRCUC5QpIsRjJEEaj5ARmJTwFI3ccV/CxEmHEfS2svEWjYArQG33yKi3ooCAQ1MXHIzQdaRqxFjtRI1aDgA5X+ClikQdHhSE60jAKaAoAAGkWjYBSgtF8pacOyUGC3AyUOH7Cmz8izmJGUxEREvB4AVouOtGhlvod2Y7GBD0BLBWnWoMdhOUmWEh3HoDYVrKkDteADNktBaogdcGMksZnTCLSkAcnnDEiWgsTriW0KMRKZkEDd8kQiQwcUMgmEEhwLgVKJ5LiDOjARKS04kFNkCkAb9h+gwXaBgG8NoNEjQK2yGmTQeWjD/gCozQ10xAekkaL1pJbduCz+gMfVIAve4x1LxjSLuOwEjdcNVCgZN+BKI4xEpFKi4w3JhwTTA6lFJqjL2o8rQQMtm0CPFgjesfhRMAoGDAAEaNdqbxCEgWhjGKAjMAKbyAg6ATM4gWECGQE2cBRGcAS5eI1VGvt110C8F/hDSNvX69217yqPQCAQbBnF69iuikbJevrh3ywshIUwrf82Md93E7QSjpXJR81NRelE4ixEi6alQOKsRMkI4+XCo/rU7wxAiBo9xFdEsU1X0XhY3sluk5VwhHo2q5c+dTHKm8Pi3fL2LotiP6DAAvHa09ddWQofNWHXvQ8YMMh6Y2iniStJ4wTARDWpuzWKtNTgkm6ZQ4FxnawUVhEOpv26kDFblp8jLFlblqypZ61itAgMFtTVqyVkP9C3J/UWwM3q0KoAYglDUeOW0Z/GaH4i5nEO/THneh7r0vNkgGhXYdt4YBWRKoiNmHeHPe60uh++any7595pCQQCgWDLeALGLWqyLWBxZQAAAABJRU5ErkJggg==",
handler:l}]:[]).show();break;default:l()}}catch(d){kb.alert(kb.error.parse(d))}}).catch(q=>kb.alert(kb.error.parse(q)))}};
window.KintoneBoosterField=class{constructor(){this.cache={};this.reserved="CATEGORY CREATED_TIME CREATOR GROUP HR LABEL MODIFIER RECORD_NUMBER REFERENCE_TABLE SPACER STATUS STATUS_ASSIGNEE UPDATED_TIME __ID__ __REVISION__".split(" ")}activate(e,k,q=!0){var l=kb.field.parallelize(k.fields),d=()=>kb.create("div").css({zIndex:kb.popups.alert.cover.style.zIndex-4}).append(kb.create("img").attr("src","data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAB4AAAAeCAYAAAA7MK6iAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAyJpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuMy1jMDExIDY2LjE0NTY2MSwgMjAxMi8wMi8wNi0xNDo1NjoyNyAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvIiB4bWxuczp4bXBNTT0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL21tLyIgeG1sbnM6c3RSZWY9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZVJlZiMiIHhtcDpDcmVhdG9yVG9vbD0iQWRvYmUgUGhvdG9zaG9wIENTNiAoV2luZG93cykiIHhtcE1NOkluc3RhbmNlSUQ9InhtcC5paWQ6QkVGNzA3QTE1RTc4MTFFOEI5MDA5RUE2NDFCQTUzNDciIHhtcE1NOkRvY3VtZW50SUQ9InhtcC5kaWQ6QkVGNzA3QTI1RTc4MTFFOEI5MDA5RUE2NDFCQTUzNDciPiA8eG1wTU06RGVyaXZlZEZyb20gc3RSZWY6aW5zdGFuY2VJRD0ieG1wLmlpZDpCRUY3MDc5RjVFNzgxMUU4QjkwMDlFQTY0MUJBNTM0NyIgc3RSZWY6ZG9jdW1lbnRJRD0ieG1wLmRpZDpCRUY3MDdBMDVFNzgxMUU4QjkwMDlFQTY0MUJBNTM0NyIvPiA8L3JkZjpEZXNjcmlwdGlvbj4gPC9yZGY6UkRGPiA8L3g6eG1wbWV0YT4gPD94cGFja2V0IGVuZD0iciI/PkBlNTAAAADNSURBVHja7NHBCcJAFATQZNBcYwmSmycPlpI2bCVgAVqAVmAFHmxqncAKQVyz+/N/grADc0iyy0Be6ZwrlgiKhZKH83Ae/v/h1X23l9499vfZk2hYOHpgO7ZkH+xzjl9dsze2Ytfsld3MMXxhm8Hzlj1bD/eu7Zf3rf9mMvx2DaXzZ1SHh66hVP5MrTn86RpK48+qDIdcQ4nyxkRXsTcmuoq9oeAq8oaSa7I3FF2TvKHomuQNZddobxi4RnnDyHXUG0auo94wdP3p/RJgAMw4In5GE/6/AAAAAElFTkSuQmCC")).append(kb.create("span")),
f=a=>{((g,h)=>{e.elm(".kb-field-alert")?e.elm(".kb-field-alert").hide():e.elms("input,select,textarea").each((n,m)=>{n.alert&&n.alert.hide()});kb.event.call(a,{container:h,record:kb.record.get(g,k,!0).record}).then(n=>{n.error||(q?kb.event.call("kb.action.call",{container:g,record:n.record,pattern:"change",field:(m=>{var u=m.code;m.lookup&&(u=m.lookup.fieldMappings.reduce((b,p)=>{b.index<kb.field.cache[k.id].layout.indexOf(p.field)&&(b={index:kb.field.cache[k.id].layout.indexOf(p.field),field:p.field});
return b},{index:-1,field:null}),u=u.field||m.code);return u})(l[e.attr("field-id")])}).then(m=>{kb.event.call("kb.style.call",{container:g,record:m.record,pattern:"$id"in m.record?m.record.$id.value?"edit":"create":"create"}).then(u=>{kb.event.call("kb.cascade.call",u).then(b=>{kb.record.set(g,k,b.record);b=new Event("change");g.attr("unsaved","unsaved").dispatchEvent(b)}).catch(()=>{})}).catch(()=>{})}):(kb.record.set(g,k,n.record),(m=>{g.attr("unsaved","unsaved").dispatchEvent(m)})(new Event("change"))))})})(e.closest("[form-id=form_"+
k.id+"]"),e.closest(".kb-scope"))};e.attr("field-id")&&((a,g)=>{if(g.lookup)(h=>{a.elm(".kb-search").on("click",n=>{h(a.elm(".kb-lookup-search").val(),kb.extend({},g))});a.elm(".kb-clear").on("click",n=>{kb.confirm(kb.constants.common.message.confirm.delete[kb.operator.language],()=>{a.lookup("").then(()=>f("kb.change."+g.code))})});a.elm("input").on("change",n=>{h(n.currentTarget.val(),kb.extend({},g))})})((h,n)=>{this.load(n.lookup.relatedApp.app).then(m=>{(u=>{var b=()=>{n.picker=(p=>{var c={};
p.each((t,r)=>{t in u.external&&(c[t]=kb.extend({},u.external[t]))});0==Object.keys(c).length&&(c.$id={code:"$id",type:"RECORD_NUMBER",label:kb.constants.picker.caption.recordnumber[kb.operator.language],required:!1,noLabel:!1});return c})(n.lookup.lookupPickerFields);a.recordPicker.show({app:n.lookup.relatedApp.app,query:n.query,sort:n.lookup.sort||"$id asc",picker:n.picker},p=>a.lookup(p.$id.value).then(()=>f("kb.change."+n.code)))};h?(n.query=[n.lookup.filterCond,n.lookup.relatedKeyField+(["LINK",
"SINGLE_LINE_TEXT"].includes(n.type)?" like ":"=")+'"'+h+'"'].filter(p=>p).join(" and "),kb.api(kb.api.url("/api/records"),"GET",{app:n.lookup.relatedApp.app,query:n.query}).then(p=>{1==p.records.length?a.lookup(p.records.first().$id.value).then(()=>f("kb.change."+n.code)):b()}).catch(p=>kb.alert(kb.error.parse(p)))):(n.query=n.lookup.filterCond,b())})({external:m.parallelize,internal:l})})}),a.recordPicker=new KintoneBoosterRecordPicker("record"),a.lookup=(h,n)=>new Promise((m,u)=>{(b=>{var p=()=>
{kb.record.set(b,g.tableCode?k.fields[g.tableCode]:k,(()=>g.lookup.fieldMappings.reduce((c,t)=>{if(t.field in l)switch(l[t.field].type){case "CHECK_BOX":case "FILE":case "GROUP_SELECT":case "MULTI_SELECT":case "ORGANIZATION_SELECT":case "USER_SELECT":c[t.field]={value:[]};break;default:c[t.field]={value:""}}return c},(c=>{c[g.code]={value:""};return c})({})))(),!1).then(()=>m())};h?kb.api(kb.api.url("/api/record"),"GET",{app:g.lookup.relatedApp.app,id:h}).then(c=>{c.record?kb.record.set(b,g.tableCode?
k.fields[g.tableCode]:k,(()=>g.lookup.fieldMappings.reduce((t,r)=>{r.relatedField in c.record&&r.field in l&&(t[r.field]={value:c.record[r.relatedField].value});return t},(t=>{t[g.code]={value:c.record[g.lookup.relatedKeyField].value};return t})({})))(),!1).then(()=>m()):p()}).catch(c=>kb.alert(kb.error.parse(c))):n?kb.api(kb.api.url("/api/records"),"GET",{app:g.lookup.relatedApp.app,query:g.lookup.relatedKeyField+'="'+n+'"'}).then(c=>{1==c.records.length?(t=>{kb.record.set(b,g.tableCode?k.fields[g.tableCode]:
k,(()=>g.lookup.fieldMappings.reduce((r,v)=>{v.relatedField in t&&v.field in l&&(r[v.field]={value:t[v.relatedField].value});return r},(r=>{r[g.code]={value:t[g.lookup.relatedKeyField].value};return r})({})))(),!1).then(()=>m())})(c.records.first()):p()}).catch(c=>kb.alert(kb.error.parse(c))):p()})(a.closest(".kb-scope"))});else switch(g.type){case "CHECK_BOX":case "MULTI_SELECT":g.required&&(a.alert=h=>{a.elm(".kb-field-alert")||a.append(d().addClass("kb-field-alert"));a.elm(".kb-field-alert").elm("span").html(h).parentNode.show()});
break;case "COLOR":a.elm(".kb-search").on("click",h=>{kb.pickupColor(n=>{a.css({backgroundColor:n}).elm("input").val(n);f("kb.change."+g.code)})});a.elm("input").on("change",h=>{h.currentTarget.val()?(h=h.currentTarget.val().replace(/#/g,""),h.match(/([0-9A-Fa-f]{3}|[0-9A-Fa-f]{6})$/g)&&(a.css({backgroundColor:"#"+h}).elm("input").val("#"+h),f("kb.change."+g.code))):(a.css({backgroundColor:"transparent"}),f("kb.change."+g.code))});break;case "CONDITION":a.elm(".kb-search").on("click",h=>{kb.filter.build(g.app,
a.elm("input").val(),n=>{a.elm("input").val(n);f("kb.change."+g.code)})});a.reset=h=>{g.app=h;a.elm("input").val("");a.elm(".kb-guide").empty()};a.guide=h=>{a.elm(".kb-guide").append((n=>{n.append(kb.create("button").addClass("kb-icon kb-icon-del kb-guide-item-icon").on("click",m=>{kb.confirm(kb.constants.common.message.confirm.delete[kb.operator.language],()=>{a.elm("input").val(a.elm("input").val().split(" and ").filter(u=>u!=h).join(" and "));f("kb.change."+g.code)})})).append(kb.create("span").addClass("kb-guide-item-label").html(h));
return n})(kb.create("span").addClass("kb-guide-item")))};g.required&&(a.alert=h=>{a.elm(".kb-field-alert")||a.append(d().addClass("kb-field-alert"));a.elm(".kb-field-alert").elm("span").html(h).parentNode.show()});break;case "DATE":a.elm(".kb-search").on("click",h=>{kb.pickupDate(a.elm("input").val(),n=>{a.elm("input").val(n);f("kb.change."+g.code)})});break;case "DATETIME":a.elm(".kb-search").on("click",h=>{kb.pickupDate(a.elm("input").val(),n=>{a.elm("input").val(n);f("kb.change."+g.code)})});
break;case "FILE":a.elm(".kb-search").on("click",h=>{(n=>{kb.elm("body").append(n.on("change",m=>{m.currentTarget.files?(u=>{kb.file.upload(Array.from(m.currentTarget.files).first()).then(b=>{a.elm("input").val(JSON.stringify((a.elm("input").val()?JSON.parse(a.elm("input").val()):[]).concat(b)));f("kb.change."+g.code)}).catch(b=>kb.alert(kb.error.parse(b))).finally(()=>document.body.removeChild(n))})(Array.from(m.currentTarget.files).first()):document.body.removeChild(n)}));n.click()})(kb.create("input").attr("type",
"file").css({display:"none"}))});a.guide=h=>{a.elm(".kb-guide").append((n=>{n.append(kb.create("button").addClass("kb-icon kb-icon-del kb-guide-item-icon").on("click",m=>{kb.confirm(kb.constants.common.message.confirm.delete[kb.operator.language],()=>{a.elm("input").val(JSON.stringify(JSON.parse(a.elm("input").val()).filter(u=>u.fileKey!=h.fileKey)));f("kb.change."+g.code)})})).append(kb.create("span").addClass("kb-guide-item-label").html(h.name).on("click",m=>a.open(h)));return n})(kb.create("span").addClass("kb-guide-item")))};
a.open=h=>{kb.attachment.show(h,!1)};g.required&&(a.alert=h=>{a.elm(".kb-field-alert")||a.append(d().addClass("kb-field-alert"));a.elm(".kb-field-alert").elm("span").html(h).parentNode.show()});break;case "GROUP_SELECT":case "ORGANIZATION_SELECT":case "USER_SELECT":(h=>{a.elm(".kb-search").on("click",n=>{a.recordPicker.show({picker:{name:{code:"name",type:"SINGLE_LINE_TEXT",label:kb.constants.picker.caption.name[kb.operator.language],required:!1,noLabel:!0}}},m=>{(u=>{(b=>{m.each((p,c)=>{b.includes(p.code.value)||
u.push({code:p.code.value,name:p.name.value})})})(u.map(b=>b.code));a.elm("input").val(JSON.stringify(u));f("kb.change."+g.code)})(a.elm("input").val()?JSON.parse(a.elm("input").val()):[])})});a.recordPicker=new KintoneBoosterRecordPicker(h,!0,(()=>{var n=[];g.loginuser&&n.push({code:{value:"LOGINUSER()"},name:{value:"Login user"}});g.guestuser&&n.push({code:{value:"GUESTUSER()"},name:{value:"Guest user"}});return n})());a.guide=n=>{a.elm(".kb-guide").append((m=>{m.append(kb.create("button").addClass("kb-icon kb-icon-del kb-guide-item-icon").on("click",
u=>{kb.confirm(kb.constants.common.message.confirm.delete[kb.operator.language],()=>{a.elm("input").val(JSON.stringify(JSON.parse(a.elm("input").val()).filter(b=>b.code!=n.code)));f("kb.change."+g.code)})})).append(kb.create("span").addClass("kb-guide-item-label").html(n.name));return m})(kb.create("span").addClass("kb-guide-item")))};g.required&&(a.alert=n=>{a.elm(".kb-field-alert")||a.append(d().addClass("kb-field-alert"));a.elm(".kb-field-alert").elm("span").html(n).parentNode.show()})})((()=>
{var h="";switch(g.type){case "GROUP_SELECT":h="group";break;case "ORGANIZATION_SELECT":h="organization";break;case "USER_SELECT":h="user"}return h})());case "NUMBER":(h=>{a.on("show",n=>h());h()})(()=>{a.elm(".kb-unit")?a.elm("input").css({width:"calc(100% - "+a.elm(".kb-unit").outerWidth(!0)+"px)"}):a.elm("input").css({width:null})});break;case "RADIO_BUTTON":a.elms("[data-name="+g.code+"]").each((h,n)=>{h.closest("label").on("click",m=>{(u=>{a.elms("[data-name="+g.code+"]").each((b,p)=>b.checked=
u==b.val());f("kb.change."+g.code)})(h.val());m.stopPropagation();m.preventDefault()})});break;case "TIME":a.elm(".kb-hour").elm("select").on("change",h=>{h.currentTarget.val()||a.elm(".kb-minute").elm("select").val("");f("kb.change."+g.code)}),a.elm(".kb-minute").elm("select").on("change",h=>{h.currentTarget.val()||a.elm(".kb-hour").elm("select").val("");f("kb.change."+g.code)})}a.elms("input,select,textarea").each((h,n)=>{switch(g.type){case "COLOR":case "CONDITION":case "FILE":case "GROUP_SELECT":case "ORGANIZATION_SELECT":case "RADIO_BUTTON":case "TIME":case "USER_SELECT":break;
default:h.on("change",m=>f("kb.change."+g.code))}})})(e.elm(".kb-field-value"),l[e.attr("field-id")]);return e}blobToBase64(e,k){var q=new FileReader;q.onload=()=>{k(q.result.replace(/^data:.+;base64,/,""))};q.readAsDataURL(e)}create(e,k=!1){var q=l=>{l.append(kb.create("div").addClass("kb-dropdown kb-hour").append(kb.create("select").assignOption((()=>{var d=[{value:""}];(24).each(f=>d.push({value:f.toString().lpad("0",2)}));return d})(),"value","value"))).append(kb.create("div").addClass("kb-dropdown kb-minute").append(kb.create("select").assignOption((()=>
{var d=[{value:""}];(60).each(f=>d.push({value:f.toString().lpad("0",2)}));return d})(),"value","value")))};if(!("type"in e))throw Error("You shoud setup [type] in field information");return(l=>{l.append(kb.create("span").addClass("kb-field-caption").html(e.label));e.noLabel&&l.elm(".kb-field-caption").addClass("kb-hidden");l.append((d=>{switch(e.type){case "CALC":switch(e.format){case "NUMBER":case "NUMBER_DIGIT":d.addClass("kb-number")}break;case "CHECK_BOX":case "MULTI_SELECT":(a=>{a.reduce((g,
h)=>{g[h.index]=h;return g},Array(a.length).fill("")).each((g,h)=>{d.addClass("kb-checkbox").append(kb.create("label").append(kb.create("input").attr("type","checkbox").val(g.label)).append(kb.create("span").html(g.label)))})})(Object.values(e.options));break;case "COLOR":d.addClass("kb-color").append(kb.create("input").attr("type","text").attr("data-type","color")).append(kb.create("button").addClass("kb-icon kb-icon-color kb-search"));break;case "CONDITION":d.addClass("kb-condition").append(kb.create("input").attr("type",
"hidden")).append(kb.create("button").addClass("kb-icon kb-icon-filter kb-search"));break;case "CREATOR":case "CREATED_TIME":case "MODIFIER":case "UPDATED_TIME":d.append(kb.create("input").attr("type","hidden").attr("data-type",e.type.toLowerCase()));break;case "DATE":d.addClass("kb-date").append(kb.create("input").attr("type","text").attr("data-type","date")).append(kb.create("button").addClass("kb-icon kb-icon-date kb-search"));break;case "DATETIME":q(d.addClass("kb-datetime").append(kb.create("input").attr("type",
"text").attr("data-type","date")).append(kb.create("button").addClass("kb-icon kb-icon-date kb-search")));break;case "DROP_DOWN":(a=>{k?d.addClass("kb-dropdown").append(kb.create("select").assignOption([{label:""}].concat(a.reduce((g,h)=>{h.label&&(g[h.index]=h);return g},Array(a.length).fill(""))),"label","label")):d.addClass("kb-dropdown").append(kb.create("select").assignOption(a.reduce((g,h)=>{g[h.index]=h;return g},Array(a.length).fill("")),"label","label"))})(Object.values(e.options));break;
case "FILE":d.addClass("kb-file").append(kb.create("input").attr("type","hidden")).append(kb.create("button").addClass("kb-icon kb-icon-file kb-search"));break;case "GROUP_SELECT":d.addClass("kb-group").append(kb.create("input").attr("type","hidden")).append(kb.create("button").addClass("kb-icon kb-icon-group kb-search"));break;case "LINK":var f="";switch(e.protocol){case "WEB":f="url";break;case "CALL":f="tel";break;case "MAIL":f="mail"}e.lookup?d.addClass("kb-lookup").append(kb.create("input").addClass("kb-lookup-search").attr("type",
"text").attr("data-type",f)).append(kb.create("button").addClass("kb-icon kb-icon-lookup kb-search")).append(kb.create("button").addClass("kb-icon kb-icon-open kb-open")).append(kb.create("button").addClass("kb-icon kb-icon-del kb-clear")):d.addClass("kb-text").append(kb.create("input").attr("type","text").attr("data-type",f));break;case "MULTI_LINE_TEXT":case "RICH_TEXT":d.addClass("kb-textarea").append((a=>{e.lines&&a.css({height:"calc("+(1.5*parseFloat(e.lines)).toString()+"em + 2px)"});return a})(kb.create("textarea")));
break;case "NUMBER":e.lookup?d.addClass("kb-lookup").append(kb.create("input").addClass("kb-lookup-search").attr("type","text").attr("data-type","nondemiliternumber")).append(kb.create("button").addClass("kb-icon kb-icon-lookup kb-search")).append(kb.create("button").addClass("kb-icon kb-icon-open kb-open")).append(kb.create("button").addClass("kb-icon kb-icon-del kb-clear")):(d.addClass("kb-number").append((a=>{"displayScale"in e&&a.attr("data-decimals",e.displayScale);return a.attr("data-type",
e.digit?"number":"nondemiliternumber")})(kb.create("input").attr("type","text"))),e.unit&&(a=>{"BEFORE"==e.unitPosition?d.insertBefore(a,d.elm("input")):d.insertBefore(a,d.elm("input").nextElementSibling)})(kb.create("span").addClass("kb-unit").html(e.unit)));break;case "ORGANIZATION_SELECT":d.addClass("kb-organization").append(kb.create("input").attr("type","hidden")).append(kb.create("button").addClass("kb-icon kb-icon-organization kb-search"));break;case "RADIO_BUTTON":(a=>{a.reduce((g,h)=>{g[h.index]=
h;return g},Array(a.length).fill("")).each((g,h)=>{var n=d.addClass("kb-radio"),m=n.append;g=kb.create("label").append(kb.create("input").attr("type","radio").attr("data-name",e.code).val(g.label)).append(kb.create("span").html(g.label));0==h&&(g.elm("input").checked=!0);m.call(n,g)})})(Object.values(e.options));break;case "RECORD_NUMBER":d.addClass("kb-id");break;case "SINGLE_LINE_TEXT":if(e.lookup)d.addClass("kb-lookup").append(kb.create("input").addClass("kb-lookup-search").attr("type","text").attr("data-type",
"text")).append(kb.create("button").addClass("kb-icon kb-icon-lookup kb-search")).append(kb.create("button").addClass("kb-icon kb-icon-open kb-open")).append(kb.create("button").addClass("kb-icon kb-icon-del kb-clear"));else switch(e.format){case "password":d.addClass("kb-text").append(kb.create("input").attr("type","password").attr("data-type",e.type));break;default:d.addClass("kb-text").append(kb.create("input").attr("type","text").attr("data-type",e.format?e.format:"text"))}break;case "SPACER":d.html(e.contents);
break;case "STATUS_ASSIGNEE":d.append(kb.create("input").attr("type","hidden"));break;case "TIME":q(d);break;case "USER_SELECT":d.addClass("kb-user").append(kb.create("input").attr("type","hidden")).append(kb.create("button").addClass("kb-icon kb-icon-user kb-search"))}return"SPACER"!=e.type?d.append(kb.create("span").addClass("kb-guide")):d})(kb.create("div").addClass("kb-field-value")));switch(e.type){case "CALC":case "CATEGORY":case "CONDITION":case "CREATED_TIME":case "CREATOR":case "FILE":case "GROUP_SELECT":case "MODIFIER":case "ORGANIZATION_SELECT":case "RECORD_NUMBER":case "REFERENCE_TABLE":case "STATUS":case "STATUS_ASSIGNEE":case "UPDATED_TIME":case "USER_SELECT":l.elm(".kb-guide").addClass("kb-fixed")}if(e.required)switch(e.type){case "CALC":case "CATEGORY":case "CHECK_BOX":case "CONDITION":case "CREATED_TIME":case "CREATOR":case "FILE":case "GROUP_SELECT":case "MODIFIER":case "MULTI_SELECT":case "ORGANIZATION_SELECT":case "RECORD_NUMBER":case "REFERENCE_TABLE":case "STATUS":case "STATUS_ASSIGNEE":case "UPDATED_TIME":case "USER_SELECT":break;
default:l.elms("input,select,textarea").each((d,f)=>d.attr("required","required"))}e.placeholder&&l.elms("input,select,textarea").each((d,f)=>d.attr("placeholder",e.placeholder));return l})(kb.create("div").addClass("kb-field").attr("field-id",e.code))}isEmpty(e){var k=!0;if(Array.isArray(e))k=0==e.length;else switch(typeof e){case "object":k=null===e||0==Object.keys(e).length;break;case "number":k=Number.isNaN(e);break;case "string":k=0==e.toString().length}return k}load(e){return new Promise((k,
q)=>{e in this.cache?k(this.cache[e]):fetch(kb.api.url("/api/fields?app="+e),{method:"GET",headers:{"X-Requested-With":"XMLHttpRequest"}}).then(l=>{l.json().then(d=>{switch(l.status){case 200:(f=>{var a=[],g=[],h=[],n=(m,u=!0)=>m.reduce((b,p)=>{switch(p.type){case "GROUP":u&&a.push({code:p.code,fields:p.layout.flatMap(c=>c.fields)});b=b.concat(n(p.layout));break;case "ROW":u&&(g=p.fields.reduce((c,t)=>{t.elementId&&c.push(t);return c},g));b=p.fields.reduce((c,t)=>{"code"in t&&c.push(t.code);return c},
b);break;case "SUBTABLE":u?(h.push({code:p.code,fields:p.fields}),b=p.fields.reduce((c,t)=>{"code"in t&&c.push(t.code);return c},b)):b.push(p.code)}return b},[]);(m=>{m.each((u,b)=>{delete d.properties[u]})})(Object.values(d.properties).reduce((m,u)=>{switch(u.type){case "CATEGORY":u.enabled||m.push(u.code);break;case "STATUS":u.enabled||(m.push(u.code),m.push(Object.values(d.properties).filter(b=>"STATUS_ASSIGNEE"==b.type).first().code))}return m},[]));((m,u)=>{this.cache[e]={origin:((b,p)=>{b=b.reduce((t,
r)=>{t[r]=p[r];"SUBTABLE"==p[r].type&&(t[r].fields=(v=>v.fields.reduce((w,y)=>{w[y.code]=p[v.code].fields[y.code];return w},{}))(h.filter(v=>v.code==r).first()));delete p[r];return t},{});for(var c in p)b[c]=p[c];return b})(n(f,!1),kb.extend({},d.properties)),groups:a.reduce((b,p)=>{b[p.code]=d.properties[p.code];b[p.code].fields=p.fields;return b},{}),tables:h.reduce((b,p)=>{b[p.code]=(c=>{c.fields=p.fields.reduce((t,r)=>{t[r.code]=m[r.code];return t},{});return c})(d.properties[p.code]);return b},
{}),changes:(b=>{var p=[];p=Object.values(m).reduce((c,t)=>{b.includes(t.code)||c.push(t.code);return c},[]);return p.concat(h.map(c=>c.code))})((()=>{var b=[],p;for(p in m)(c=>{kb.field.reserved.includes(c.type)?b.push(c.code):(c.expression&&b.push(c.code),c.lookup&&(b.push(c.code),(t=>{t.field&&(b=b.concat(c.lookup.fieldMappings.reduce((r,v)=>{v.field!=t.field&&r.push(v.field);return r},[])))})(c.lookup.fieldMappings.reduce((t,r)=>{t.index<u.indexOf(r.field)&&(t={index:u.indexOf(r.field),field:r.field});
return t},{index:-1,field:null}))))})(m[p]);return Array.from(new Set(b))})()),criterias:(()=>{var b={};u.each((c,t)=>{["FILE","REFERENCE_TABLE"].includes(m[c].type)||(b[c]=m[c])});for(var p in m)(c=>{switch(c.type){case "CALC":case "CREATED_TIME":case "CREATOR":case "MODIFIER":case "RECORD_NUMBER":case "UPDATED_TIME":b[c.code]=c;break;case "STATUS":c.enabled&&(b[c.code]=c,(t=>{b[t.code]=t})(Object.values(m).filter(t=>"STATUS_ASSIGNEE"==t.type).first()))}})(m[p]);return b})(),disables:(()=>{var b=
[],p;for(p in m)(c=>{kb.field.reserved.includes(c.type)?b.push(c.code):(c.expression&&b.push(c.code),c.lookup&&(t=>{0!=t.length&&(b=b.concat(t))})(c.lookup.fieldMappings.map(t=>t.field)))})(m[p]);return Array.from(new Set(b))})(),layout:u,parallelize:(()=>{var b={};u.each((c,t)=>{b[c]=m[c]});for(var p in m)(c=>{switch(c.type){case "CATEGORY":c.enabled&&(b[c.code]=c);break;case "CREATED_TIME":case "CREATOR":case "MODIFIER":case "RECORD_NUMBER":case "UPDATED_TIME":b[c.code]=c;break;case "STATUS":c.enabled&&
(b[c.code]=c,(t=>{b[t.code]=t})(Object.values(m).filter(t=>"STATUS_ASSIGNEE"==t.type).first()))}})(m[p]);return b})(),placed:(()=>{var b={};u.each((p,c)=>{["REFERENCE_TABLE"].includes(m[p].type)||(b[p]=m[p])});return b})(),spacers:g,sorts:(()=>{var b={};u.each((c,t)=>{c=m[c];switch(c.type){case "CALC":case "CREATED_TIME":case "CREATOR":case "DATE":case "DATETIME":case "DROP_DOWN":case "LINK":case "MODIFIER":case "NUMBER":case "RADIO_BUTTON":case "RECORD_NUMBER":case "SINGLE_LINE_TEXT":case "TIME":case "UPDATED_TIME":c.tableCode||
(b[c.code]=c)}});for(var p in m)(c=>{switch(c.type){case "CALC":case "CREATED_TIME":case "CREATOR":case "MODIFIER":case "RECORD_NUMBER":case "UPDATED_TIME":b[c.code]=c;break;case "STATUS":c.enabled&&(b[c.code]=c)}})(m[p]);return b})()};k(this.cache[e])})(kb.field.parallelize(d.properties),n(f))})(d.layout);break;default:kb.alert(kb.error.parse(d))}})}).catch(l=>kb.alert(kb.error.parse(l)))})}parallelize(e){e=kb.extend({},e);var k={},q;for(q in e){var l=void 0,d=e[q];switch(d.type){case "SUBTABLE":var f=
d.code;for(l in d.fields)d.fields[l]=kb.extend({tableCode:f},d.fields[l]),k[d.fields[l].code]=d.fields[l];break;default:d=kb.extend({tableCode:""},d),k[d.code]=d}}return k}stringify(e,k,q,l=!1){var d="";if(e&&k)switch(e.type){case "CALC":switch(e.format){case "NUMBER":case "NUMBER_DIGIT":kb.isNumeric(k)&&(d="NUMBER_DIGIT"==e.format?Number(k).comma(e.displayScale):e.displayScale?Number(k).toFloor(parseInt(e.displayScale)):k);e.unit&&(d="BEFORE"==e.unitPosition?e.unit+" "+d:d+" "+e.unit);break;default:d=
k}break;case "CATEGORY":case "CHECK_BOX":case "MULTI_SELECT":d=k.join(q);break;case "CREATOR":case "MODIFIER":d=k.name;break;case "CREATED_TIME":case "DATETIME":case "UPDATED_TIME":d=k.parseDateTime().format("Y-m-d H:i");break;case "FILE":case "GROUP_SELECT":case "ORGANIZATION_SELECT":case "STATUS_ASSIGNEE":case "USER_SELECT":d=k.map(f=>f.name).join(q);break;case "MULTI_LINE_TEXT":case "RICH_TEXT":d=l?k:k.replace(/\n/g,"");break;case "NUMBER":kb.isNumeric(k)&&(d=e.digit?Number(k).comma(e.displayScale):
e.displayScale?Number(k).toFloor(parseInt(e.displayScale)):k);e.unit&&(d="BEFORE"==e.unitPosition?e.unit+" "+d:d+" "+e.unit);break;default:d=k}return d}objectUrl(e,k){var q=null,l=window.URL||window.webkitURL;if("string"===typeof e){var d=atob(e),f=new Uint8Array(d.length);d.length.each(a=>f[a]=d.charCodeAt(a));q=new Blob([f.buffer],{type:k})}else q=e;return l.createObjectURL(q)}};
window.KintoneBoosterRecord=class{constructor(){this.api={delete:(e,k,q=!1)=>new Promise((l,d)=>{var f=(a,g)=>{0!=k.length?kb.api(kb.api.url("/api/records"),"DELETE",{app:e,ids:k.slice(a,a+100)}).then(h=>{q||kb.progressUpdate();a+=100;0<k.slice(a,a+100).length?f(a,g):g()}).catch(h=>d(h)):g()};q||kb.progressStart(Math.ceil(k.length/100));f(0,()=>{q||kb.progressEnd();l()})}),get:(e,k,q)=>new Promise((l,d)=>{(f=>{var a=(g,h,n)=>{kb.api(kb.api.url("/api/records"),"GET",{app:e,query:k+" order by "+f+" limit 500 offset "+
h.toString()}).then(m=>{Array.prototype.push.apply(g,m.records);h+=500;500==m.records.length?a(g,h,n):n(g)}).catch(m=>d(m))};kb.api(kb.api.url("/api/records"),"GET",{app:e,query:k}).then(g=>{1E4>parseInt(g.totalCount)?a([],0,h=>l(h)):kb.api(kb.api.url("/api/cursor"),"GET",{app:e,query:k+" order by "+f}).then(h=>l(h.records)).catch(h=>d(h))}).catch(g=>d(g))})(q||"$id asc")}),set:(e,k,q=!1,l=!1)=>new Promise((d,f)=>{var a=(h,n)=>{0!=k.post.length?kb.api(kb.api.url("/api/records"),"POST",{app:e,records:(m=>
{l&&(m=m.map(u=>this.api.transform(u,"POST")));return m})(k.post.slice(h,h+100))}).then(m=>{q||kb.progressUpdate();h+=100;0<k.post.slice(h,h+100).length?a(h,n):n(m.ids.last())}).catch(m=>f(m)):n()},g=(h,n)=>{0!=k.put.length?kb.api(kb.api.url("/api/records"),"PUT",{app:e,records:(m=>{l&&(m=m.map(u=>this.api.transform(u.record)));return m})(k.put.slice(h,h+100))}).then(m=>{q||kb.progressUpdate();h+=100;0<k.put.slice(h,h+100).length?g(h,n):n()}).catch(m=>f(m)):n()};"post"in k||(k.post=[]);"put"in k||
(k.put=[]);q||kb.progressStart(Math.ceil(k.post.length/100)+Math.ceil(k.put.length/100));a(0,h=>{g(0,()=>{q||kb.progressEnd();d(h)})})}),transform:(e,k="PUT")=>{var q=null;switch(k){case "POST":q=(()=>{var l={},d;for(d in e)kb.field.reserved.includes(e[d].type)||(l[d]=e[d]);return l})();break;case "PUT":q={id:e.$id.value,record:(()=>{var l={},d;for(d in e)kb.field.reserved.includes(e[d].type)||(l[d]=e[d]);return l})()}}return q}}}clear(e,k){for(var q in k.fields)((l,d)=>{if(l)switch("SUBTABLE"!=d.type&&
(l=l.elm(".kb-field-value")),d.type){case "CHECK_BOX":case "MULTI_SELECT":l.elms("input").each((f,a)=>f.checked=!1);break;case "RADIO_BUTTON":l.elms("[data-name="+q+"]").each((f,a)=>f.checked=0==a);break;case "SUBTABLE":l.clearRows();l.addRow();break;default:l.elms("input,select,textarea").each((f,a)=>f.val(""))}})(e.elm('[field-id="'+CSS.escape(q)+'"]'),k.fields[q]);e.elm("[data-type=id]")&&e.elm("[data-type=id]").val("")}create(e,k=!0){var q={},l;for(l in e.fields)(d=>{switch(d.type){case "CHECK_BOX":case "CONDITION":case "FILE":case "GROUP_SELECT":case "MULTI_SELECT":case "ORGANIZATION_SELECT":case "USER_SELECT":q[l]=
{type:d.type,value:[]};break;case "RADIO_BUTTON":(f=>{q[l]={type:d.type,value:0!=f.length?f.reduce((a,g)=>{a[g.index]=g;return a},Array(f.length).fill("")).first().label:""}})(Object.values(d.options));break;case "SUBTABLE":q[l]={type:d.type,value:[{value:this.create(d,!1)}]};break;default:kb.field.reserved.includes(d.type)||(q[l]={type:d.type,value:""})}})(e.fields[l]);k&&(q.$id={type:"__ID__",value:""});return q}get(e,k,q){var l={error:!1,record:{}};if(!q)for(var d in k.fields)if(((f,a)=>{if(f)switch("SUBTABLE"!=
a.type&&(f=f.elm(".kb-field-value")),a.type){case "CHECK_BOX":case "MULTI_SELECT":a.required&&!f.elms("input").some(g=>g.checked)&&(f.alert(kb.constants.common.message.invalid.required[kb.operator.language]),l.error=!0);break;case "FILE":case "GROUP_SELECT":case "ORGANIZATION_SELECT":case "USER_SELECT":a.required&&(g=>{0==g.length&&(f.alert(kb.constants.common.message.invalid.required[kb.operator.language]),l.error=!0)})(f.elm("input").val()?JSON.parse(f.elm("input").val()):[]);break;case "SUBTABLE":break;
default:f.elms("input,select,textarea").each((g,h)=>{g.checkValidity()||(l.error=!0)})}})(e.elm('[field-id="'+CSS.escape(d)+'"]'),k.fields[d]),l.error)break;if(l.error)kb.alert(kb.constants.common.message.invalid.record[kb.operator.language]);else{for(d in k.fields)((f,a)=>{if(f)switch("SUBTABLE"!=a.type&&(f=f.elm(".kb-field-value")),a.type){case "CALC":l.record[a.code]={type:a.type,value:null};break;case "CHECK_BOX":case "MULTI_SELECT":l.record[a.code]={type:a.type,value:(()=>{var g=[];f.elms("input").each((h,
n)=>{h.checked&&!h.parentNode.hasClass("kb-hidden")&&g.push(h.val())});return g})()};break;case "CREATED_TIME":case "UPDATED_TIME":l.record[a.code]={type:a.type,value:f.elm("input").val()?f.elm("input").val():(new Date).format("ISO")};break;case "CREATOR":case "MODIFIER":l.record[a.code]={type:a.type,value:f.elm("input").val()?JSON.parse(f.elm("input").val()):{code:kb.operator.code,name:kb.operator.name}};break;case "DATETIME":l.record[a.code]={type:a.type,value:(()=>{var g="";f.elm("input").val()&&
(f.elm(".kb-hour").elm("select").val()||f.elm(".kb-hour").elm("select").val("00"),f.elm(".kb-minute").elm("select").val()||f.elm(".kb-minute").elm("select").val("00"));f.elm("input").val()&&f.elm(".kb-hour").elm("select").val()&&f.elm(".kb-minute").elm("select").val()&&(g=(f.elm("input").val()+" "+f.elm(".kb-hour").elm("select").val()+":"+f.elm(".kb-minute").elm("select").val()+":00").parseDateTime().format("ISO"));return g})()};break;case "DROP_DOWN":l.record[a.code]={type:a.type,value:f.elm("select").val()};
break;case "FILE":case "GROUP_SELECT":case "ORGANIZATION_SELECT":case "STATUS_ASSIGNEE":case "USER_SELECT":l.record[a.code]={type:a.type,value:f.elm("input").val()?JSON.parse(f.elm("input").val()):[]};break;case "MULTI_LINE_TEXT":case "RICH_TEXT":l.record[a.code]={type:a.type,value:f.elm("textarea").val()};break;case "NUMBER":l.record[a.code]={type:a.type,value:kb.isNumeric(f.elm("input").val())?parseFloat(f.elm("input").val()):f.elm("input").val()};break;case "RADIO_BUTTON":l.record[a.code]={type:a.type,
value:(()=>{var g="";f.elms("[data-name="+a.code+"]").each((h,n)=>{h.checked&&!h.parentNode.hasClass("kb-hidden")&&(g=h.val())});return g})()};break;case "RECORD_NUMBER":case "STATUS":l.record[a.code]={type:a.type,value:f.elm(".kb-guide").text()};break;case "SUBTABLE":l.record[a.code]={type:a.type,value:(()=>{var g=[];f.tr.each((h,n)=>{n=this.get(h,a,q);if(n.error)return l.error=n.error,KB_BREAK;g.push(h.hasAttribute("row-id")?{id:h.attr("row-id"),value:n.record}:{value:n.record})});return g})()};
break;case "TIME":l.record[a.code]={type:a.type,value:(()=>{var g="";f.elm(".kb-hour").elm("select").val()&&(f.elm(".kb-minute").elm("select").val()||f.elm(".kb-minute").elm("select").val("00"));f.elm(".kb-minute").elm("select").val()&&(f.elm(".kb-hour").elm("select").val()||f.elm(".kb-hour").elm("select").val("00"));f.elm(".kb-hour").elm("select").val()&&f.elm(".kb-minute").elm("select").val()&&(g=f.elm(".kb-hour").elm("select").val()+":"+f.elm(".kb-minute").elm("select").val());return g})()};break;
default:kb.field.reserved.includes(a.type)||(l.record[a.code]={type:a.type,value:f.elm("input").val()})}})(e.elm('[field-id="'+CSS.escape(d)+'"]'),k.fields[d]);e.elm("[data-type=id]")&&(l.record.$id={value:e.elm("[data-type=id]").val()?parseInt(e.elm("[data-type=id]").val()):e.elm("[data-type=id]").val()})}return l}set(e,k,q){return new Promise((l,d)=>{var f=(a,g,h,n)=>{var m=[],u;for(u in h)((b,p,c)=>{if(b&&c){"disabled"in c&&(c.disabled?b.addClass("kb-disabled"):b.removeClass("kb-disabled"));"hidden"in
c&&(c.hidden?(b.addClass("kb-hidden"),"SUBTABLE"==p.type&&(p.noLabel||(r=>{r&&kb.children(r).some(v=>v.hasClass("kb-table-caption"))&&r.addClass("kb-hidden")})(b.previousElementSibling))):(b.removeClass("kb-hidden"),"SUBTABLE"==p.type&&(p.noLabel||(r=>{r&&kb.children(r).some(v=>v.hasClass("kb-table-caption"))&&r.removeClass("kb-hidden")})(b.previousElementSibling))));if("SUBTABLE"!=p.type)switch(b=b.elm(".kb-field-value"),"backcolor"in c&&(c.backcolor?b.addClass("kb-force-backcolor").elm(".kb-guide").css({backgroundColor:c.backcolor}):
b.removeClass("kb-force-backcolor").elm(".kb-guide").css({backgroundColor:""})),"forecolor"in c&&(c.forecolor?b.addClass("kb-force-forecolor").elm(".kb-guide").css({color:c.forecolor}):b.removeClass("kb-force-forecolor").elm(".kb-guide").css({color:""})),"error"in c&&(b.alert?b.alert(c.error):b.elms("input,select,textarea").each((r,v)=>{r.alert&&r.alert.elm("span").html(c.error).parentNode.show()})),p.type){case "CALC":case "CATEGORY":case "CHECK_BOX":case "CONDITION":case "CREATED_TIME":case "CREATOR":case "FILE":case "GROUP_SELECT":case "MODIFIER":case "MULTI_SELECT":case "ORGANIZATION_SELECT":case "RADIO_BUTTON":case "RECORD_NUMBER":case "REFERENCE_TABLE":case "SPACER":case "STATUS":case "STATUS_ASSIGNEE":case "UPDATED_TIME":case "USER_SELECT":"backcolor"in
c&&b.css({backgroundColor:c.backcolor?c.backcolor:""});"forecolor"in c&&b.css({color:c.forecolor?c.forecolor:""});break;default:b.elms("input,select,textarea").each((r,v)=>{"backcolor"in c&&r.css({backgroundColor:c.backcolor?c.backcolor:""});"forecolor"in c&&r.css({color:c.forecolor?c.forecolor:""})})}switch(p.type){case "CALC":switch(p.format){case "NUMBER":p.displayScale?kb.isNumeric(c.value)?b.elm(".kb-guide").html(Number(c.value).toFloor(parseInt(p.displayScale))):b.elm(".kb-guide").html(c.value):
b.elm(".kb-guide").html(c.value);p.unit&&("BEFORE"==p.unitPosition?b.elm(".kb-guide").html(p.unit+" "+b.elm(".kb-guide").text()):b.elm(".kb-guide").html(b.elm(".kb-guide").text()+" "+p.unit));break;case "NUMBER_DIGIT":kb.isNumeric(c.value)?b.elm(".kb-guide").html(Number(c.value).comma(p.displayScale)):b.elm(".kb-guide").html(c.value);p.unit&&("BEFORE"==p.unitPosition?b.elm(".kb-guide").html(p.unit+" "+b.elm(".kb-guide").text()):b.elm(".kb-guide").html(b.elm(".kb-guide").text()+" "+p.unit));break;
default:b.elm(".kb-guide").html(c.value)}break;case "CATEGORY":b.elm(".kb-guide").html(c.value.join("<br>"));break;case "CHECK_BOX":case "MULTI_SELECT":b.elms("input").each((r,v)=>r.parentNode.removeClass("kb-hidden"));b.elms("input").each((r,v)=>{c.options&&(c.options.includes(r.val())||r.parentNode.addClass("kb-hidden"));r.checked=c.value.includes(r.val())});b.elm(".kb-guide").html(c.value.join("<br>"));break;case "COLOR":b.css({backgroundColor:c.value?c.value:"transparent"}).elm("input").val(c.value);
b.elm(".kb-guide").html(c.value);break;case "CONDITION":b.elm(".kb-guide").empty();c.value?(b.elm("input").val(c.value),c.value.split(" and ").each((r,v)=>b.guide(r))):b.elm("input").val("");break;case "CREATOR":case "MODIFIER":b.elm("input").val(JSON.stringify(c.value));b.elm(".kb-guide").html(c.value.name);break;case "CREATED_TIME":case "UPDATED_TIME":c.value?(b.elm("input").val(c.value),b.elm(".kb-guide").html((new Date(c.value)).format("Y-m-d H:i"))):(b.elm("input").val(""),b.elm(".kb-guide").html(""));
break;case "DATETIME":if(c.value){var t=c.value.parseDateTime();b.elm("input").val(t.format("Y-m-d"));b.elm(".kb-hour").elm("select").val(t.format("H"));b.elm(".kb-minute").elm("select").val(t.format("i"));b.elm(".kb-guide").html(t.format("Y-m-d H:i"))}else b.elm("input").val(""),b.elm(".kb-hour").elm("select").val(""),b.elm(".kb-minute").elm("select").val(""),b.elm(".kb-guide").html("");break;case "DROP_DOWN":b.elm("select").filteroption(c.options).val(c.value);b.elm(".kb-guide").html(b.elm("select").selectedText());
break;case "FILE":case "GROUP_SELECT":case "ORGANIZATION_SELECT":case "USER_SELECT":b.elm(".kb-guide").empty();c.value?(b.elm("input").val(JSON.stringify(c.value)),c.value.each((r,v)=>b.guide(r))):b.elm("input").val("[]");break;case "LINK":b.elm("input").val(c.value);b.elm(".kb-guide").empty();if(c.value)switch(p.protocol){case "MAIL":b.elm(".kb-guide").append(kb.create("a").attr("href","mailto:"+c.value).html(c.value));break;case "CALL":b.elm(".kb-guide").append(kb.create("a").attr("href","tel:"+
c.value).html(c.value));break;case "WEB":b.elm(".kb-guide").append(kb.create("a").attr("href",c.value).attr("target","_blank").html(c.value))}break;case "MULTI_LINE_TEXT":case "RICH_TEXT":b.elm("textarea").val(c.value);b.elm(".kb-guide").html(String(c.value).replace(/\n/g,"<br>"));break;case "NUMBER":c.lookup?m.push({field:b,value:c.value}):(p.digit?kb.isNumeric(c.value)?(b.elm("input").val(Number(c.value).comma(p.displayScale)),b.elm(".kb-guide").html(Number(c.value).comma(p.displayScale))):(b.elm("input").val(c.value),
b.elm(".kb-guide").html(c.value)):p.displayScale?kb.isNumeric(c.value)?(b.elm("input").val(Number(c.value).toFloor(parseInt(p.displayScale))),b.elm(".kb-guide").html(Number(c.value).toFloor(parseInt(p.displayScale)))):(b.elm("input").val(c.value),b.elm(".kb-guide").html(c.value)):(b.elm("input").val(c.value),b.elm(".kb-guide").html(c.value)),p.unit&&("BEFORE"==p.unitPosition?b.elm(".kb-guide").html(p.unit+" "+b.elm(".kb-guide").text()):b.elm(".kb-guide").html(b.elm(".kb-guide").text()+" "+p.unit)));
break;case "RADIO_BUTTON":b.elms("[data-name="+u+"]").each((r,v)=>r.parentNode.removeClass("kb-hidden"));b.elms("[data-name="+u+"]").each((r,v)=>{c.options&&(c.options.includes(r.val())||r.parentNode.addClass("kb-hidden"));r.checked=c.value==r.val()});b.elm(".kb-guide").html(c.value);break;case "RECORD_NUMBER":case "STATUS":b.elm(".kb-guide").html(c.value);break;case "SPACER":break;case "STATUS_ASSIGNEE":b.elm(".kb-guide").empty();c.value?(b.elm("input").val(JSON.stringify(c.value)),c.value.each((r,
v)=>{b.elm(".kb-guide").append(kb.create("span").addClass("kb-guide-item").append(kb.create("span").addClass("kb-guide-item-label").html(r.name)))})):b.elm("input").val("[]");break;case "SUBTABLE":if(0==c.value.length)b.clearRows();else{b.tr.each((r,v)=>{c.value.length>v&&f(r,p,(w=>{if(c.disabled)for(var y in w)w[y].disabled=!0;return w})(c.value.map(w=>w.value)[v]),w=>m=m.concat(w))});for(t=b.tr.length;t<c.value.length;t++)f(b.addRow(),p,(r=>{if(c.disabled)for(var v in r)r[v].disabled=!0;return r})(c.value.map(r=>
r.value)[t]),r=>m=m.concat(r));b.tr.slice(c.value.length).each((r,v)=>b.delRow(r))}0==b.tr.length?(r=>{c.disabled&&f(r,p,(v=>{for(var w in v)v[w].disabled=!0;return v})(this.get(r,p,!0).record),v=>m=m.concat(v))})(b.addRow()):b.tr.each((r,v)=>{"id"in c.value[v]&&r.attr("row-id",c.value[v].id)});break;case "TIME":c.value?(b.elm(".kb-hour").elm("select").val(c.value.split(":")[0]),b.elm(".kb-minute").elm("select").val(c.value.split(":")[1]),b.elm(".kb-guide").html(c.value)):(b.elm(".kb-hour").elm("select").val(""),
b.elm(".kb-minute").elm("select").val(""),b.elm(".kb-guide").html(""));break;default:c.lookup?m.push({field:b,value:c.value}):(b.elm("input").val(c.value),b.elm(".kb-guide").html(c.value))}}})(a.elm('[field-id="'+CSS.escape(u)+'"]'),g.fields[u],h[u]);"$id"in h&&a.elm("[data-type=id]")&&a.elm("[data-type=id]").val(h.$id.value);n(m)};f(e,k,q,a=>{var g=(h,n)=>{0!=a.length?a[h].field.lookup(null,a[h].value).then(()=>{h++;h<a.length?g(h,n):n()}):n(!1)};g(0,()=>{l()})})})}simplify(e,k){var q={},l;for(l in e.fields)(d=>
{switch(d.type){case "CATEGORY":case "CHECK_BOX":case "MULTI_SELECT":q[l]={value:l in k?Array.from(new Set(k[l].value.sort())):[]};break;case "CALC":case "CREATED_TIME":case "CREATOR":case "FILE":case "MODIFIER":case "RECORD_NUMBER":case "REFERENCE_TABLE":case "SPACER":case "STATUS":case "UPDATED_TIME":break;case "GROUP_SELECT":case "ORGANIZATION_SELECT":case "STATUS_ASSIGNEE":case "USER_SELECT":q[l]={value:l in k?Array.from(new Set(k[l].value.map(f=>f.code).sort())):[]};break;case "NUMBER":q[l]=
{value:l in k?kb.isNumeric(k[l].value)?k[l].value.toString():"":""};break;case "SUBTABLE":q[l]={value:k[l].value.reduce((f,a)=>{f.push({value:this.simplify(d,a.value)});return f},[])};break;default:q[l]={value:l in k?(k[l].value||" ").toString().replace(/[\r\n]*/g,""):""}}})(e.fields[l]);return q}};
window.KintoneBoosterRecordPicker=class extends KintoneBoosterDialog{constructor(e,k,q){super(999997,!1,!k);this.multiSelect=k;this.prepend=q;this.type=e;this.limit=50;this.offset=0;this.table=null;this.fieldInfo={};this.records=[];this.selection=[];this.img=this.parts.icon.clone().css({top:"0px"});this.prev=this.img.clone().css({right:"4em"}).attr("src","data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADwAAAA8CAYAAAFN++nkAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAjZJREFUeNpiYKAJ6J8y8T+MzYIm0QCk6pHFmNA016ObhqKgMCefkfoOBggg6vr9Psz/LLgCBcVb6BI4gxSvQqJMAQggugYDinNYSNVAUDOxHmbCJghNRo2ENDMSG+VASoGq6RMggIY7Agbae6Limdh4ZyGgaT2QCiAphRGbyliwaALZtJ7s5EksYCTF2ehJE6fNUIUbqFIIUFQuYUskAwcAAmgUUTP3F5CUpSi0DD07TqCZxUDLQBXBfVL1sZBpmQCQoiiPsJCRIQWoES3ENAn2AykHaic+Rlr6GF8DgJGWcUx1i4lN1TS1GF8+HpC2FqGSa+QBgAAaRaNgFBBVcJDVm6BCL4uo2ouFShYaAKnzNG/6oFkKstCALm0uarS7mMi0tJ+ujT1i+79UtRhav/ZTKwewUDubULN5S5MRO4KJC9pu+kB3i6GWC4KoAWvQkxL0hFqYJOdjqIET6BLUWCwHBbsg3S2GWv4B6vsLdLUYyQGGQMqQ5omL2IKG6omL3tluFIwCkgFAgPbN6AZAGASi1XQQR3BD3aSrGhLilzZqoQK9iwu8RLnrUfFAEORKbla63NNSRbq21KPZOCQFqJIqC133wAxJt2FU+uZsCHRPF9d+QgFzq7FJlwymgHk/U3pCdgfmgpMm7PL3p5MVIU8bsTQUpbtxcRsxB6xtI9Ka02CaPL7SLdFSLUtrDi2TwJq2ZB5YOni4ApaIlm6Bvx4eQgC/8fVQwE9sLizwnc3hbwMIgobRAdIK28oCHbudAAAAAElFTkSuQmCC").on("click",
l=>{this.offset-=this.limit;this.search()});this.next=this.img.clone().css({right:"2em"}).attr("src","data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADwAAAA8CAYAAAFN++nkAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAi1JREFUeNpiYKAa6J8y8T8Q30cXZ0LjK4AU4lMANw3GZkGXLMzJZ2QgpIskABBAVPI/Xr9DA6gBn7/rcUri9DNJACCAaO9lXICRkGZ8HmQkxWZ0g5iIdGEjNhew4NHwAKhBkWaBCxBAwwUBo+o9sWqxRZUAsamMiUDJtJ4szVAQgM8VTMRmFiAOIEszLsBCjCJcOYuQzRvwZUkWUm2jWiIZOAAQQKMIW8QV0MJcRmKyExI3EJjsNgyExchAEeiIBwNhMTIQBDriw0BYDAMfgA4QHAiLkcEBoCMcKSo1aeFjallMchxTYjFFqZpUi6mWjwes5Bp5ACCARtEoGJlNn/+0KESI7RD0U7vRTEpPRADqewN6WwwD54GWnx/Ixh5Z9TBVOn1A8B7osP6BsBgECshplzENVLZjona2JzbbUdtiogdDaGHxB2K69dS2uJDe7WqSBy+o4eMJ5IyYUOpjsksuci2+ALTQkBIXk2OxIdDSC5TGDwuJ2USQWomRidrZZBSMggEHAAHaNaMbAEEYiBLDgo7AJo7gaI7gCI5giMSAn0LLNb0XBuAlhF4LXIQQU3Q/vZfcnsPI2jNPtSZck+e66W/utCjcpPzw/DC4vAjXZPHNk/DbDxT53YvwVz6pvecACNec5aY/vAg3zb5UmUMVFitzFoSHlrklOCMa2OPQI40qLHZpIQmrlKXZwurBI06SnBYtNYUhmgdpYbj2UEIYegAwStjMiIcQQkxxA49895hLUEtfAAAAAElFTkSuQmCC").on("click",
l=>{this.offset+=this.limit;this.search()});this.submit=this.img.clone().css({left:"0"}).attr("src","data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADwAAAA8CAYAAAFN++nkAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAA7BJREFUeNpiYKAa6J8yMQFK/yfbhP9Qej7RigkpOk+U1QABRLnf92MTZ4LSDkgKHbDpNiDoHZACvIqIChCAAKIIMeLwNtxHhTn5jCTFNHoo4FLPRISZ58mJNQdCwctIauIlKRzwAYAAGqKIkUBcNwIDp4GsRAIqFoC4gBiNAaTmEOQUZkBpWfCeXJtB4AFSMRgAYoNSE9Zyg5R0TVbaRteEnK4JZkn0TAA0rIGcwPxP+4KNWAAQQKO5mVCeg2WdA8DYP0Azi6FZTACILwAtMkQSB4ndxyZHjfbNf2LaE1RNsqBMQ4phUMsdSLEDV04+gBSkRJW3pMY5E45iA2RIIxC/x9cQhEbFeiB2pHqqhlYz/TikHUGOhLZXzpNS6TNSIT2A4nY/MQUuVS0mpibD5gCqt4NwOCARaPkCuhSJ0CyZMFo5wABAAI2iUTCwLRBoLVWAVBI10NRioIUK0JYG0UUhxRaj1TiBQEs2oLWu66FcQaDcB1ItZiHUu8bmK2hQw1op78kp85lw+HY9kUGpiFRnU24xEICaMwSDD+iwBzC3UstiEJhIpBlkta+ZqJAlBahtcT2RZhhQ0+IFxDRvkdrSgVSxGJhoEqHM9wRKs/1Q9RuoGdSCSL2E+WiW7oc5Cpbl8A3Jkduufo8jAT0AWqqIRQ1RDTtSuqmw+PwANPgCWm/CgNRWJTUa9Lja03gtp0Y+xpWi5+Nr3lJsMTRFJ5JqOTV8zAANUpyW08xiIiynncV4LBekW0MO1GQiawxwFAwrABCgXau9QRCIoYQJWMENdAJlBCZQJjCOwAZugE4AG+AGygSs4AjapJra8HF3HEcx96J/jCR91uu1r8+/PDw8/k+FUGw+jzhg9gGGT+iSMjJkLoMwzgxVS5v/xKG1Jp9tA+IfIIDOPDYRMZwRRgnozogq77dxysvZvwE2Z7E4wi17h2yMyMacI5Dl1dTZDjWCixjZZKyiiFm9EAmlmjrDOvMDlc5KE9FhQOwArHU3k1MSpqgtx3FzVbRMCW8tDnURq+AyzjCe108wO4uTZ8GOykNSlYYrqWEBJiMy25Dr7SvRiWs8WuQ7OIOpSveERalg9/j5/exJeqcVYeC7gUIUBd3i+Q9R7N5y8v0n/pDl7IRbyB/e733QvxmAwK+cQE+bSmHFVjC7F5RbVRQwirgI82vPrsE6cTFuXxTPc4NHtYiLszcbEofitlG5JUJphCFbuKdLNR77FM3lZdgw48om0MU49juIO1dMPDw8PJziBXvFttyY+HdhAAAAAElFTkSuQmCC").on("click",
l=>{this.offset=0;this.search()});this.input=this.parts.input.clone().css({paddingLeft:"2em",paddingRight:"4em"}).attr("placeholder",kb.constants.common.prompt.keyword[kb.operator.language]).attr("type","text").on("keydown",l=>{if(13==(l.keyCode||l.which))return this.offset=0,this.search(),l.stopPropagation(),l.preventDefault(),!1});this.container.css({height:"calc(34em + 16px)",minWidth:"16em"});this.contents.css({padding:"0px"});this.header.css({boxShadow:"none"}).append(this.input).append(this.next).append(this.prev).append(this.submit)}search(e){switch(this.type){case "record":kb.api(kb.api.url("/api/records"),
"GET",{app:this.fieldInfo.app,query:(()=>{var k=[];this.fieldInfo.query&&k.push(this.fieldInfo.query);this.input.val()&&k.push((q=>{var l=[];q.each((d,f)=>{for(var a in this.fieldInfo.picker)switch(f=this.fieldInfo.picker[a],f.type){case "LINK":case "MULTI_LINE_TEXT":case "RICH_TEXT":case "SINGLE_LINE_TEXT":l.push(f.code+' like "'+d+'"')}});return 0!=l.length?"("+l.join(" or ")+")":""})(this.input.val().split(/[ \u3000]/).filter(q=>q)));return k.join(" and ")+" order by "+(this.fieldInfo.sort?this.fieldInfo.sort:
"$id asc")+" limit "+this.limit+" offset "+this.offset})()}).then(k=>{this.records=k.records;this.table.clearRows();this.records.each((q,l)=>{(d=>{kb.record.set(d,{fields:this.fieldInfo.picker},q);this.multiSelect&&this.selection.some(f=>f.$id.value==q.$id.value)&&d.css({backgroundColor:"rgba(66,165,245,0.5)",color:""})})(this.table.addRow())});0<this.offset?this.prev.show():this.prev.hide();this.offset+(this.limit==this.records.length?this.limit:this.records.length)<parseInt(k.totalCount)?this.next.show():
this.next.hide();e&&e()}).catch(k=>kb.alert(kb.error.parse(k)));break;default:(()=>{var k=(()=>{var q=this.prepend?this.prepend.concat(kb.roleSet[this.type]):kb.extend({},kb.roleSet[this.type]);this.input.val()&&(l=>{q=q.filter(d=>{var f=!1;d.name.value&&(f=l.some(a=>d.name.value.match(new RegExp(a,"ig"))));return f})})(this.input.val().replace(/[\u3000 ]+/g," ").split(" ").filter(l=>l));return q})();this.records=k.slice(this.offset,this.offset+this.limit);this.table.clearRows();this.records.each((q,
l)=>{(d=>{kb.record.set(d,{fields:this.fieldInfo.picker},q);this.multiSelect&&this.selection.some(f=>f.code.value==q.code.value)&&d.css({backgroundColor:"rgba(66,165,245,0.5)",color:""})})(this.table.addRow())});0<this.offset?this.prev.show():this.prev.hide();this.offset+(this.limit==this.records.length?this.limit:this.records.length)<k.length?this.next.show():this.next.hide();e&&e()})()}}show(e,k){var q=this.parts.div.clone().css({borderTop:"1px solid #42a5f5",borderBottom:"1px solid #42a5f5",lineHeight:"2em",
padding:"0px 0.5em"}),l=this.parts.td.clone().css({cursor:"pointer",padding:"0",userSelect:"none"}),d=this.parts.th.clone().css({backgroundColor:kb.themeColor().backcolor});this.offset=0;this.fieldInfo=e;this.records=[];this.selection=[];this.input.val("");this.table=this.parts.table.clone().css({marginBottom:"0.5em"}).append(kb.create("thead").append(kb.create("tr"))).append(kb.create("tbody").append(kb.create("tr")));for(var f in this.fieldInfo.picker)(a=>{this.table.elm("thead tr").append(d.clone().append(q.clone().html("label"in
a?a.label:"")));var g=this.table.elm("tbody tr"),h=g.append,n=l.clone(),m=n.append,u=kb.field,b=u.create;a=kb.extend({},a);a.noLabel=!0;h.call(g,m.call(n,b.call(u,a).css({width:"100%"}).addClass("kb-picker kb-readonly")))})(this.fieldInfo.picker[f]);this.contents.empty().append(this.table.spread((a,g)=>{a.on("click",h=>{(n=>{this.multiSelect?(m=>{m.length==this.selection.length?(this.selection.push(kb.extend({},n)),a.css({backgroundColor:"rgba(66,165,245,0.5)",color:""})):(this.selection=m,a.css({backgroundColor:"transparent",
color:kb.themeColor().forecolor}))})(this.selection.filter(m=>"record"==this.type?m.$id.value!=n.$id.value:m.code.value!=n.code.value)):(k&&k(n),this.hide())})(this.records[g])});(h=>{a.addClass("kb-scope").elms(".kb-field").each((n,m)=>kb.field.activate(n,h))})({id:"recordPicker",fields:kb.extend({},this.fieldInfo.picker)})}));this.multiSelect&&(this.handler&&this.ok.off("click",this.handler),this.handler=a=>{k&&k(this.selection);this.hide()},this.ok.on("click",this.handler),this.cancel.on("click",
a=>this.hide()));this.search(()=>super.show())}};
window.KintoneBoosterTable=class{constructor(){}activate(e,k){return e.spread((q,l)=>{(d=>{q.elm(".kb-table-row-add").on("click",f=>{e.insertRow(q);kb.event.call("kb.row.add."+e.attr("field-id"),{container:e,record:kb.record.get(d,k,!0).record,rowindex:parseInt(q.attr("row-idx"))+1}).then(a=>{a.error?e.delRow(q):kb.event.call("kb.action.call",{container:d,record:a.record,pattern:"change",field:e.attr("field-id")}).then(g=>{kb.event.call("kb.style.call",{container:d,record:g.record,pattern:"$id"in
g.record?g.record.$id.value?"edit":"create":"create"}).then(h=>{kb.event.call("kb.cascade.call",h).then(n=>{kb.record.set(d,k,n.record);n=new Event("change");d.attr("unsaved","unsaved").dispatchEvent(n)}).catch(()=>{})}).catch(()=>{})})})});q.elm(".kb-table-row-copy").on("click",f=>{e.insertRow(q);kb.event.call("kb.row.copy."+e.attr("field-id"),{container:e,record:((a,g)=>{a[e.attr("field-id")].value[g+1]={value:kb.extend({},a[e.attr("field-id")].value[g].value)};return a})(kb.record.get(d,k,!0).record,
parseInt(q.attr("row-idx"))),rowindex:parseInt(q.attr("row-idx"))+1}).then(a=>{a.error?e.delRow(q):kb.event.call("kb.action.call",{container:d,record:a.record,pattern:"change",field:e.attr("field-id")}).then(g=>{kb.event.call("kb.style.call",{container:d,record:g.record,pattern:"$id"in g.record?g.record.$id.value?"edit":"create":"create"}).then(h=>{kb.event.call("kb.cascade.call",h).then(n=>{kb.record.set(d,k,n.record);n=new Event("change");d.attr("unsaved","unsaved").dispatchEvent(n)}).catch(()=>
{})}).catch(()=>{})})})});q.elm(".kb-table-row-del").on("click",f=>{kb.confirm(kb.constants.common.message.confirm.delete[kb.operator.language],()=>{kb.event.call("kb.row.del."+e.attr("field-id"),{container:e,record:kb.record.get(d,k,!0).record,rowindex:parseInt(q.attr("row-idx"))}).then(a=>{a.error||(e.delRow(q),kb.event.call("kb.action.call",{container:d,record:kb.record.get(d,k,!0).record,pattern:"change",field:e.attr("field-id")}).then(g=>{kb.event.call("kb.style.call",{container:d,record:g.record,
pattern:"$id"in g.record?g.record.$id.value?"edit":"create":"create"}).then(h=>{kb.event.call("kb.cascade.call",h).then(n=>{kb.record.set(d,k,n.record);n=new Event("change");d.attr("unsaved","unsaved").dispatchEvent(n)}).catch(()=>{})}).catch(()=>{})}))})})});q.elms(".kb-field").each((f,a)=>kb.field.activate(f,k));e.tr.each((f,a)=>f.attr("row-idx",a))})(e.closest("[form-id=form_"+k.id+"]"))},(q,l)=>{0==q.tr.length?q.addRow():q.tr.each((d,f)=>d.attr("row-idx",f))},!1)}create(e,k,q,l,d){return(f=>{q||
l||f.append(kb.create("thead").append(kb.create("tr")));f.append(kb.create("tbody").append(kb.create("tr").addClass("kb-scope").attr("row-idx","")));for(var a in e.fields)(g=>{q||l||f.elm("thead tr").append(kb.create("th").append(kb.create("span").html(g.label)));var h=f.elm("tbody tr"),n=h.append,m=kb.create("td"),u=m.append,b=kb.field,p=b.create;g=kb.extend({},g);l||(g.noLabel=!0);n.call(h,u.call(m,p.call(b,g,d)))})(e.fields[a]);q||l||f.elm("thead tr").append(kb.create("th").addClass("kb-table-button"+
(k?" kb-table-button-extension":"")));f.elm("tbody tr").append(kb.create("td").addClass("kb-table-button"+(k?" kb-table-button-extension":"")).append(kb.create("button").addClass("kb-icon kb-icon-add kb-table-row-add")).append(kb.create("button").addClass("kb-icon kb-icon-copy kb-table-row-copy").css({display:k?"inline-block":"none"})).append(kb.create("button").addClass("kb-icon kb-icon-del kb-table-row-del")));for(a in e.fields)(g=>{g.lookup&&g.lookup.fieldMappings.each((h,n)=>{h.field in e.fields&&
f.elm('[field-id="'+CSS.escape(h.field)+'"]')&&f.elm('[field-id="'+CSS.escape(h.field)+'"]').addClass("kb-readonly")})})(e.fields[a]);return f.attr("field-id",e.code)})(kb.create("table").addClass("kb-table"))}};
window.KintoneBoosterView=class{constructor(){}create(e,k,q){var l={key:()=>"view_"+k.id+"_"+q+"_"+location.host.split(".").first(),set:d=>{var f=l.key(),a="[view-id=view_"+k.id+"_"+q+"] .kb-guide{min-width:auto !important;}";kb.elm("[view-id=view_"+k.id+"_"+q+"]").elms(".kb-view-head-resizer").each((g,h)=>{h=g.closest(".kb-view-head-cell");if(!h.hasClass("kb-unuse")){g=h.attr("column-id");var n=150;d||kb.elm(".kb_spread_style_"+CSS.escape(f))&&kb.elm(".kb_spread_style_"+CSS.escape(f)).text().match(new RegExp('\\[column-id="'+
CSS.escape(g)+'"\\]',"g"))&&(n=h.outerWidth(!1));h=n;a+="[view-id=view_"+k.id+"_"+q+'] [column-id="'+CSS.escape(g)+'"]{max-width:'+h+"px;width:"+h+"px;}";a+="[view-id=view_"+k.id+"_"+q+'] [field-id="'+CSS.escape(g)+'"]{width:'+h+"px;}"}});kb.elm(".kb_spread_style_"+CSS.escape(f))&&kb.elm("head").removeChild(kb.elm(".kb_spread_style_"+CSS.escape(f)));kb.elm("head").append(kb.create("style").addClass("kb_spread_style_"+f).attr("type","text/css").text(a));localStorage.setItem(f,a)}};return e.append(((d,
f,a)=>{var g=0,h="kb-view-button_shave"+(a.edit?"3":"4"),n=(m,u)=>{var b=m.changedTouches?Array.from(m.changedTouches).first():m,p=m.currentTarget.closest(".kb-view-head-cell"),c=b.pageX,t=m.currentTarget.closest(".kb-view-head-cell").outerWidth(!1),r={move:v=>{var w=!1,y=v.changedTouches?Array.from(v.changedTouches).first():v,x=t+y.pageX-c;p.css({maxWidth:x.toString()+"px",width:x.toString()+"px"});d.elms('[field-id="'+CSS.escape(u)+'"]').each((z,A)=>z.css({width:x.toString()+"px"}));d.elms('[field-id="'+
CSS.escape(u)+'"]').each((z,A)=>{x<z.outerWidth(!1)&&(x=z.outerWidth(!1),w=!0)});w&&p.css({maxWidth:x.toString()+"px",width:x.toString()+"px"});v.stopPropagation();v.preventDefault()},end:v=>{l.set();kb.elm("body").removeClass("kb-resizing");window.off("mousemove,touchmove",r.move);window.off("mouseup,touchend",r.end);v.stopPropagation();v.preventDefault()}};kb.elm("body").addClass("kb-resizing");window.on("mousemove,touchmove",r.move);window.on("mouseup,touchend",r.end);m.stopPropagation();m.preventDefault()};
d.append(kb.create("thead").append(kb.create("tr").addClass("kb-view-head"))).append(kb.create("tbody").append(kb.create("tr").addClass("kb-view-row")));d.elm("thead tr").append(kb.create("th").addClass("kb-view-head-cell kb-view-button "+h+" kb-view-guide"));d.elm("tbody tr").append(kb.create("td").addClass("kb-view-button "+h+" kb-view-guide").append(kb.create("button").addClass("kb-icon kb-icon-edit kb-view-row-edit"+(a.edit?"":" kb-unuse"))));(m=>{m.concat(Object.keys(f.fields).filter(u=>!m.includes(u))).each((u,
b)=>{((p,c)=>{switch(p.type){case "SUBTABLE":for(var t in p.fields)d.elm("thead tr").append(((r,v)=>{c||g++;return r.addClass("kb-view-head-cell"+(c?" kb-unuse":"")).attr("column-id",v.code).append(kb.create("span").addClass("kb-view-head-caption").html(v.label)).append(kb.create("span").addClass("kb-view-head-resizer").on("mousedown,touchstart",w=>n(w,v.code)))})(kb.create("th"),p.fields[t])),p.fields[t].noLabel=!0;break;default:d.elm("thead tr").append((r=>{c||g++;return r.addClass("kb-view-head-cell"+
(c?" kb-unuse":"")).attr("column-id",p.code).append(kb.create("span").addClass("kb-view-head-caption").html(p.label)).append(kb.create("span").addClass("kb-view-head-resizer").on("mousedown,touchstart",v=>n(v,p.code)))})(kb.create("th"))),p.noLabel=!0}})(f.fields[u],0!=a.fields.length?!a.fields.includes(u):!1)});d.elm("tbody tr").append((u=>{m.concat(Object.keys(f.fields).filter(b=>!m.includes(b))).each((b,p)=>{p=f.fields[b];b=0!=a.fields.length?!a.fields.includes(b):!1;switch(p.type){case "SUBTABLE":u.append(kb.create("div").addClass("kb-view-row-cell"+
(b?" kb-unuse":"")).append(kb.table.create(p,!0,!0,!1,!0)));break;default:u.append(kb.field.create(p,!0).addClass("kb-view-row-cell"+(b?" kb-unuse":"")))}});return u.append(kb.create("input").attr("type","hidden").attr("data-type","id"))})(kb.create("td").addClass("kb-scope").attr("form-id","form_"+f.id).attr("colspan",g.toString())))})(0!=a.fields.length?a.fields:Object.keys(f.fields));d.elms(".kb-field").each((m,u)=>m.addClass("kb-readonly"));d.elms(".kb-table-button").each((m,u)=>m.addClass("kb-readonly"));
return d.spread((m,u)=>{m.elm(".kb-view-row-edit").on("click",b=>{kb.event.call("kb.edit.call",{recordId:m.elm("[data-type=id]").val()})});m.elms(".kb-field").each((b,p)=>{b.closest(".kb-scope").hasAttribute("form-id")&&kb.field.activate(b,f)});m.elms(".kb-table").each((b,p)=>{kb.table.activate(b,f).clearRows();b.addRow()})},(m,u)=>{},!1)})(kb.create("table").addClass("kb-view").attr("view-id","view_"+k.id+"_"+q),kb.extend({},k),kb.extend({},k).view)).on("show",d=>{d=l.key();kb.elm(".kb_spread_style_"+
CSS.escape(d))||(localStorage.getItem(d)?(kb.elm("head").append(kb.create("style").addClass("kb_spread_style_"+d).attr("type","text/css").text(localStorage.getItem(d))),l.set()):0!=kb.elm("[view-id=view_"+k.id+"_"+q+"]").elm("tbody").elms("tr").length&&l.set(!0))})}};
kb.constants=kb.extend({common:{caption:{button:{cancel:{en:"Cancel",ja:"\u30ad\u30e3\u30f3\u30bb\u30eb",zh:"\u53d6\u6d88","zh-TW":"\u53d6\u6d88"},submit:{en:"Submit",ja:"\u4fdd\u5b58",zh:"\u4fdd\u5b58","zh-TW":"\u4fdd\u5b58"}},sort:{asc:{en:"asc",ja:"\u6607\u9806",zh:"\u5347\u5e8f","zh-TW":"\u5347\u5e8f"},desc:{en:"desc",ja:"\u964d\u9806",zh:"\u964d\u5e8f","zh-TW":"\u964d\u5e8f"}}},message:{confirm:{changed:{en:"Changes have not been saved.<br>Do you want to leave the page?",ja:"\u5909\u66f4\u304c\u4fdd\u5b58\u3055\u308c\u3066\u3044\u307e\u305b\u3093\u3002<br>\u3053\u306e\u307e\u307e\u30da\u30fc\u30b8\u3092\u79fb\u52d5\u3057\u307e\u3059\u304b\uff1f",
zh:"\u66f4\u6539\u5c1a\u672a\u4fdd\u5b58\u3002<br>\u60a8\u662f\u5426\u8981\u79bb\u5f00\u6b64\u9875\u9762\uff1f","zh-TW":"\u66f4\u6539\u5c1a\u672a\u4fdd\u5b58\u3002<br>\u60a8\u662f\u5426\u8981\u96e2\u958b\u6b64\u9801\u9762\uff1f"},cancel:{en:"The edits you made will be lost. Are you sure?",ja:"\u7de8\u96c6\u3057\u305f\u5185\u5bb9\u304c\u5931\u308f\u308c\u307e\u3059\u304c\u3001\u3088\u308d\u3057\u3044\u3067\u3059\u304b\uff1f",zh:"\u60a8\u7f16\u8f91\u7684\u5185\u5bb9\u5c06\u4f1a\u4e22\u5931\uff0c\u786e\u5b9a\u5417\uff1f",
"zh-TW":"\u60a8\u7de8\u8f2f\u7684\u5167\u5bb9\u5c07\u6703\u4e1f\u5931\uff0c\u78ba\u5b9a\u55ce\uff1f"},copy:{en:"Are you sure on copy?",ja:"\u30b3\u30d4\u30fc\u3057\u3066\u3082\u3088\u308d\u3057\u3044\u3067\u3059\u304b\uff1f",zh:"\u6211\u53ef\u4ee5\u590d\u5236\u5417\uff1f","zh-TW":"\u78ba\u5b9a\u8981\u8907\u88fd\u55ce\uff1f"},delete:{en:"Are you sure on delete?",ja:"\u524a\u9664\u3057\u3066\u3082\u3088\u308d\u3057\u3044\u3067\u3059\u304b\uff1f",zh:"\u6211\u53ef\u4ee5\u5220\u9664\u5417\uff1f","zh-TW":"\u78ba\u5b9a\u8981\u522a\u9664\u55ce\uff1f"},
save:{en:"Are you sure on copy?",ja:"\u4fdd\u5b58\u3057\u3066\u3082\u3088\u308d\u3057\u3044\u3067\u3059\u304b\uff1f",zh:"\u6211\u53ef\u4ee5\u4fdd\u5b58\u5417\uff1f","zh-TW":"\u78ba\u5b9a\u8981\u5132\u5b58\u55ce\uff1f"},submit:{en:"Are you sure on submit?",ja:"\u9001\u4fe1\u3057\u3066\u3082\u3088\u308d\u3057\u3044\u3067\u3059\u304b\uff1f",zh:"\u6211\u53ef\u4ee5\u53d1\u9001\u5417\uff1f","zh-TW":"\u78ba\u5b9a\u8981\u9001\u51fa\u55ce\uff1f"}},invalid:{record:{en:"There is an error in the input data.",
ja:"\u5165\u529b\u5185\u5bb9\u306b\u8aa4\u308a\u304c\u3042\u308a\u307e\u3059\u3002",zh:"\u8f93\u5165\u5185\u5bb9\u6709\u8bef\u3002","zh-TW":"\u8f38\u5165\u5167\u5bb9\u6709\u8aa4\u3002"},submit:{en:"No data to submit was found.",ja:"\u7de8\u96c6\u4e2d\u306e\u30c7\u30fc\u30bf\u304c\u3042\u308a\u307e\u305b\u3093\u3002",zh:"\u6b63\u5728\u7f16\u8f91\u7684\u6570\u636e\u4e0d\u5b58\u5728\u3002","zh-TW":"\u6b63\u5728\u7de8\u8f2f\u7684\u6578\u64da\u4e0d\u5b58\u5728\u3002"}}}},picker:{caption:{name:{en:"Name",
ja:"\u8868\u793a\u540d",zh:"\u663e\u793a\u540d\u79f0","zh-TW":"\u986f\u793a\u540d\u7a31"},recordnumber:{en:"Record number",ja:"\u30ec\u30b3\u30fc\u30c9\u756a\u53f7",zh:"\u8bb0\u5f55\u53f7","zh-TW":"\u8a18\u9304\u865f"}}}},kb.constants);
