/*
* FileName "ui.js"
* Version: 1.0.0
* Copyright (c) 2023 Pandafirm LLC
* Distributed under the terms of the GNU Lesser General Public License.
* https://opensource.org/licenses/LGPL-2.1
*/
'use strict';window.KintoneBoosterAttachment=class{constructor(){}show(d,k=!0){kb.file.download(d).then(m=>{try{var g=()=>{var c=kb.create("a").css({display:"none"}).attr("href",kb.field.objectUrl(m,d.contentType)).attr("target","_blank").attr("download",d.name);kb.elm("body").append(c);c.click();document.body.removeChild(c)};switch(d.contentType){case "application/javascript":fetch(new Request(kb.field.objectUrl(m,d.contentType))).then(c=>c.text()).then(c=>{var b=c.split("\n");kb.create("div").append((a=>
{b.each((f,l)=>a.append(kb.create("code").css({display:"block"}).text(f)));return a})(kb.create("pre"))).popup("full","full",k?[{src:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADwAAAA8CAYAAAFN++nkAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAA1FJREFUeNpiYKA66J8y8T8ynwmfJE6dQHYAjM9CtAlIihJIcjRAANHD71hdDxIA+RVdAbKf1wMFqeRXgACiqdcbQBiXPBMB/fVQTLxmoG3riRHDlXwWgIjCnHxGJOkPMHmYOCMx0QwDaIZRBgACaDgiYMDtxydPKJE4UKIZL8AVzwZA6jySkCEwji8QtBmoUQBIgbAhTCOIDxXHX4DgSl3Y5CjyMwspaRuvn6EJfwEOtQtIyhiEEsnAAYAAGkV0A4wUFDH/KSmPmYaEj4nJpcT6niQfQw01xCFtSEqQMxLwYT+QKsDmI6RyGV4eYwmRCUC5QpIsRjJEEaj5ARmJTwFI3ccV/CxEmHEfS2svEWjYArQG33yKi3ooCAQ1MXHIzQdaRqxFjtRI1aDgA5X+ClikQdHhSE60jAKaAoAAGkWjYBSgtF8pacOyUGC3AyUOH7Cmz8izmJGUxEREvB4AVouOtGhlvod2Y7GBD0BLBWnWoMdhOUmWEh3HoDYVrKkDteADNktBaogdcGMksZnTCLSkAcnnDEiWgsTriW0KMRKZkEDd8kQiQwcUMgmEEhwLgVKJ5LiDOjARKS04kFNkCkAb9h+gwXaBgG8NoNEjQK2yGmTQeWjD/gCozQ10xAekkaL1pJbduCz+gMfVIAve4x1LxjSLuOwEjdcNVCgZN+BKI4xEpFKi4w3JhwTTA6lFJqjL2o8rQQMtm0CPFgjesfhRMAoGDAAEaNdqbxCEgWhjGKAjMAKbyAg6ATM4gWECGQE2cBRGcAS5eI1VGvt110C8F/hDSNvX69217yqPQCAQbBnF69iuikbJevrh3ywshIUwrf82Md93E7QSjpXJR81NRelE4ixEi6alQOKsRMkI4+XCo/rU7wxAiBo9xFdEsU1X0XhY3sluk5VwhHo2q5c+dTHKm8Pi3fL2LotiP6DAAvHa09ddWQofNWHXvQ8YMMh6Y2iniStJ4wTARDWpuzWKtNTgkm6ZQ4FxnawUVhEOpv26kDFblp8jLFlblqypZ61itAgMFtTVqyVkP9C3J/UWwM3q0KoAYglDUeOW0Z/GaH4i5nEO/THneh7r0vNkgGhXYdt4YBWRKoiNmHeHPe60uh++any7595pCQQCgWDLeALGLWqyLWBxZQAAAABJRU5ErkJggg==",
handler:g}]:[]).show()});break;case "application/json":fetch(new Request(kb.field.objectUrl(m,d.contentType))).then(c=>c.text()).then(c=>{kb.create("div").html(c.replace(/\n/g,"<br>")).popup("full","full",k?[{src:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADwAAAA8CAYAAAFN++nkAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAA1FJREFUeNpiYKA66J8y8T8ynwmfJE6dQHYAjM9CtAlIihJIcjRAANHD71hdDxIA+RVdAbKf1wMFqeRXgACiqdcbQBiXPBMB/fVQTLxmoG3riRHDlXwWgIjCnHxGJOkPMHmYOCMx0QwDaIZRBgACaDgiYMDtxydPKJE4UKIZL8AVzwZA6jySkCEwji8QtBmoUQBIgbAhTCOIDxXHX4DgSl3Y5CjyMwspaRuvn6EJfwEOtQtIyhiEEsnAAYAAGkV0A4wUFDH/KSmPmYaEj4nJpcT6niQfQw01xCFtSEqQMxLwYT+QKsDmI6RyGV4eYwmRCUC5QpIsRjJEEaj5ARmJTwFI3ccV/CxEmHEfS2svEWjYArQG33yKi3ooCAQ1MXHIzQdaRqxFjtRI1aDgA5X+ClikQdHhSE60jAKaAoAAGkWjYBSgtF8pacOyUGC3AyUOH7Cmz8izmJGUxEREvB4AVouOtGhlvod2Y7GBD0BLBWnWoMdhOUmWEh3HoDYVrKkDteADNktBaogdcGMksZnTCLSkAcnnDEiWgsTriW0KMRKZkEDd8kQiQwcUMgmEEhwLgVKJ5LiDOjARKS04kFNkCkAb9h+gwXaBgG8NoNEjQK2yGmTQeWjD/gCozQ10xAekkaL1pJbduCz+gMfVIAve4x1LxjSLuOwEjdcNVCgZN+BKI4xEpFKi4w3JhwTTA6lFJqjL2o8rQQMtm0CPFgjesfhRMAoGDAAEaNdqbxCEgWhjGKAjMAKbyAg6ATM4gWECGQE2cBRGcAS5eI1VGvt110C8F/hDSNvX69217yqPQCAQbBnF69iuikbJevrh3ywshIUwrf82Md93E7QSjpXJR81NRelE4ixEi6alQOKsRMkI4+XCo/rU7wxAiBo9xFdEsU1X0XhY3sluk5VwhHo2q5c+dTHKm8Pi3fL2LotiP6DAAvHa09ddWQofNWHXvQ8YMMh6Y2iniStJ4wTARDWpuzWKtNTgkm6ZQ4FxnawUVhEOpv26kDFblp8jLFlblqypZ61itAgMFtTVqyVkP9C3J/UWwM3q0KoAYglDUeOW0Z/GaH4i5nEO/THneh7r0vNkgGhXYdt4YBWRKoiNmHeHPe60uh++any7595pCQQCgWDLeALGLWqyLWBxZQAAAABJRU5ErkJggg==",
handler:g}]:[]).show()});break;case "application/pdf":"other"!=kb.device()?window.open(kb.field.objectUrl(m,d.contentType)):kb.create("iframe").css({border:"none",height:"100%",outline:"none",width:"100%"}).attr("src",kb.field.objectUrl(m,d.contentType)+"#toolbar=0&navpanes=0").popup("full","full",k?[{src:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADwAAAA8CAYAAAFN++nkAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAA1FJREFUeNpiYKA66J8y8T8ynwmfJE6dQHYAjM9CtAlIihJIcjRAANHD71hdDxIA+RVdAbKf1wMFqeRXgACiqdcbQBiXPBMB/fVQTLxmoG3riRHDlXwWgIjCnHxGJOkPMHmYOCMx0QwDaIZRBgACaDgiYMDtxydPKJE4UKIZL8AVzwZA6jySkCEwji8QtBmoUQBIgbAhTCOIDxXHX4DgSl3Y5CjyMwspaRuvn6EJfwEOtQtIyhiEEsnAAYAAGkV0A4wUFDH/KSmPmYaEj4nJpcT6niQfQw01xCFtSEqQMxLwYT+QKsDmI6RyGV4eYwmRCUC5QpIsRjJEEaj5ARmJTwFI3ccV/CxEmHEfS2svEWjYArQG33yKi3ooCAQ1MXHIzQdaRqxFjtRI1aDgA5X+ClikQdHhSE60jAKaAoAAGkWjYBSgtF8pacOyUGC3AyUOH7Cmz8izmJGUxEREvB4AVouOtGhlvod2Y7GBD0BLBWnWoMdhOUmWEh3HoDYVrKkDteADNktBaogdcGMksZnTCLSkAcnnDEiWgsTriW0KMRKZkEDd8kQiQwcUMgmEEhwLgVKJ5LiDOjARKS04kFNkCkAb9h+gwXaBgG8NoNEjQK2yGmTQeWjD/gCozQ10xAekkaL1pJbduCz+gMfVIAve4x1LxjSLuOwEjdcNVCgZN+BKI4xEpFKi4w3JhwTTA6lFJqjL2o8rQQMtm0CPFgjesfhRMAoGDAAEaNdqbxCEgWhjGKAjMAKbyAg6ATM4gWECGQE2cBRGcAS5eI1VGvt110C8F/hDSNvX69217yqPQCAQbBnF69iuikbJevrh3ywshIUwrf82Md93E7QSjpXJR81NRelE4ixEi6alQOKsRMkI4+XCo/rU7wxAiBo9xFdEsU1X0XhY3sluk5VwhHo2q5c+dTHKm8Pi3fL2LotiP6DAAvHa09ddWQofNWHXvQ8YMMh6Y2iniStJ4wTARDWpuzWKtNTgkm6ZQ4FxnawUVhEOpv26kDFblp8jLFlblqypZ61itAgMFtTVqyVkP9C3J/UWwM3q0KoAYglDUeOW0Z/GaH4i5nEO/THneh7r0vNkgGhXYdt4YBWRKoiNmHeHPe60uh++any7595pCQQCgWDLeALGLWqyLWBxZQAAAABJRU5ErkJggg==",
handler:g}]:[]).show();break;case "audio/mpeg":case "audio/x-m4a":kb.create("audio").css({outline:"none"}).attr("controls","controls").attr("src",kb.field.objectUrl(m,d.contentType)).popup(null,null,k?[{src:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADwAAAA8CAYAAAFN++nkAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAA1FJREFUeNpiYKA66J8y8T8ynwmfJE6dQHYAjM9CtAlIihJIcjRAANHD71hdDxIA+RVdAbKf1wMFqeRXgACiqdcbQBiXPBMB/fVQTLxmoG3riRHDlXwWgIjCnHxGJOkPMHmYOCMx0QwDaIZRBgACaDgiYMDtxydPKJE4UKIZL8AVzwZA6jySkCEwji8QtBmoUQBIgbAhTCOIDxXHX4DgSl3Y5CjyMwspaRuvn6EJfwEOtQtIyhiEEsnAAYAAGkV0A4wUFDH/KSmPmYaEj4nJpcT6niQfQw01xCFtSEqQMxLwYT+QKsDmI6RyGV4eYwmRCUC5QpIsRjJEEaj5ARmJTwFI3ccV/CxEmHEfS2svEWjYArQG33yKi3ooCAQ1MXHIzQdaRqxFjtRI1aDgA5X+ClikQdHhSE60jAKaAoAAGkWjYBSgtF8pacOyUGC3AyUOH7Cmz8izmJGUxEREvB4AVouOtGhlvod2Y7GBD0BLBWnWoMdhOUmWEh3HoDYVrKkDteADNktBaogdcGMksZnTCLSkAcnnDEiWgsTriW0KMRKZkEDd8kQiQwcUMgmEEhwLgVKJ5LiDOjARKS04kFNkCkAb9h+gwXaBgG8NoNEjQK2yGmTQeWjD/gCozQ10xAekkaL1pJbduCz+gMfVIAve4x1LxjSLuOwEjdcNVCgZN+BKI4xEpFKi4w3JhwTTA6lFJqjL2o8rQQMtm0CPFgjesfhRMAoGDAAEaNdqbxCEgWhjGKAjMAKbyAg6ATM4gWECGQE2cBRGcAS5eI1VGvt110C8F/hDSNvX69217yqPQCAQbBnF69iuikbJevrh3ywshIUwrf82Md93E7QSjpXJR81NRelE4ixEi6alQOKsRMkI4+XCo/rU7wxAiBo9xFdEsU1X0XhY3sluk5VwhHo2q5c+dTHKm8Pi3fL2LotiP6DAAvHa09ddWQofNWHXvQ8YMMh6Y2iniStJ4wTARDWpuzWKtNTgkm6ZQ4FxnawUVhEOpv26kDFblp8jLFlblqypZ61itAgMFtTVqyVkP9C3J/UWwM3q0KoAYglDUeOW0Z/GaH4i5nEO/THneh7r0vNkgGhXYdt4YBWRKoiNmHeHPe60uh++any7595pCQQCgWDLeALGLWqyLWBxZQAAAABJRU5ErkJggg==",
handler:g}]:[]).show();break;case "image/bmp":case "image/gif":case "image/jpeg":case "image/png":kb.create("img").css({maxHeight:"calc(100vh - 4em)",maxWidth:"calc(100vw - 2em)"}).attr("src",kb.field.objectUrl(m,d.contentType)).popup(null,null,k?[{src:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADwAAAA8CAYAAAFN++nkAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAA1FJREFUeNpiYKA66J8y8T8ynwmfJE6dQHYAjM9CtAlIihJIcjRAANHD71hdDxIA+RVdAbKf1wMFqeRXgACiqdcbQBiXPBMB/fVQTLxmoG3riRHDlXwWgIjCnHxGJOkPMHmYOCMx0QwDaIZRBgACaDgiYMDtxydPKJE4UKIZL8AVzwZA6jySkCEwji8QtBmoUQBIgbAhTCOIDxXHX4DgSl3Y5CjyMwspaRuvn6EJfwEOtQtIyhiEEsnAAYAAGkV0A4wUFDH/KSmPmYaEj4nJpcT6niQfQw01xCFtSEqQMxLwYT+QKsDmI6RyGV4eYwmRCUC5QpIsRjJEEaj5ARmJTwFI3ccV/CxEmHEfS2svEWjYArQG33yKi3ooCAQ1MXHIzQdaRqxFjtRI1aDgA5X+ClikQdHhSE60jAKaAoAAGkWjYBSgtF8pacOyUGC3AyUOH7Cmz8izmJGUxEREvB4AVouOtGhlvod2Y7GBD0BLBWnWoMdhOUmWEh3HoDYVrKkDteADNktBaogdcGMksZnTCLSkAcnnDEiWgsTriW0KMRKZkEDd8kQiQwcUMgmEEhwLgVKJ5LiDOjARKS04kFNkCkAb9h+gwXaBgG8NoNEjQK2yGmTQeWjD/gCozQ10xAekkaL1pJbduCz+gMfVIAve4x1LxjSLuOwEjdcNVCgZN+BKI4xEpFKi4w3JhwTTA6lFJqjL2o8rQQMtm0CPFgjesfhRMAoGDAAEaNdqbxCEgWhjGKAjMAKbyAg6ATM4gWECGQE2cBRGcAS5eI1VGvt110C8F/hDSNvX69217yqPQCAQbBnF69iuikbJevrh3ywshIUwrf82Md93E7QSjpXJR81NRelE4ixEi6alQOKsRMkI4+XCo/rU7wxAiBo9xFdEsU1X0XhY3sluk5VwhHo2q5c+dTHKm8Pi3fL2LotiP6DAAvHa09ddWQofNWHXvQ8YMMh6Y2iniStJ4wTARDWpuzWKtNTgkm6ZQ4FxnawUVhEOpv26kDFblp8jLFlblqypZ61itAgMFtTVqyVkP9C3J/UWwM3q0KoAYglDUeOW0Z/GaH4i5nEO/THneh7r0vNkgGhXYdt4YBWRKoiNmHeHPe60uh++any7595pCQQCgWDLeALGLWqyLWBxZQAAAABJRU5ErkJggg==",
handler:g}]:[]).show();break;case "text/plain":case "text/css":fetch(new Request(kb.field.objectUrl(m,d.contentType))).then(c=>c.text()).then(c=>{kb.create("div").html(c.replace(/\n/g,"<br>")).popup("full","full",k?[{src:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADwAAAA8CAYAAAFN++nkAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAA1FJREFUeNpiYKA66J8y8T8ynwmfJE6dQHYAjM9CtAlIihJIcjRAANHD71hdDxIA+RVdAbKf1wMFqeRXgACiqdcbQBiXPBMB/fVQTLxmoG3riRHDlXwWgIjCnHxGJOkPMHmYOCMx0QwDaIZRBgACaDgiYMDtxydPKJE4UKIZL8AVzwZA6jySkCEwji8QtBmoUQBIgbAhTCOIDxXHX4DgSl3Y5CjyMwspaRuvn6EJfwEOtQtIyhiEEsnAAYAAGkV0A4wUFDH/KSmPmYaEj4nJpcT6niQfQw01xCFtSEqQMxLwYT+QKsDmI6RyGV4eYwmRCUC5QpIsRjJEEaj5ARmJTwFI3ccV/CxEmHEfS2svEWjYArQG33yKi3ooCAQ1MXHIzQdaRqxFjtRI1aDgA5X+ClikQdHhSE60jAKaAoAAGkWjYBSgtF8pacOyUGC3AyUOH7Cmz8izmJGUxEREvB4AVouOtGhlvod2Y7GBD0BLBWnWoMdhOUmWEh3HoDYVrKkDteADNktBaogdcGMksZnTCLSkAcnnDEiWgsTriW0KMRKZkEDd8kQiQwcUMgmEEhwLgVKJ5LiDOjARKS04kFNkCkAb9h+gwXaBgG8NoNEjQK2yGmTQeWjD/gCozQ10xAekkaL1pJbduCz+gMfVIAve4x1LxjSLuOwEjdcNVCgZN+BKI4xEpFKi4w3JhwTTA6lFJqjL2o8rQQMtm0CPFgjesfhRMAoGDAAEaNdqbxCEgWhjGKAjMAKbyAg6ATM4gWECGQE2cBRGcAS5eI1VGvt110C8F/hDSNvX69217yqPQCAQbBnF69iuikbJevrh3ywshIUwrf82Md93E7QSjpXJR81NRelE4ixEi6alQOKsRMkI4+XCo/rU7wxAiBo9xFdEsU1X0XhY3sluk5VwhHo2q5c+dTHKm8Pi3fL2LotiP6DAAvHa09ddWQofNWHXvQ8YMMh6Y2iniStJ4wTARDWpuzWKtNTgkm6ZQ4FxnawUVhEOpv26kDFblp8jLFlblqypZ61itAgMFtTVqyVkP9C3J/UWwM3q0KoAYglDUeOW0Z/GaH4i5nEO/THneh7r0vNkgGhXYdt4YBWRKoiNmHeHPe60uh++any7595pCQQCgWDLeALGLWqyLWBxZQAAAABJRU5ErkJggg==",
handler:g}]:[]).show()});break;case "text/csv":fetch(new Request(kb.field.objectUrl(m,d.contentType))).then(c=>c.text()).then(c=>{var b=c.parseCSV();0!=b.length&&(a=>{b.each((f,l)=>{a.append((n=>{f.each((t,p)=>n.append(kb.create("td").css({padding:"0.25em"}).html(t.replace(/\n/g,"<br>"))));return n})(kb.create("tr")))});return a})(kb.create("table")).popup(null,"full",k?[{src:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADwAAAA8CAYAAAFN++nkAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAA1FJREFUeNpiYKA66J8y8T8ynwmfJE6dQHYAjM9CtAlIihJIcjRAANHD71hdDxIA+RVdAbKf1wMFqeRXgACiqdcbQBiXPBMB/fVQTLxmoG3riRHDlXwWgIjCnHxGJOkPMHmYOCMx0QwDaIZRBgACaDgiYMDtxydPKJE4UKIZL8AVzwZA6jySkCEwji8QtBmoUQBIgbAhTCOIDxXHX4DgSl3Y5CjyMwspaRuvn6EJfwEOtQtIyhiEEsnAAYAAGkV0A4wUFDH/KSmPmYaEj4nJpcT6niQfQw01xCFtSEqQMxLwYT+QKsDmI6RyGV4eYwmRCUC5QpIsRjJEEaj5ARmJTwFI3ccV/CxEmHEfS2svEWjYArQG33yKi3ooCAQ1MXHIzQdaRqxFjtRI1aDgA5X+ClikQdHhSE60jAKaAoAAGkWjYBSgtF8pacOyUGC3AyUOH7Cmz8izmJGUxEREvB4AVouOtGhlvod2Y7GBD0BLBWnWoMdhOUmWEh3HoDYVrKkDteADNktBaogdcGMksZnTCLSkAcnnDEiWgsTriW0KMRKZkEDd8kQiQwcUMgmEEhwLgVKJ5LiDOjARKS04kFNkCkAb9h+gwXaBgG8NoNEjQK2yGmTQeWjD/gCozQ10xAekkaL1pJbduCz+gMfVIAve4x1LxjSLuOwEjdcNVCgZN+BKI4xEpFKi4w3JhwTTA6lFJqjL2o8rQQMtm0CPFgjesfhRMAoGDAAEaNdqbxCEgWhjGKAjMAKbyAg6ATM4gWECGQE2cBRGcAS5eI1VGvt110C8F/hDSNvX69217yqPQCAQbBnF69iuikbJevrh3ywshIUwrf82Md93E7QSjpXJR81NRelE4ixEi6alQOKsRMkI4+XCo/rU7wxAiBo9xFdEsU1X0XhY3sluk5VwhHo2q5c+dTHKm8Pi3fL2LotiP6DAAvHa09ddWQofNWHXvQ8YMMh6Y2iniStJ4wTARDWpuzWKtNTgkm6ZQ4FxnawUVhEOpv26kDFblp8jLFlblqypZ61itAgMFtTVqyVkP9C3J/UWwM3q0KoAYglDUeOW0Z/GaH4i5nEO/THneh7r0vNkgGhXYdt4YBWRKoiNmHeHPe60uh++any7595pCQQCgWDLeALGLWqyLWBxZQAAAABJRU5ErkJggg==",
handler:g}]:[]).show()});break;case "video/mp4":case "video/mpeg":kb.create("video").css({maxHeight:"calc(100vh - 4em)",maxWidth:"calc(100vw - 2em)",outline:"none"}).attr("controls","controls").attr("src",kb.field.objectUrl(m,d.contentType)).popup(null,null,k?[{src:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADwAAAA8CAYAAAFN++nkAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAA1FJREFUeNpiYKA66J8y8T8ynwmfJE6dQHYAjM9CtAlIihJIcjRAANHD71hdDxIA+RVdAbKf1wMFqeRXgACiqdcbQBiXPBMB/fVQTLxmoG3riRHDlXwWgIjCnHxGJOkPMHmYOCMx0QwDaIZRBgACaDgiYMDtxydPKJE4UKIZL8AVzwZA6jySkCEwji8QtBmoUQBIgbAhTCOIDxXHX4DgSl3Y5CjyMwspaRuvn6EJfwEOtQtIyhiEEsnAAYAAGkV0A4wUFDH/KSmPmYaEj4nJpcT6niQfQw01xCFtSEqQMxLwYT+QKsDmI6RyGV4eYwmRCUC5QpIsRjJEEaj5ARmJTwFI3ccV/CxEmHEfS2svEWjYArQG33yKi3ooCAQ1MXHIzQdaRqxFjtRI1aDgA5X+ClikQdHhSE60jAKaAoAAGkWjYBSgtF8pacOyUGC3AyUOH7Cmz8izmJGUxEREvB4AVouOtGhlvod2Y7GBD0BLBWnWoMdhOUmWEh3HoDYVrKkDteADNktBaogdcGMksZnTCLSkAcnnDEiWgsTriW0KMRKZkEDd8kQiQwcUMgmEEhwLgVKJ5LiDOjARKS04kFNkCkAb9h+gwXaBgG8NoNEjQK2yGmTQeWjD/gCozQ10xAekkaL1pJbduCz+gMfVIAve4x1LxjSLuOwEjdcNVCgZN+BKI4xEpFKi4w3JhwTTA6lFJqjL2o8rQQMtm0CPFgjesfhRMAoGDAAEaNdqbxCEgWhjGKAjMAKbyAg6ATM4gWECGQE2cBRGcAS5eI1VGvt110C8F/hDSNvX69217yqPQCAQbBnF69iuikbJevrh3ywshIUwrf82Md93E7QSjpXJR81NRelE4ixEi6alQOKsRMkI4+XCo/rU7wxAiBo9xFdEsU1X0XhY3sluk5VwhHo2q5c+dTHKm8Pi3fL2LotiP6DAAvHa09ddWQofNWHXvQ8YMMh6Y2iniStJ4wTARDWpuzWKtNTgkm6ZQ4FxnawUVhEOpv26kDFblp8jLFlblqypZ61itAgMFtTVqyVkP9C3J/UWwM3q0KoAYglDUeOW0Z/GaH4i5nEO/THneh7r0vNkgGhXYdt4YBWRKoiNmHeHPe60uh++any7595pCQQCgWDLeALGLWqyLWBxZQAAAABJRU5ErkJggg==",
handler:g}]:[]).show();break;default:g()}}catch(c){kb.alert(kb.error.parse(c))}}).catch(m=>kb.alert(kb.error.parse(m)))}};
window.KintoneBoosterRecord=class{constructor(){this.comments={get:(d,k)=>new Promise((m,g)=>{var c=(b,a,f)=>{kintone.api(kintone.api.url("/k/v1/record/comments",!0),"GET",{app:d,record:k,order:"asc",offset:a}).then(l=>{Array.prototype.push.apply(b,l.comments);a+=10;10==l.comments.length?c(b,a,f):f(b)}).catch(l=>g(l))};c([],0,b=>m(b))}),set:(d,k,m,g=!1)=>new Promise((c,b)=>{var a=(f,l)=>{0!=m.length?kintone.api(kintone.api.url("/k/v1/record/comment",!0),"POST",{app:d,record:k,comment:{text:m[f].text,
mentions:m[f].mentions}}).then(n=>{g||kb.progressUpdate();f++;f<m.length?a(f,l):l()}).catch(n=>b(n)):l()};g||kb.progressStart(m.length);a(0,()=>{g||kb.progressEnd();c()})})};this.page={add:(d,k)=>kintone.api.url("/k/",!0).replace(/\.json/g,"")+(d?"m/"+k:k)+"/edit",detail:(d,k,m)=>kintone.api.url("/k/",!0).replace(/\.json/g,"")+(d?"m/"+k:k)+"/show"+(d?"?":"#")+"record="+m,edit:(d,k,m)=>kintone.api.url("/k/",!0).replace(/\.json/g,"")+(d?"m/"+k:k)+"/show"+(d?"?":"#")+"record="+m+(d?"#":"&")+"mode=edit"}}create(d,
k=!0){var m={},g;for(g in d.fields)(c=>{switch(c.type){case "CHECK_BOX":case "CONDITION":case "FILE":case "GROUP_SELECT":case "MULTI_SELECT":case "ORGANIZATION_SELECT":case "USER_SELECT":m[g]={type:c.type,value:[]};break;case "RADIO_BUTTON":(b=>{m[g]={type:c.type,value:0!=b.length?b.reduce((a,f)=>{a[f.index]=f;return a},Array(b.length).fill("")).first().label:""}})(Object.values(c.options));break;case "SUBTABLE":m[g]={type:c.type,value:[{value:this.create(c,!1)}]};break;default:kb.field.reserved.includes(c.type)||
(m[g]={type:c.type,value:""})}})(d.fields[g]);k&&(m.$id={type:"__ID__",value:""});return m}get(d,k,m){var g={error:!1,record:{}};if(!m)for(var c in k.fields)if(((b,a)=>{if(b)switch("SUBTABLE"!=a.type&&(b=b.elm(".kb-field-value")),a.type){case "CHECK_BOX":case "MULTI_SELECT":a.required&&!b.elms("input").some(f=>f.checked)&&(b.alert(kb.constants.common.message.invalid.required[kb.operator.language]),g.error=!0);break;case "FILE":case "GROUP_SELECT":case "ORGANIZATION_SELECT":case "USER_SELECT":a.required&&
(f=>{0==f.length&&(b.alert(kb.constants.common.message.invalid.required[kb.operator.language]),g.error=!0)})(b.elm("input").val()?JSON.parse(b.elm("input").val()):[]);break;case "SUBTABLE":break;default:b.elms("input,select,textarea").each((f,l)=>{f.checkValidity()||(g.error=!0)})}})(d.elm('[field-id="'+CSS.escape(c)+'"]'),k.fields[c]),g.error)break;if(g.error)kb.alert(kb.constants.common.message.invalid.record[kb.operator.language]);else{for(c in k.fields)((b,a)=>{if(b)switch("SUBTABLE"!=a.type&&
(b=b.elm(".kb-field-value")),a.type){case "CALC":g.record[a.code]={type:a.type,value:null};break;case "CHECK_BOX":case "MULTI_SELECT":g.record[a.code]={type:a.type,value:(()=>{var f=[];b.elms("input").each((l,n)=>{l.checked&&!l.parentNode.hasClass("kb-hidden")&&f.push(l.val())});return f})()};break;case "CREATED_TIME":case "UPDATED_TIME":g.record[a.code]={type:a.type,value:b.elm("input").val()?b.elm("input").val():(new Date).format("ISO")};break;case "CREATOR":case "MODIFIER":g.record[a.code]={type:a.type,
value:b.elm("input").val()?JSON.parse(b.elm("input").val()):{code:kb.operator.code,name:kb.operator.name}};break;case "DATETIME":g.record[a.code]={type:a.type,value:(()=>{var f="";b.elm("input").val()&&(b.elm(".kb-hour").elm("select").val()||b.elm(".kb-hour").elm("select").val("00"),b.elm(".kb-minute").elm("select").val()||b.elm(".kb-minute").elm("select").val("00"));b.elm("input").val()&&b.elm(".kb-hour").elm("select").val()&&b.elm(".kb-minute").elm("select").val()&&(f=(b.elm("input").val()+" "+
b.elm(".kb-hour").elm("select").val()+":"+b.elm(".kb-minute").elm("select").val()+":00").parseDateTime().format("ISO"));return f})()};break;case "DROP_DOWN":g.record[a.code]={type:a.type,value:b.elm("select").val()};break;case "FILE":case "GROUP_SELECT":case "ORGANIZATION_SELECT":case "USER_SELECT":g.record[a.code]={type:a.type,value:b.elm("input").val()?JSON.parse(b.elm("input").val()):[]};break;case "NUMBER":g.record[a.code]={type:a.type,value:kb.isNumeric(b.elm("input").val())?parseFloat(b.elm("input").val()):
b.elm("input").val()};break;case "RADIO_BUTTON":g.record[a.code]={type:a.type,value:(()=>{var f="";b.elms("[data-name="+a.code+"]").each((l,n)=>{l.checked&&!l.parentNode.hasClass("kb-hidden")&&(f=l.val())});return f})()};break;case "MULTI_LINE_TEXT":case "RICH_TEXT":g.record[a.code]={type:a.type,value:b.elm("textarea").val()};break;case "SUBTABLE":g.record[a.code]={type:a.type,value:(()=>{var f=[];b.tr.each((l,n)=>{n=this.get(l,a,m);if(n.error)return g.error=n.error,KB_BREAK;f.push(l.hasAttribute("row-id")?
{id:l.attr("row-id"),value:n.record}:{value:n.record})});return f})()};break;case "TIME":g.record[a.code]={type:a.type,value:(()=>{var f="";b.elm(".kb-hour").elm("select").val()&&(b.elm(".kb-minute").elm("select").val()||b.elm(".kb-minute").elm("select").val("00"));b.elm(".kb-minute").elm("select").val()&&(b.elm(".kb-hour").elm("select").val()||b.elm(".kb-hour").elm("select").val("00"));b.elm(".kb-hour").elm("select").val()&&b.elm(".kb-minute").elm("select").val()&&(f=b.elm(".kb-hour").elm("select").val()+
":"+b.elm(".kb-minute").elm("select").val());return f})()};break;default:kb.field.reserved.includes(a.type)||(g.record[a.code]={type:a.type,value:b.elm("input").val()})}})(d.elm('[field-id="'+CSS.escape(c)+'"]'),k.fields[c]);d.elm("[data-type=id]")&&(g.record.$id={value:d.elm("[data-type=id]").val()?parseInt(d.elm("[data-type=id]").val()):d.elm("[data-type=id]").val()})}return g}set(d,k,m){return new Promise((g,c)=>{var b=(a,f,l,n)=>{var t=[],p;for(p in l)((h,r,e)=>{if(h){"disabled"in e&&(e.disabled?
h.addClass("kb-disabled"):h.removeClass("kb-disabled"));"hidden"in e&&(e.hidden?h.addClass("kb-hidden"):h.removeClass("kb-hidden"));if("SUBTABLE"!=r.type)switch(h=h.elm(".kb-field-value"),"backcolor"in e&&(e.backcolor?h.addClass("kb-force-backcolor").elm(".kb-guide").css({backgroundColor:e.backcolor}):h.removeClass("kb-force-backcolor").elm(".kb-guide").css({backgroundColor:""})),"forecolor"in e&&(e.forecolor?h.addClass("kb-force-forecolor").elm(".kb-guide").css({color:e.forecolor}):h.removeClass("kb-force-forecolor").elm(".kb-guide").css({color:""})),
"error"in e&&(h.alert?h.alert(e.error):h.elms("input,select,textarea").each((q,u)=>{q.alert&&q.alert.elm("span").html(e.error).parentNode.show()})),r.type){case "CALC":case "CATEGORY":case "CHECK_BOX":case "CONDITION":case "CREATED_TIME":case "CREATOR":case "FILE":case "GROUP_SELECT":case "MODIFIER":case "MULTI_SELECT":case "ORGANIZATION_SELECT":case "RADIO_BUTTON":case "RECORD_NUMBER":case "REFERENCE_TABLE":case "SPACER":case "STATUS":case "STATUS_ASSIGNEE":case "UPDATED_TIME":case "USER_SELECT":"backcolor"in
e&&h.css({backgroundColor:e.backcolor?e.backcolor:""});"forecolor"in e&&h.css({color:e.forecolor?e.forecolor:""});break;default:h.elms("input,select,textarea").each((q,u)=>{"backcolor"in e&&q.css({backgroundColor:e.backcolor?e.backcolor:""});"forecolor"in e&&q.css({color:e.forecolor?e.forecolor:""})})}switch(r.type){case "CALC":case "RECORD_NUMBER":case "STATUS":h.elm(".kb-guide").html(e.value);break;case "CATEGORY":h.elm(".kb-guide").html(e.value.join("<br>"));break;case "CHECK_BOX":case "MULTI_SELECT":h.elms("input").each((q,
u)=>{q.checked=e.value.includes(q.val())});h.elm(".kb-guide").html(e.value.join("<br>"));break;case "COLOR":h.css({backgroundColor:e.value?e.value:"transparent"}).elm("input").val(e.value);h.elm(".kb-guide").html(e.value);break;case "CONDITION":h.elm(".kb-guide").empty();e.value?(h.elm("input").val(e.value),e.value.split(" and ").each((q,u)=>h.guide(q))):h.elm("input").val("");break;case "CREATOR":case "MODIFIER":h.elm("input").val(JSON.stringify(e.value));h.elm(".kb-guide").html(e.value.name);break;
case "CREATED_TIME":case "UPDATED_TIME":e.value?(h.elm("input").val(e.value),h.elm(".kb-guide").html((new Date(e.value)).format("Y-m-d H:i"))):(h.elm("input").val(""),h.elm(".kb-guide").html(""));break;case "DATETIME":if(e.value){var v=e.value.parseDateTime();h.elm("input").val(v.format("Y-m-d"));h.elm(".kb-hour").elm("select").val(v.format("H"));h.elm(".kb-minute").elm("select").val(v.format("i"));h.elm(".kb-guide").html(v.format("Y-m-d H:i"))}else h.elm("input").val(""),h.elm(".kb-hour").elm("select").val(""),
h.elm(".kb-minute").elm("select").val(""),h.elm(".kb-guide").html("");break;case "DROP_DOWN":h.elm("select").val(e.value);h.elm(".kb-guide").html(h.elm("select").selectedText());break;case "FILE":case "GROUP_SELECT":case "ORGANIZATION_SELECT":case "USER_SELECT":h.elm(".kb-guide").empty();e.value?(h.elm("input").val(JSON.stringify(e.value)),e.value.each((q,u)=>h.guide(q))):h.elm("input").val("[]");break;case "LINK":h.elm("input").val(e.value);h.elm(".kb-guide").empty();if(e.value)switch(r.protocol){case "MAIL":h.elm(".kb-guide").append(kb.create("a").attr("href",
"mailto:"+e.value).html(e.value));break;case "CALL":h.elm(".kb-guide").append(kb.create("a").attr("href","tel:"+e.value).html(e.value));break;case "WEB":h.elm(".kb-guide").append(kb.create("a").attr("href",e.value).attr("target","_blank").html(e.value))}break;case "MULTI_LINE_TEXT":case "RICH_TEXT":h.elm("textarea").val(e.value);h.elm(".kb-guide").html(e.value.replace(/\n/g,"<br>"));break;case "NUMBER":r.digit?kb.isNumeric(e.value)?(h.elm("input").val(Number(e.value).comma(r.displayScale)),h.elm(".kb-guide").html(Number(e.value).comma(r.displayScale))):
(h.elm("input").val(e.value),h.elm(".kb-guide").html(e.value)):r.displayScale?kb.isNumeric(e.value)?(h.elm("input").val(Number(e.value).toFloor(parseInt(r.displayScale))),h.elm(".kb-guide").html(Number(e.value).toFloor(parseInt(r.displayScale)))):(h.elm("input").val(e.value),h.elm(".kb-guide").html(e.value)):(h.elm("input").val(e.value),h.elm(".kb-guide").html(e.value));r.unit&&("prefix"==r.unitPosition?h.elm(".kb-guide").html(r.unit+" "+h.elm(".kb-guide").text()):h.elm(".kb-guide").html(h.elm(".kb-guide").text()+
" "+r.unit));break;case "RADIO_BUTTON":h.elms("[data-name="+p+"]").each((q,u)=>{q.checked=e.value==q.val()});h.elm(".kb-guide").html(e.value);break;case "SPACER":break;case "STATUS_ASSIGNEE":h.elm(".kb-guide").empty();e.value&&e.value.each((q,u)=>{h.elm(".kb-guide").append(kb.create("span").addClass("kb-guide-item").append(kb.create("span").addClass("kb-guide-item-label").html(q.name)))});break;case "SUBTABLE":if(0==e.value.length)h.clearRows();else{h.tr.each((q,u)=>{e.value.length>u&&b(q,r,(w=>{if(e.disabled)for(var x in w)w[x].disabled=
!0;return w})(e.value.map(w=>w.value)[u]),w=>t=t.concat(w))});for(v=h.tr.length;v<e.value.length;v++)b(h.addRow(),r,(q=>{if(e.disabled)for(var u in q)q[u].disabled=!0;return q})(e.value.map(q=>q.value)[v]),q=>t=t.concat(q));h.tr.slice(e.value.length).each((q,u)=>h.delRow(q))}0==h.tr.length?(q=>{e.disabled&&b(q,r,(u=>{for(var w in u)u[w].disabled=!0;return u})(this.get(q,r,!0).record),u=>t=t.concat(u))})(h.addRow()):h.tr.each((q,u)=>{"id"in e.value[u]&&q.attr("row-id",e.value[u].id)});break;case "TIME":e.value?
(h.elm(".kb-hour").elm("select").val(e.value.split(":")[0]),h.elm(".kb-minute").elm("select").val(e.value.split(":")[1]),h.elm(".kb-guide").html(e.value)):(h.elm(".kb-hour").elm("select").val(""),h.elm(".kb-minute").elm("select").val(""),h.elm(".kb-guide").html(""));break;default:h.elm("input").val(e.value),h.elm(".kb-guide").html(e.value)}}})(a.elm('[field-id="'+CSS.escape(p)+'"]'),f.fields[p],l[p]);"$id"in l&&a.elm("[data-type=id]")&&a.elm("[data-type=id]").val(l.$id.value);n(t)};b(d,k,m,a=>{d.hasOwnProperty("cleanup")&&
d.cleanup();g()})})}simplify(d,k){var m={},g;for(g in d.fields)(c=>{switch(c.type){case "CATEGORY":case "CHECK_BOX":case "MULTI_SELECT":m[g]={value:g in k?Array.from(new Set(k[g].value.sort())):[]};break;case "CALC":case "CREATED_TIME":case "CREATOR":case "FILE":case "MODIFIER":case "RECORD_NUMBER":case "REFERENCE_TABLE":case "SPACER":case "STATUS":case "UPDATED_TIME":break;case "GROUP_SELECT":case "ORGANIZATION_SELECT":case "STATUS_ASSIGNEE":case "USER_SELECT":m[g]={value:g in k?Array.from(new Set(k[g].value.map(b=>
b.code).sort())):[]};break;case "NUMBER":m[g]={value:g in k?kb.isNumeric(k[g].value)?k[g].value.toString():"":""};break;case "SUBTABLE":m[g]={value:k[g].value.reduce((b,a)=>{b.push({value:this.simplify(c,a.value)});return b},[])};break;default:m[g]={value:g in k?(k[g].value||" ").toString().replace(/[\r\n]*/g,""):""}}})(d.fields[g]);return m}};
window.KintoneBoosterRecordPicker=class extends KintoneBoosterDialog{constructor(d,k,m){super(999997,!1,!k);this.multiSelect=k;this.prepend=m;this.type=d;this.limit=50;this.offset=0;this.table=null;this.fieldInfo={};this.records=[];this.selection=[];this.img=this.parts.icon.clone().css({top:"0px"});this.prev=this.img.clone().css({right:"4em"}).attr("src","data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADwAAAA8CAYAAAFN++nkAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAjZJREFUeNpiYKAJ6J8y8T+MzYIm0QCk6pHFmNA016ObhqKgMCefkfoOBggg6vr9Psz/LLgCBcVb6BI4gxSvQqJMAQggugYDinNYSNVAUDOxHmbCJghNRo2ENDMSG+VASoGq6RMggIY7Agbae6Limdh4ZyGgaT2QCiAphRGbyliwaALZtJ7s5EksYCTF2ehJE6fNUIUbqFIIUFQuYUskAwcAAmgUUTP3F5CUpSi0DD07TqCZxUDLQBXBfVL1sZBpmQCQoiiPsJCRIQWoES3ENAn2AykHaic+Rlr6GF8DgJGWcUx1i4lN1TS1GF8+HpC2FqGSa+QBgAAaRaNgFBBVcJDVm6BCL4uo2ouFShYaAKnzNG/6oFkKstCALm0uarS7mMi0tJ+ujT1i+79UtRhav/ZTKwewUDubULN5S5MRO4KJC9pu+kB3i6GWC4KoAWvQkxL0hFqYJOdjqIET6BLUWCwHBbsg3S2GWv4B6vsLdLUYyQGGQMqQ5omL2IKG6omL3tluFIwCkgFAgPbN6AZAGASi1XQQR3BD3aSrGhLilzZqoQK9iwu8RLnrUfFAEORKbla63NNSRbq21KPZOCQFqJIqC133wAxJt2FU+uZsCHRPF9d+QgFzq7FJlwymgHk/U3pCdgfmgpMm7PL3p5MVIU8bsTQUpbtxcRsxB6xtI9Ka02CaPL7SLdFSLUtrDi2TwJq2ZB5YOni4ApaIlm6Bvx4eQgC/8fVQwE9sLizwnc3hbwMIgobRAdIK28oCHbudAAAAAElFTkSuQmCC").on("click",
g=>{this.offset-=this.limit;this.search()});this.next=this.img.clone().css({right:"2em"}).attr("src","data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADwAAAA8CAYAAAFN++nkAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAi1JREFUeNpiYKAa6J8y8T8Q30cXZ0LjK4AU4lMANw3GZkGXLMzJZ2QgpIskABBAVPI/Xr9DA6gBn7/rcUri9DNJACCAaO9lXICRkGZ8HmQkxWZ0g5iIdGEjNhew4NHwAKhBkWaBCxBAwwUBo+o9sWqxRZUAsamMiUDJtJ4szVAQgM8VTMRmFiAOIEszLsBCjCJcOYuQzRvwZUkWUm2jWiIZOAAQQKMIW8QV0MJcRmKyExI3EJjsNgyExchAEeiIBwNhMTIQBDriw0BYDAMfgA4QHAiLkcEBoCMcKSo1aeFjallMchxTYjFFqZpUi6mWjwes5Bp5ACCARtEoGJlNn/+0KESI7RD0U7vRTEpPRADqewN6WwwD54GWnx/Ixh5Z9TBVOn1A8B7osP6BsBgECshplzENVLZjona2JzbbUdtiogdDaGHxB2K69dS2uJDe7WqSBy+o4eMJ5IyYUOpjsksuci2+ALTQkBIXk2OxIdDSC5TGDwuJ2USQWomRidrZZBSMggEHAAHaNaMbAEEYiBLDgo7AJo7gaI7gCI5giMSAn0LLNb0XBuAlhF4LXIQQU3Q/vZfcnsPI2jNPtSZck+e66W/utCjcpPzw/DC4vAjXZPHNk/DbDxT53YvwVz6pvecACNec5aY/vAg3zb5UmUMVFitzFoSHlrklOCMa2OPQI40qLHZpIQmrlKXZwurBI06SnBYtNYUhmgdpYbj2UEIYegAwStjMiIcQQkxxA49895hLUEtfAAAAAElFTkSuQmCC").on("click",
g=>{this.offset+=this.limit;this.search()});this.submit=this.img.clone().css({left:"0"}).attr("src","data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADwAAAA8CAYAAAFN++nkAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAA7BJREFUeNpiYKAa6J8yMQFK/yfbhP9Qej7RigkpOk+U1QABRLnf92MTZ4LSDkgKHbDpNiDoHZACvIqIChCAAKIIMeLwNtxHhTn5jCTFNHoo4FLPRISZ58mJNQdCwctIauIlKRzwAYAAGqKIkUBcNwIDp4GsRAIqFoC4gBiNAaTmEOQUZkBpWfCeXJtB4AFSMRgAYoNSE9Zyg5R0TVbaRteEnK4JZkn0TAA0rIGcwPxP+4KNWAAQQKO5mVCeg2WdA8DYP0Azi6FZTACILwAtMkQSB4ndxyZHjfbNf2LaE1RNsqBMQ4phUMsdSLEDV04+gBSkRJW3pMY5E45iA2RIIxC/x9cQhEbFeiB2pHqqhlYz/TikHUGOhLZXzpNS6TNSIT2A4nY/MQUuVS0mpibD5gCqt4NwOCARaPkCuhSJ0CyZMFo5wABAAI2iUTCwLRBoLVWAVBI10NRioIUK0JYG0UUhxRaj1TiBQEs2oLWu66FcQaDcB1ItZiHUu8bmK2hQw1op78kp85lw+HY9kUGpiFRnU24xEICaMwSDD+iwBzC3UstiEJhIpBlkta+ZqJAlBahtcT2RZhhQ0+IFxDRvkdrSgVSxGJhoEqHM9wRKs/1Q9RuoGdSCSL2E+WiW7oc5Cpbl8A3Jkduufo8jAT0AWqqIRQ1RDTtSuqmw+PwANPgCWm/CgNRWJTUa9Lja03gtp0Y+xpWi5+Nr3lJsMTRFJ5JqOTV8zAANUpyW08xiIiynncV4LBekW0MO1GQiawxwFAwrABCgXau9QRCIoYQJWMENdAJlBCZQJjCOwAZugE4AG+AGygSs4AjapJra8HF3HEcx96J/jCR91uu1r8+/PDw8/k+FUGw+jzhg9gGGT+iSMjJkLoMwzgxVS5v/xKG1Jp9tA+IfIIDOPDYRMZwRRgnozogq77dxysvZvwE2Z7E4wi17h2yMyMacI5Dl1dTZDjWCixjZZKyiiFm9EAmlmjrDOvMDlc5KE9FhQOwArHU3k1MSpqgtx3FzVbRMCW8tDnURq+AyzjCe108wO4uTZ8GOykNSlYYrqWEBJiMy25Dr7SvRiWs8WuQ7OIOpSveERalg9/j5/exJeqcVYeC7gUIUBd3i+Q9R7N5y8v0n/pDl7IRbyB/e733QvxmAwK+cQE+bSmHFVjC7F5RbVRQwirgI82vPrsE6cTFuXxTPc4NHtYiLszcbEofitlG5JUJphCFbuKdLNR77FM3lZdgw48om0MU49juIO1dMPDw8PJziBXvFttyY+HdhAAAAAElFTkSuQmCC").on("click",
g=>{this.offset=0;this.search()});this.input=this.parts.input.clone().css({paddingLeft:"2em",paddingRight:"4em"}).attr("placeholder",kb.constants.common.prompt.keyword[kb.operator.language]).attr("type","text").on("keydown",g=>{if(13==(g.keyCode||g.which))return this.offset=0,this.search(),g.stopPropagation(),g.preventDefault(),!1});this.container.css({height:"calc(34em + 16px)",minWidth:"16em"});this.contents.css({padding:"0px"});this.header.css({boxShadow:"none"}).append(this.input).append(this.next).append(this.prev).append(this.submit)}search(d){switch(this.type){case "record":kintone.api(kintone.api.url("/k/v1/records",
!0),"GET",{app:this.fieldInfo.app,query:(()=>{var m=[];this.fieldInfo.query&&m.push(this.fieldInfo.query);this.input.val()&&m.push((g=>{var c=[];g.each((b,a)=>{for(var f in this.fieldInfo.picker)switch(a=this.fieldInfo.picker[f],a.type){case "LINK":case "MULTI_LINE_TEXT":case "RICH_TEXT":case "SINGLE_LINE_TEXT":c.push(a.code+' like "'+b+'"')}});return 0!=c.length?"("+c.join(" or ")+")":""})(this.input.val().split(/[ \u3000]/).filter(g=>g)));return m.join(" and ")+" order by "+(this.fieldInfo.sort?
this.fieldInfo.sort:"$id asc")+" limit "+this.limit+" offset "+this.offset})()}).then(m=>{this.records=m.records;this.table.clearRows();this.records.each((g,c)=>{(b=>{kb.record.set(b,{fields:this.fieldInfo.picker},g);this.multiSelect&&this.selection.some(a=>a.$id.value==g.$id.value)&&b.css({backgroundColor:"rgba(66,165,245,0.5)",color:""})})(this.table.addRow())});0<this.offset?this.prev.show():this.prev.hide();this.offset+(this.limit==this.records.length?this.limit:this.records.length)<m.total?this.next.show():
this.next.hide();d&&d()}).catch(m=>kb.alert(kb.error.parse(m)));break;default:var k=()=>{var m=(()=>{var g=this.prepend?this.prepend.concat(kb.roleSet[this.type]):kb.extend({},kb.roleSet[this.type]);this.input.val()&&(c=>{g=g.filter(b=>{var a=!1;b.name.value&&(a=c.some(f=>b.name.value.match(new RegExp(f,"ig"))));return a})})(this.input.val().replace(/[\u3000 ]+/g," ").split(" ").filter(c=>c));return g})();this.records=m.slice(this.offset,this.offset+this.limit);this.table.clearRows();this.records.each((g,
c)=>{(b=>{kb.record.set(b,{fields:this.fieldInfo.picker},g);this.multiSelect&&this.selection.some(a=>a.code.value==g.code.value)&&b.css({backgroundColor:"rgba(66,165,245,0.5)",color:""})})(this.table.addRow())});0<this.offset?this.prev.show():this.prev.hide();this.offset+(this.limit==this.records.length?this.limit:this.records.length)<m.length?this.next.show():this.next.hide();d&&d()};0==kb.roleSet.user.length?kb.roleSet.load().then(()=>k()):k()}}show(d,k){var m=this.parts.div.clone().css({borderTop:"1px solid #42a5f5",
borderBottom:"1px solid #42a5f5",lineHeight:"2em",padding:"0px 0.5em"}),g=this.parts.td.clone().css({cursor:"pointer",padding:"0",userSelect:"none"}),c=this.parts.th.clone().css({backgroundColor:kb.themeColor().backcolor});this.offset=0;this.fieldInfo=d;this.records=[];this.selection=[];this.input.val("");this.table=this.parts.table.clone().css({marginBottom:"0.5em"}).append(kb.create("thead").append(kb.create("tr"))).append(kb.create("tbody").append(kb.create("tr")));for(var b in this.fieldInfo.picker)(a=>
{this.table.elm("thead tr").append(c.clone().append(m.clone().html("label"in a?a.label:"")));var f=this.table.elm("tbody tr"),l=f.append,n=g.clone(),t=n.append,p=kb.field,h=p.create;a=kb.extend({},a);a.noLabel=!0;l.call(f,t.call(n,h.call(p,a).css({width:"100%"}).addClass("kb-picker kb-readonly")))})(this.fieldInfo.picker[b]);this.contents.empty().append(this.table.spread((a,f)=>{a.on("click",l=>{(n=>{this.multiSelect?(t=>{t.length==this.selection.length?(this.selection.push(kb.extend({},n)),a.css({backgroundColor:"rgba(66,165,245,0.5)",
color:""})):(this.selection=t,a.css({backgroundColor:"transparent",color:kb.themeColor().forecolor}))})(this.selection.filter(t=>"record"==this.type?t.$id.value!=n.$id.value:t.code.value!=n.code.value)):(k&&k(n),this.hide())})(this.records[f])});(l=>{a.addClass("kb-scope").elms(".kb-field").each((n,t)=>kb.field.activate(n,l))})({id:"recordPicker",fields:kb.extend({},this.fieldInfo.picker)})}));this.multiSelect&&(this.handler&&this.ok.off("click",this.handler),this.handler=a=>{k&&k(this.selection);
this.hide()},this.ok.on("click",this.handler),this.cancel.on("click",a=>this.hide()));this.search(()=>super.show())}};
window.KintoneBoosterButton=class{constructor(){}create(d,k,m,g,c,b){(a=>{a&&a.parentNode.removeChild(a)})(kb.elm("#"+m));switch(k){case "detail":(d?kintone.mobile.app.getHeaderSpaceElement():kintone.app.record.getHeaderMenuSpaceElement().css({padding:"0 0.75em 0 1em"})).append(kb.create("button").addClass("kb-action-button kb-page-detail "+(d?" kb-mobile":"")).attr("id",m).html(g).on("click",a=>{kb.confirm(c,()=>b())}));break;case "index":(d?kintone.mobile.app.getHeaderSpaceElement():kintone.app.getHeaderMenuSpaceElement()).append(kb.create("button").addClass("kb-action-button kb-page-index "+
(d?" kb-mobile":"")).attr("id",m).html(g).on("click",a=>{kb.confirm(c,()=>b())}))}}};
window.KintoneBoosterField=class{constructor(){this.cache={};this.reserved="CATEGORY CREATED_TIME CREATOR GROUP HR LABEL MODIFIER RECORD_NUMBER REFERENCE_TABLE SPACER STATUS STATUS_ASSIGNEE UPDATED_TIME __ID__ __REVISION__".split(" ")}activate(d,k,m=!0){var g=kb.field.parallelize(k.fields),c=()=>kb.create("div").css({zIndex:kb.popups.alert.cover.style.zIndex-4}).append(kb.create("img").attr("src","data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAB4AAAAeCAYAAAA7MK6iAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAyJpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuMy1jMDExIDY2LjE0NTY2MSwgMjAxMi8wMi8wNi0xNDo1NjoyNyAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvIiB4bWxuczp4bXBNTT0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL21tLyIgeG1sbnM6c3RSZWY9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZVJlZiMiIHhtcDpDcmVhdG9yVG9vbD0iQWRvYmUgUGhvdG9zaG9wIENTNiAoV2luZG93cykiIHhtcE1NOkluc3RhbmNlSUQ9InhtcC5paWQ6QkVGNzA3QTE1RTc4MTFFOEI5MDA5RUE2NDFCQTUzNDciIHhtcE1NOkRvY3VtZW50SUQ9InhtcC5kaWQ6QkVGNzA3QTI1RTc4MTFFOEI5MDA5RUE2NDFCQTUzNDciPiA8eG1wTU06RGVyaXZlZEZyb20gc3RSZWY6aW5zdGFuY2VJRD0ieG1wLmlpZDpCRUY3MDc5RjVFNzgxMUU4QjkwMDlFQTY0MUJBNTM0NyIgc3RSZWY6ZG9jdW1lbnRJRD0ieG1wLmRpZDpCRUY3MDdBMDVFNzgxMUU4QjkwMDlFQTY0MUJBNTM0NyIvPiA8L3JkZjpEZXNjcmlwdGlvbj4gPC9yZGY6UkRGPiA8L3g6eG1wbWV0YT4gPD94cGFja2V0IGVuZD0iciI/PkBlNTAAAADNSURBVHja7NHBCcJAFATQZNBcYwmSmycPlpI2bCVgAVqAVmAFHmxqncAKQVyz+/N/grADc0iyy0Be6ZwrlgiKhZKH83Ae/v/h1X23l9499vfZk2hYOHpgO7ZkH+xzjl9dsze2Ytfsld3MMXxhm8Hzlj1bD/eu7Zf3rf9mMvx2DaXzZ1SHh66hVP5MrTn86RpK48+qDIdcQ4nyxkRXsTcmuoq9oeAq8oaSa7I3FF2TvKHomuQNZddobxi4RnnDyHXUG0auo94wdP3p/RJgAMw4In5GE/6/AAAAAElFTkSuQmCC")).append(kb.create("span")),b=
a=>{((f,l)=>{d.elm(".kb-field-alert")?d.elm(".kb-field-alert").hide():d.elms("input,select,textarea").each((n,t)=>{n.alert&&n.alert.hide()});kb.event.call(a,{container:l,record:kb.record.get(f,k,!0).record}).then(n=>{n.error||(m?kb.event.call("kb.action.call",{container:f,record:n.record,mobile:location.href.match(/\/m\//g)?!0:!1,pattern:"change",field:d.attr("field-id"),workplace:f.closest(".kb-view")?"view":"record"}).then(t=>{kb.event.call("kb.style.call",{container:f,record:t.record,mobile:t.mobile,
pattern:"$id"in t.record?t.record.$id.value?"edit":"create":"create",workplace:t.workplace}).then(p=>{kb.record.set(f,k,p.record);p=new Event("change");f.attr("unsaved","unsaved").dispatchEvent(p)}).catch(()=>{})}):(kb.record.set(f,k,n.record),(t=>{f.attr("unsaved","unsaved").dispatchEvent(t)})(new Event("change"))))})})(d.closest("[form-id=form_"+k.id+"]"),d.closest(".kb-scope"))};d.attr("field-id")&&((a,f)=>{if(f.lookup)(l=>{a.elm(".kb-search").on("click",n=>{l(a.elm(".kb-lookup-search").val(),
kb.extend({},f))});a.elm(".kb-open").on("click",n=>{((t,p)=>{a.elm(".kb-lookup-search").val()?kb.view.records.get(p,kb.filter.query.create({code:f.lookup.relatedKeyField},"=",{type:f.type,value:a.elm(".kb-lookup-search").val()})).then(h=>{0!=h.length&&window.open(kb.record.page.detail(t,p,h.first().$id.value))}).catch(h=>kb.alert(kb.error.parse(h))):window.open(kb.record.page.add(t,p))})(location.href.match(/\/m\//g)?!0:!1,f.lookup.relatedApp.app)});a.elm(".kb-clear").on("click",n=>{kb.confirm(kb.constants.common.message.confirm.delete[kb.operator.language],
()=>{a.lookup("").then(()=>b("kb.change."+f.code))})});a.elm("input").on("change",n=>{l(n.currentTarget.val(),kb.extend({},f))})})((l,n)=>{this.load(n.lookup.relatedApp.app).then(t=>{(p=>{var h=()=>{n.picker=(r=>{var e={};r.each((v,q)=>{v in p.external&&(e[v]=kb.extend({},p.external[v]))});0==Object.keys(e).length&&(e.$id={code:"$id",type:"RECORD_NUMBER",label:kb.constants.picker.caption.recordnumber[kb.operator.language],required:!1,noLabel:!1});return e})(n.lookup.lookupPickerFields);a.recordPicker.show({app:n.lookup.relatedApp.app,
query:n.query,sort:n.lookup.sort||"$id asc",picker:n.picker},r=>a.lookup(r.$id.value).then(()=>b("kb.change."+n.code)))};l?(n.query=[n.lookup.filterCond,n.lookup.relatedKeyField+("NUMBER"==n.type?"=":" like ")+'"'+l+'"'].filter(r=>r).join(" and "),kintone.api(kintone.api.url("/k/v1/records",!0),"GET",{app:n.lookup.relatedApp.app,query:n.query}).then(r=>{1==r.records.length?a.lookup(r.records.first().$id.value).then(()=>b("kb.change."+n.code)):h()}).catch(r=>kb.alert(kb.error.parse(r)))):(n.query=
n.lookup.filterCond,h())})({external:t.parallelize,internal:g})})}),a.recordPicker=new KintoneBoosterRecordPicker("record"),a.lookup=l=>new Promise((n,t)=>{(p=>{var h=()=>{kb.record.set(p,f.tableCode?k.fields[f.tableCode]:k,(()=>f.lookup.fieldMappings.reduce((r,e)=>{if(e.field in g)switch(g[e.field].type){case "CHECK_BOX":case "FILE":case "GROUP_SELECT":case "MULTI_SELECT":case "ORGANIZATION_SELECT":case "USER_SELECT":r[e.field]={value:[]};break;default:r[e.field]={value:""}}return r},(r=>{r[f.code]=
{value:""};return r})({})))(),!1).then(()=>n())};l?kintone.api(kintone.api.url("/k/v1/record",!0),"GET",{app:f.lookup.relatedApp.app,id:l}).then(r=>{r.record?kb.record.set(p,f.tableCode?k.fields[f.tableCode]:k,(()=>f.lookup.fieldMappings.reduce((e,v)=>{v.relatedField in r.record&&v.field in g&&(e[v.field]={value:r.record[v.relatedField].value});return e},(e=>{e[f.code]={value:r.record[f.lookup.relatedKeyField].value};return e})({})))(),!1).then(()=>n()):h()}).catch(r=>kb.alert(kb.error.parse(r))):
h()})(a.closest(".kb-scope"))});else switch(f.type){case "CHECK_BOX":case "MULTI_SELECT":f.required&&(a.alert=l=>{a.elm(".kb-field-alert")||a.append(c().addClass("kb-field-alert"));a.elm(".kb-field-alert").elm("span").html(l).parentNode.show()});break;case "COLOR":a.elm(".kb-search").on("click",l=>{kb.pickupColor(n=>{a.css({backgroundColor:n}).elm("input").val(n);b("kb.change."+f.code)})});a.elm("input").on("change",l=>{l.currentTarget.val()?(l=l.currentTarget.val().replace(/#/g,""),l.match(/([0-9A-Fa-f]{3}|[0-9A-Fa-f]{6})$/g)&&
(a.css({backgroundColor:"#"+l}).elm("input").val("#"+l),b("kb.change."+f.code))):(a.css({backgroundColor:"transparent"}),b("kb.change."+f.code))});break;case "CONDITION":a.elm(".kb-search").on("click",l=>{kb.filter.build(f.app,a.elm("input").val(),n=>{a.elm("input").val(n);b("kb.change."+f.code)})});a.reset=l=>{f.app=l;a.elm("input").val("");a.elm(".kb-guide").empty()};a.guide=l=>{a.elm(".kb-guide").append((n=>{n.append(kb.create("button").addClass("kb-icon kb-icon-del kb-guide-item-icon").on("click",
t=>{kb.confirm(kb.constants.common.message.confirm.delete[kb.operator.language],()=>{a.elm("input").val(a.elm("input").val().split(" and ").filter(p=>p!=l).join(" and "));b("kb.change."+f.code)})})).append(kb.create("span").addClass("kb-guide-item-label").html(l));return n})(kb.create("span").addClass("kb-guide-item")))};f.required&&(a.alert=l=>{a.elm(".kb-field-alert")||a.append(c().addClass("kb-field-alert"));a.elm(".kb-field-alert").elm("span").html(l).parentNode.show()});break;case "DATE":a.elm(".kb-search").on("click",
l=>{kb.pickupDate(a.elm("input").val(),n=>{a.elm("input").val(n);b("kb.change."+f.code)})});break;case "DATETIME":a.elm(".kb-search").on("click",l=>{kb.pickupDate(a.elm("input").val(),n=>{a.elm("input").val(n);b("kb.change."+f.code)})});break;case "FILE":a.elm(".kb-search").on("click",l=>{(n=>{kb.elm("body").append(n.on("change",t=>{t.currentTarget.files?(p=>{kb.file.upload(Array.from(t.currentTarget.files).first()).then(h=>{a.elm("input").val(JSON.stringify((a.elm("input").val()?JSON.parse(a.elm("input").val()):
[]).concat(h)));b("kb.change."+f.code)}).catch(h=>kb.alert(kb.error.parse(h))).finally(()=>document.body.removeChild(n))})(Array.from(t.currentTarget.files).first()):document.body.removeChild(n)}));n.click()})(kb.create("input").attr("type","file").css({display:"none"}))});a.guide=l=>{a.elm(".kb-guide").append((n=>{n.append(kb.create("button").addClass("kb-icon kb-icon-del kb-guide-item-icon").on("click",t=>{kb.confirm(kb.constants.common.message.confirm.delete[kb.operator.language],()=>{a.elm("input").val(JSON.stringify(JSON.parse(a.elm("input").val()).filter(p=>
p.fileKey!=l.fileKey)));b("kb.change."+f.code)})})).append(kb.create("span").addClass("kb-guide-item-label").html(l.name).on("click",t=>a.open(l)));return n})(kb.create("span").addClass("kb-guide-item")))};a.open=l=>{kb.event.call("kb.attachment.call",{mode:"download",downloadable:!0}).then(n=>kb.attachment.show(l,n.downloadable)).catch(()=>{})};f.required&&(a.alert=l=>{a.elm(".kb-field-alert")||a.append(c().addClass("kb-field-alert"));a.elm(".kb-field-alert").elm("span").html(l).parentNode.show()});
break;case "GROUP_SELECT":case "ORGANIZATION_SELECT":case "USER_SELECT":(l=>{a.elm(".kb-search").on("click",n=>{a.recordPicker.show({picker:{name:{code:"name",type:"SINGLE_LINE_TEXT",label:kb.constants.picker.caption.name[kb.operator.language],required:!1,noLabel:!0}}},t=>{(p=>{(h=>{t.each((r,e)=>{h.includes(r.code.value)||p.push({code:r.code.value,name:r.name.value})})})(p.map(h=>h.code));a.elm("input").val(JSON.stringify(p));b("kb.change."+f.code)})(a.elm("input").val()?JSON.parse(a.elm("input").val()):
[])})});a.recordPicker=new KintoneBoosterRecordPicker(l,!0,(()=>{var n=[];f.loginuser&&n.push({code:{value:"LOGINUSER()"},name:{value:"Login user"}});f.guestuser&&n.push({code:{value:"GUESTUSER()"},name:{value:"Guest user"}});return n})());a.guide=n=>{a.elm(".kb-guide").append((t=>{t.append(kb.create("button").addClass("kb-icon kb-icon-del kb-guide-item-icon").on("click",p=>{kb.confirm(kb.constants.common.message.confirm.delete[kb.operator.language],()=>{a.elm("input").val(JSON.stringify(JSON.parse(a.elm("input").val()).filter(h=>
h.code!=n.code)));b("kb.change."+f.code)})})).append(kb.create("span").addClass("kb-guide-item-label").html(n.name));return t})(kb.create("span").addClass("kb-guide-item")))};f.required&&(a.alert=n=>{a.elm(".kb-field-alert")||a.append(c().addClass("kb-field-alert"));a.elm(".kb-field-alert").elm("span").html(n).parentNode.show()})})((()=>{var l="";switch(f.type){case "GROUP_SELECT":l="group";break;case "ORGANIZATION_SELECT":l="organization";break;case "USER_SELECT":l="user"}return l})());case "NUMBER":(l=>
{a.on("show",n=>l());l()})(()=>{a.elm(".kb-unit")?a.elm("input").css({width:"calc(100% - "+a.elm(".kb-unit").outerWidth(!0)+"px)"}):a.elm("input").css({width:null})});break;case "RADIO_BUTTON":a.elms("[data-name="+f.code+"]").each((l,n)=>{l.closest("label").on("click",t=>{(p=>{a.elms("[data-name="+f.code+"]").each((h,r)=>h.checked=p==h.val());b("kb.change."+f.code)})(l.val());t.stopPropagation();t.preventDefault()})});break;case "TIME":a.elm(".kb-hour").elm("select").on("change",l=>{l.currentTarget.val()||
a.elm(".kb-minute").elm("select").val("");b("kb.change."+f.id)}),a.elm(".kb-minute").elm("select").on("change",l=>{l.currentTarget.val()||a.elm(".kb-hour").elm("select").val("");b("kb.change."+f.id)})}a.elms("input,select,textarea").each((l,n)=>{switch(f.type){case "COLOR":case "CONDITION":case "FILE":case "GROUP_SELECT":case "ORGANIZATION_SELECT":case "RADIO_BUTTON":case "TIME":case "USER_SELECT":break;default:l.on("change",t=>b("kb.change."+f.code))}})})(d.elm(".kb-field-value"),g[d.attr("field-id")]);
return d}blobToBase64(d,k){var m=new FileReader;m.onload=()=>{k(m.result.replace(/^data:.+;base64,/,""))};m.readAsDataURL(d)}create(d,k=!1){var m=g=>{g.append(kb.create("div").addClass("kb-dropdown kb-hour").append(kb.create("select").assignOption((()=>{var c=[{value:""}];(24).each(b=>c.push({value:b.toString().lpad("0",2)}));return c})(),"value","value"))).append(kb.create("div").addClass("kb-dropdown kb-minute").append(kb.create("select").assignOption((()=>{var c=[{value:""}];(60).each(b=>c.push({value:b.toString().lpad("0",
2)}));return c})(),"value","value")))};if(!("type"in d))throw Error("You shoud setup [type] in field information");return(g=>{g.append(kb.create("span").addClass("kb-field-caption").html(d.label));d.noLabel&&g.elm(".kb-field-caption").addClass("kb-hidden");g.append((c=>{switch(d.type){case "CALC":switch(d.format){case "NUMBER":case "NUMBER_DIGIT":c.addClass("kb-number")}break;case "CHECK_BOX":case "MULTI_SELECT":(b=>{b.reduce((a,f)=>{a[f.index]=f;return a},Array(b.length).fill("")).each((a,f)=>{c.addClass("kb-checkbox").append(kb.create("label").append(kb.create("input").attr("type",
"checkbox").val(a.label)).append(kb.create("span").html(a.label)))})})(Object.values(d.options));break;case "COLOR":c.addClass("kb-color").append(kb.create("input").attr("type","text").attr("data-type","color")).append(kb.create("button").addClass("kb-icon kb-icon-color kb-search"));break;case "CONDITION":c.addClass("kb-condition").append(kb.create("input").attr("type","hidden")).append(kb.create("button").addClass("kb-icon kb-icon-filter kb-search"));break;case "CREATOR":case "CREATED_TIME":case "MODIFIER":case "UPDATED_TIME":c.append(kb.create("input").attr("type",
"hidden").attr("data-type",d.type.toLowerCase()));break;case "DATE":c.addClass("kb-date").append(kb.create("input").attr("type","text").attr("data-type","date")).append(kb.create("button").addClass("kb-icon kb-icon-date kb-search"));break;case "DATETIME":m(c.addClass("kb-datetime").append(kb.create("input").attr("type","text").attr("data-type","date")).append(kb.create("button").addClass("kb-icon kb-icon-date kb-search")));break;case "DROP_DOWN":(b=>{k?c.addClass("kb-dropdown").append(kb.create("select").assignOption([{label:""}].concat(b.reduce((a,
f)=>{f.label&&(a[f.index]=f);return a},Array(b.length).fill(""))),"label","label")):c.addClass("kb-dropdown").append(kb.create("select").assignOption(b.reduce((a,f)=>{a[f.index]=f;return a},Array(b.length).fill("")),"label","label"))})(Object.values(d.options));break;case "FILE":c.addClass("kb-file").append(kb.create("input").attr("type","hidden")).append(kb.create("button").addClass("kb-icon kb-icon-file kb-search"));break;case "GROUP_SELECT":c.addClass("kb-group").append(kb.create("input").attr("type",
"hidden")).append(kb.create("button").addClass("kb-icon kb-icon-group kb-search"));break;case "LINK":switch(d.protocol){case "WEB":c.addClass("kb-text").append(kb.create("input").attr("type","text").attr("data-type","url"));break;case "CALL":c.addClass("kb-text").append(kb.create("input").attr("type","text").attr("data-type","tel"));break;case "MAIL":c.addClass("kb-text").append(kb.create("input").attr("type","text").attr("data-type","mail"))}break;case "MULTI_LINE_TEXT":case "RICH_TEXT":c.addClass("kb-textarea").append((b=>
{d.lines&&b.css({height:"calc("+(1.5*parseFloat(d.lines)).toString()+"em + 2px)"});return b})(kb.create("textarea")));break;case "NUMBER":d.lookup?c.addClass("kb-lookup").append(kb.create("input").addClass("kb-lookup-search").attr("type","text").attr("data-type","nondemiliternumber")).append(kb.create("button").addClass("kb-icon kb-icon-lookup kb-search")).append(kb.create("button").addClass("kb-icon kb-icon-open kb-open")).append(kb.create("button").addClass("kb-icon kb-icon-del kb-clear")):(c.addClass("kb-number").append((b=>
{"displayScale"in d&&b.attr("data-decimals",d.displayScale);return b.attr("data-type",d.digit?"number":"nondemiliternumber")})(kb.create("input").attr("type","text"))),d.unit&&(b=>{"prefix"==d.unitPosition?c.insertBefore(b,c.elm("input")):c.insertBefore(b,c.elm("input").nextElementSibling)})(kb.create("span").addClass("kb-unit").html(d.unit)));break;case "ORGANIZATION_SELECT":c.addClass("kb-organization").append(kb.create("input").attr("type","hidden")).append(kb.create("button").addClass("kb-icon kb-icon-organization kb-search"));
break;case "RADIO_BUTTON":(b=>{b.reduce((a,f)=>{a[f.index]=f;return a},Array(b.length).fill("")).each((a,f)=>{var l=c.addClass("kb-radio"),n=l.append;a=kb.create("label").append(kb.create("input").attr("type","radio").attr("data-name",d.code).val(a.label)).append(kb.create("span").html(a.label));0==f&&(a.elm("input").checked=!0);n.call(l,a)})})(Object.values(d.options));break;case "RECORD_NUMBER":c.addClass("kb-id");break;case "SINGLE_LINE_TEXT":if(d.lookup)c.addClass("kb-lookup").append(kb.create("input").addClass("kb-lookup-search").attr("type",
"text").attr("data-type","text")).append(kb.create("button").addClass("kb-icon kb-icon-lookup kb-search")).append(kb.create("button").addClass("kb-icon kb-icon-open kb-open")).append(kb.create("button").addClass("kb-icon kb-icon-del kb-clear"));else switch(d.format){case "password":c.addClass("kb-text").append(kb.create("input").attr("type","password").attr("data-type",d.type));break;default:c.addClass("kb-text").append(kb.create("input").attr("type","text").attr("data-type",d.format?d.format:"text"))}break;
case "SPACER":c.html(d.contents);break;case "TIME":m(c);break;case "USER_SELECT":c.addClass("kb-user").append(kb.create("input").attr("type","hidden")).append(kb.create("button").addClass("kb-icon kb-icon-user kb-search"))}return"SPACER"!=d.type?c.append(kb.create("span").addClass("kb-guide")):c})(kb.create("div").addClass("kb-field-value")));switch(d.type){case "CALC":case "CATEGORY":case "CONDITION":case "CREATED_TIME":case "CREATOR":case "FILE":case "GROUP_SELECT":case "MODIFIER":case "ORGANIZATION_SELECT":case "RECORD_NUMBER":case "REFERENCE_TABLE":case "STATUS":case "STATUS_ASSIGNEE":case "UPDATED_TIME":case "USER_SELECT":g.elm(".kb-guide").addClass("kb-fixed")}if(d.required)switch(d.type){case "CALC":case "CATEGORY":case "CHECK_BOX":case "CONDITION":case "CREATED_TIME":case "CREATOR":case "FILE":case "GROUP_SELECT":case "MODIFIER":case "MULTI_SELECT":case "ORGANIZATION_SELECT":case "RECORD_NUMBER":case "REFERENCE_TABLE":case "STATUS":case "STATUS_ASSIGNEE":case "UPDATED_TIME":case "USER_SELECT":break;
default:g.elms("input,select,textarea").each((c,b)=>c.attr("required","required"))}d.placeholder&&g.elms("input,select,textarea").each((c,b)=>c.attr("placeholder",d.placeholder));return g})(kb.create("div").addClass("kb-field").attr("field-id",d.code))}get(d,k,m){var g=null;if(d.tableCode)g=kb.elms(".field-"+d.id).map(c=>{switch(m){case "create":case "edit":c.value=k?c.elm("input[type=text],textarea,ul")?c.elm("input[type=text],textarea,ul"):c.elm("[class^=forms-]"):c.elm(".input-checkbox-cybozu,.input-date-cybozu,.input-datetime-cybozu,.input-file-cybozu,.input-radio-cybozu,.input-text-outer-cybozu,.input-time-cybozu,.multipleselect-cybozu,.select-cybozu");
break;case "detail":case "print":c.value=k?c.elm(".value-"+d.id):c}return c});else switch(g=kb.elm(".field-"+d.id),m){case "create":case "edit":g.value=k?g.elm("input[type=text],textarea,ul")?g.elm("input[type=text],textarea,ul"):g.elm("[class^=forms-]"):g.elm(".input-checkbox-cybozu,.input-date-cybozu,.input-datetime-cybozu,.input-file-cybozu,.input-radio-cybozu,.input-text-outer-cybozu,.input-time-cybozu,.multipleselect-cybozu,.select-cybozu");break;case "detail":case "print":g.value=g.elm(".value-"+
d.id)}return g}isEmpty(d){var k=!0;if(Array.isArray(d))k=0==d.length;else switch(typeof d){case "object":k=null===d||0==Object.keys(d).length;break;case "number":k=Number.isNaN(d);break;case "string":k=0==d.toString().length}return k}load(d,k){return new Promise((m,g)=>{d in this.cache?m(this.cache[d]):kintone.api(kintone.api.url("/k/v1/app/form/layout",!0),"GET",{app:d}).then(c=>{(b=>{var a=[],f=[],l=[],n=t=>t.reduce((p,h)=>{switch(h.type){case "GROUP":a.push(h.code);p=p.concat(n(h.layout));break;
case "ROW":f=h.fields.reduce((r,e)=>{e.elementId&&r.push(e);return r},f);p=h.fields.reduce((r,e)=>{"code"in e&&r.push(e.code);return r},p);break;case "SUBTABLE":l.push({code:h.code,fields:h.fields}),p=h.fields.reduce((r,e)=>{"code"in e&&r.push(e.code);return r},p)}return p},[]);kintone.api(kintone.api.url("/k/v1/app/form/fields",!0),"GET",{app:d,lang:"user"}).then(t=>{(p=>{p.each((h,r)=>{delete t.properties[h]})})(Object.values(t.properties).reduce((p,h)=>{switch(h.type){case "CATEGORY":h.enabled||
p.push(h.code);break;case "STATUS":h.enabled||(p.push(h.code),p.push(Object.values(t.properties).filter(r=>"STATUS_ASSIGNEE"==r.type).first().code))}return p},[]));((p,h,r)=>{this.cache[d]={origin:t.properties,groups:a.reduce((e,v)=>{e[v]=t.properties[v];return e},{}),tables:l.reduce((e,v)=>{e[v.code]=(q=>{q.fields=v.fields.reduce((u,w)=>{u[w.code]=p[w.code];return u},{});return q})(t.properties[v.code]);v.code in r.table&&(e[v.code].id=r.table[v.code]);return e},{}),changes:(e=>{var v=[];v=Object.values(p).reduce((q,
u)=>{e.includes(u.code)||q.push(u.code);return q},[]);return v.concat(l.map(q=>q.code))})((()=>{var e=[],v;for(v in p)(q=>{kb.field.reserved.includes(q.type)?e.push(q.code):(q.expression&&e.push(q.code),q.lookup&&(e.push(q.code),(u=>{u.field&&(e=e.concat(q.lookup.fieldMappings.reduce((w,x)=>{x.field!=u.field&&w.push(x.field);return w},[])))})(q.lookup.fieldMappings.reduce((u,w)=>{u.index<h.indexOf(w.field)&&(u={index:h.indexOf(w.field),field:w.field});return u},{index:-1,field:null}))))})(p[v]);return Array.from(new Set(e))})()),
criterias:(()=>{var e={};h.each((q,u)=>{["FILE","REFERENCE_TABLE"].includes(p[q].type)||(e[q]=p[q])});for(var v in p)(q=>{switch(q.type){case "CALC":case "CREATED_TIME":case "CREATOR":case "MODIFIER":case "RECORD_NUMBER":case "UPDATED_TIME":e[q.code]=q;break;case "STATUS":q.enabled&&(e[q.code]=q,(u=>{e[u.code]=u})(Object.values(p).filter(u=>"STATUS_ASSIGNEE"==u.type).first()))}})(p[v]);return e})(),disables:(()=>{var e=[],v;for(v in p)(q=>{kb.field.reserved.includes(q.type)?e.push(q.code):(q.expression&&
e.push(q.code),q.lookup&&(u=>{0!=u.length&&(e=e.concat(u))})(q.lookup.fieldMappings.map(u=>u.field)))})(p[v]);return Array.from(new Set(e))})(),parallelize:(()=>{var e={};h.each((q,u)=>{e[q]=p[q]});for(var v in p)(q=>{switch(q.type){case "CATEGORY":q.enabled&&(e[q.code]=q);break;case "CREATED_TIME":case "CREATOR":case "MODIFIER":case "RECORD_NUMBER":case "UPDATED_TIME":e[q.code]=q;break;case "STATUS":q.enabled&&(e[q.code]=q,(u=>{e[u.code]=u})(Object.values(p).filter(u=>"STATUS_ASSIGNEE"==u.type).first()))}q.code in
r.field&&q.code in e&&(e[q.code].id=r.field[q.code])})(p[v]);return e})(),placed:(()=>{var e={};h.each((v,q)=>{["REFERENCE_TABLE"].includes(p[v].type)||(e[v]=p[v])});return e})(),spacers:f,sorts:(()=>{var e={};h.each((q,u)=>{q=p[q];switch(q.type){case "CALC":case "CREATED_TIME":case "CREATOR":case "DATE":case "DATETIME":case "DROP_DOWN":case "LINK":case "MODIFIER":case "NUMBER":case "RADIO_BUTTON":case "RECORD_NUMBER":case "SINGLE_LINE_TEXT":case "TIME":case "UPDATED_TIME":q.tableCode||(e[q.code]=
q)}});for(var v in p)(q=>{switch(q.type){case "CALC":case "CREATED_TIME":case "CREATOR":case "MODIFIER":case "RECORD_NUMBER":case "UPDATED_TIME":e[q.code]=q;break;case "STATUS":q.enabled&&(e[q.code]=q)}})(p[v]);return e})()};m(this.cache[d])})(kb.field.parallelize(t.properties),n(b),(()=>{var p={field:{},table:{}};k&&(Object.values(cybozu.data.page.FORM_DATA.schema.table.fieldList).each((h,r)=>{p.field[h.var]=h.id}),"subTable"in cybozu.data.page.FORM_DATA.schema&&Object.values(cybozu.data.page.FORM_DATA.schema.subTable).each((h,
r)=>{p.table[h.var]=h.id;Object.values(h.fieldList).each((e,v)=>{p.field[e.var]=e.id})}));return p})())}).catch(t=>kb.alert(kb.error.parse(t)))})(c.layout)}).catch(c=>kb.alert(kb.error.parse(c)))})}parallelize(d){d=kb.extend({},d);var k={},m;for(m in d){var g=void 0,c=d[m];switch(c.type){case "SUBTABLE":var b=c.code;for(g in c.fields)c.fields[g]=kb.extend({tableCode:b},c.fields[g]),k[c.fields[g].code]=c.fields[g];break;default:c=kb.extend({tableCode:""},c),k[c.code]=c}}return k}stringify(d,k,m,g=
!1){var c="";if(d&&k)switch(d.type){case "CATEGORY":case "CHECK_BOX":case "MULTI_SELECT":c=k.join(m);break;case "CREATOR":case "MODIFIER":c=k.name;break;case "CREATED_TIME":case "DATETIME":case "UPDATED_TIME":c=k.parseDateTime().format("Y-m-d H:i");break;case "FILE":case "GROUP_SELECT":case "ORGANIZATION_SELECT":case "STATUS_ASSIGNEE":case "USER_SELECT":c=k.map(b=>b.name).join(m);break;case "MULTI_LINE_TEXT":case "RICH_TEXT":c=g?k:k.replace(/\n/g,"");break;case "NUMBER":kb.isNumeric(k)&&(c=d.digit?
Number(k).comma(d.displayScale):d.displayScale?Number(k).toFloor(parseInt(d.displayScale)):k);d.unit&&(c="prefix"==d.unitPosition?d.unit+" "+c:c+" "+d.unit);break;default:c=k}return c}typing(d,k,m=!1){var g=!1;if("SINGLE_LINE_TEXT"==k.type)switch(d.type){case "CALC":case "CREATED_TIME":case "DATE":case "DATETIME":case "DROP_DOWN":case "LINK":case "NUMBER":case "RADIO_BUTTON":case "RECORD_NUMBER":case "SINGLE_LINE_TEXT":case "STATUS":case "TIME":case "UPDATED_TIME":g=m?!0:!k.expression}if(!g)switch(d.type){case "CALC":if(k.type==
d.type)g=k.format==d.format&&m;else switch(d.format){case "DATE":case "DATETIME":case "TIME":g=k.type==d.format;break;case "NUMBER":case "NUMBER_DIGIT":g=(m?["NUMBER","RECORD_NUMBER"]:["NUMBER"]).includes(k.type)}break;case "CHECK_BOX":case "MULTI_SELECT":g=["CHECK_BOX","MULTI_SELECT"].includes(k.type);break;case "CREATED_TIME":case "DATETIME":case "UPDATED_TIME":g="CALC"==k.type?"DATETIME"==k.format&&m:(m?["CREATED_TIME","DATETIME","UPDATED_TIME"]:["DATETIME"]).includes(k.type);break;case "CREATOR":case "MODIFIER":case "STATUS_ASSIGNEE":case "USER_SELECT":g=
(m?["CREATOR","MODIFIER","STATUS_ASSIGNEE","USER_SELECT"]:["USER_SELECT"]).includes(k.type);break;case "DATE":g="CALC"==k.type?"DATE"==k.format&&m:k.type==d.type;break;case "DROP_DOWN":case "RADIO_BUTTON":g=["DROP_DOWN","LINK","RADIO_BUTTON"].includes(k.type);break;case "FILE":case "MULTI_LINE_TEXT":case "RICH_TEXT":g=m?!1:k.type==d.type;break;case "GROUP_SELECT":case "LINK":case "ORGANIZATION_SELECT":case "STATUS":case "TIME":g=k.type==d.type;break;case "NUMBER":case "RECORD_NUMBER":g="CALC"==k.type?
"NUMBER"==k.format&&m:(m?["NUMBER","RECORD_NUMBER"]:["NUMBER"]).includes(k.type);break;case "SINGLE_LINE_TEXT":g=m?["DROP_DOWN","RADIO_BUTTON","LINK","MULTI_LINE_TEXT","RICH_TEXT"].includes(k.type):["LINK","MULTI_LINE_TEXT","RICH_TEXT"].includes(k.type)}return g}objectUrl(d,k){var m=null,g=window.URL||window.webkitURL;if("string"===typeof d){var c=atob(d),b=new Uint8Array(c.length);c.length.each(a=>b[a]=c.charCodeAt(a));m=new Blob([b.buffer],{type:k})}else m=d;return g.createObjectURL(m)}};
window.KintoneBoosterTable=class{constructor(){}activate(d,k){return d.spread((m,g)=>{(c=>{m.elm(".kb-table-row-add").on("click",b=>{d.insertRow(m);kb.event.call("kb.row.add."+d.attr("field-id"),{container:d,record:kb.record.get(c,k,!0).record,rowindex:parseInt(m.attr("row-idx"))+1}).then(a=>{a.error?d.delRow(m):kb.event.call("kb.action.call",{container:c,record:a.record,mobile:location.href.match(/\/m\//g)?!0:!1,pattern:"change",field:d.attr("field-id"),workplace:c.closest(".kb-view")?"view":"record"}).then(f=>
{kb.event.call("kb.style.call",{container:c,record:f.record,mobile:f.mobile,pattern:"$id"in f.record?f.record.$id.value?"edit":"create":"create",workplace:f.workplace}).then(l=>{kb.record.set(c,k,l.record);l=new Event("change");c.attr("unsaved","unsaved").dispatchEvent(l)}).catch(()=>{})})})});m.elm(".kb-table-row-copy").on("click",b=>{d.insertRow(m);kb.event.call("kb.row.copy."+d.attr("field-id"),{container:d,record:((a,f)=>{a[d.attr("field-id")].value[f+1]={value:kb.extend({},a[d.attr("field-id")].value[f].value)};
return a})(kb.record.get(c,k,!0).record,parseInt(m.attr("row-idx"))),rowindex:parseInt(m.attr("row-idx"))+1}).then(a=>{a.error?d.delRow(m):kb.event.call("kb.action.call",{container:c,record:a.record,mobile:location.href.match(/\/m\//g)?!0:!1,pattern:"change",field:d.attr("field-id"),workplace:c.closest(".kb-view")?"view":"record"}).then(f=>{kb.event.call("kb.style.call",{container:c,record:f.record,mobile:f.mobile,pattern:"$id"in f.record?f.record.$id.value?"edit":"create":"create",workplace:f.workplace}).then(l=>
{kb.record.set(c,k,l.record);l=new Event("change");c.attr("unsaved","unsaved").dispatchEvent(l)}).catch(()=>{})})})});m.elm(".kb-table-row-del").on("click",b=>{kb.confirm(kb.constants.common.message.confirm.delete[kb.operator.language],()=>{kb.event.call("kb.row.del."+d.attr("field-id"),{container:d,record:kb.record.get(c,k,!0).record,rowindex:parseInt(m.attr("row-idx"))}).then(a=>{a.error||(d.delRow(m),kb.event.call("kb.action.call",{container:c,record:kb.record.get(c,k,!0).record,mobile:location.href.match(/\/m\//g)?
!0:!1,pattern:"change",field:d.attr("field-id"),workplace:c.closest(".kb-view")?"view":"record"}).then(f=>{kb.event.call("kb.style.call",{container:c,record:f.record,mobile:f.mobile,pattern:"$id"in f.record?f.record.$id.value?"edit":"create":"create",workplace:f.workplace}).then(l=>{kb.record.set(c,k,l.record);l=new Event("change");c.attr("unsaved","unsaved").dispatchEvent(l)}).catch(()=>{})}))})})});m.elms(".kb-field").each((b,a)=>kb.field.activate(b,k));d.tr.each((b,a)=>b.attr("row-idx",a))})(d.closest("[form-id=form_"+
k.id+"]"))},(m,g)=>{0==m.tr.length?m.addRow():m.tr.each((c,b)=>c.attr("row-idx",b))},!1)}create(d,k,m,g,c){return(b=>{m||g||b.append(kb.create("thead").append(kb.create("tr")));b.append(kb.create("tbody").append(kb.create("tr").addClass("kb-scope").attr("row-idx","")));for(var a in d.fields)(f=>{m||g||b.elm("thead tr").append(kb.create("th").append(kb.create("span").html(f.label)));var l=b.elm("tbody tr"),n=l.append,t=kb.create("td"),p=t.append,h=kb.field,r=h.create;f=kb.extend({},f);g||(f.noLabel=
!0);n.call(l,p.call(t,r.call(h,f,c)))})(d.fields[a]);m||g||b.elm("thead tr").append(kb.create("th").addClass("kb-table-button"+(k?" kb-table-button-extension":"")));b.elm("tbody tr").append(kb.create("td").addClass("kb-table-button"+(k?" kb-table-button-extension":"")).append(kb.create("button").addClass("kb-icon kb-icon-add kb-table-row-add")).append(kb.create("button").addClass("kb-icon kb-icon-copy kb-table-row-copy").css({display:k?"inline-block":"none"})).append(kb.create("button").addClass("kb-icon kb-icon-del kb-table-row-del")));
for(a in d.fields)(f=>{f.lookup&&f.lookup.fieldMappings.each((l,n)=>{l.field in d.fields&&b.elm('[field-id="'+CSS.escape(l.field)+'"]')&&b.elm('[field-id="'+CSS.escape(l.field)+'"]').addClass("kb-readonly")})})(d.fields[a]);return b.attr("field-id",d.code)})(kb.create("table").addClass("kb-table"))}};
window.KintoneBoosterView=class{constructor(){this.records={delete:(d,k,m=!1)=>new Promise((g,c)=>{var b=(a,f)=>{0!=k.length?kintone.api(kintone.api.url("/k/v1/records",!0),"DELETE",{app:d,ids:k.slice(a,a+100)}).then(l=>{m||kb.progressUpdate();a+=100;0<k.slice(a,a+100).length?b(a,f):f()}).catch(l=>c(l)):f()};m||kb.progressStart(Math.ceil(k.length/100));b(0,()=>{m||kb.progressEnd();g()})}),get:(d,k,m)=>new Promise((g,c)=>{(b=>{var a=(f,l,n)=>{kintone.api(kintone.api.url("/k/v1/records",!0),"GET",{app:d,
query:k+" order by "+b+" limit 500 offset "+l.toString()}).then(t=>{Array.prototype.push.apply(f,t.records);l+=500;500==t.records.length?a(f,l,n):n(f)}).catch(t=>c(t))};kintone.api(kintone.api.url("/k/v1/records",!0),"GET",{app:d,query:k,totalCount:!0}).then(f=>{1E4>f.totalCount?a([],0,l=>g(l)):kintone.api(kintone.api.url("/k/v1/records/cursor",!0),"POST",{app:d,query:k+" order by "+b,size:500}).then(l=>{(n=>{var t=(p,h)=>{kintone.api(kintone.api.url("/k/v1/records/cursor",!0),"GET",{id:n}).then(r=>
{Array.prototype.push.apply(p,r.records);r.next?t(p,h):h(p)}).catch(r=>c(r))};t([],p=>g(p))})(l.id)}).catch(l=>c(l))}).catch(f=>c(f))})(m||"$id asc")}),set:(d,k,m=!1,g=!1)=>new Promise((c,b)=>{var a=(l,n)=>{0!=k.post.length?kintone.api(kintone.api.url("/k/v1/records",!0),"POST",{app:d,records:k.post.slice(l,l+100)}).then(t=>{m||kb.progressUpdate();l+=100;0<k.post.slice(l,l+100).length?a(l,n):n(t.ids.last())}).catch(t=>b(t)):n()},f=(l,n)=>{0!=k.put.length?kintone.api(kintone.api.url("/k/v1/records",
!0),"PUT",{app:d,records:(t=>{g&&(t=t.map(p=>this.records.transform(p.record)));return t})(k.put.slice(l,l+100))}).then(t=>{m||kb.progressUpdate();l+=100;0<k.put.slice(l,l+100).length?f(l,n):n()}).catch(t=>b(t)):n()};"post"in k||(k.post=[]);"put"in k||(k.put=[]);m||kb.progressStart(Math.ceil(k.post.length/100)+Math.ceil(k.put.length/100));a(0,l=>{f(0,()=>{m||kb.progressEnd();c(l)})})}),transform:(d,k="PUT")=>{var m=null;switch(k){case "POST":m=(()=>{var g={},c;for(c in d)kb.field.reserved.includes(d[c].type)||
(g[c]=d[c]);return g})();break;case "PUT":m={id:d.$id.value,record:(()=>{var g={},c;for(c in d)kb.field.reserved.includes(d[c].type)||(g[c]=d[c]);return g})()}}return m}}}create(d,k,m,g){var c={key:()=>"view_"+k.id+"_"+m+"_"+location.host.split(".").first(),set:b=>{var a=c.key(),f="[view-id=view_"+k.id+"_"+m+"] .kb-guide{min-width:auto !important;}";kb.elm("[view-id=view_"+k.id+"_"+m+"]").elms(".kb-view-head-resizer").each((l,n)=>{n=l.closest(".kb-view-head-cell");if(!n.hasClass("kb-unuse")){l=n.attr("column-id");
var t=150;b||kb.elm(".kb_spread_style_"+CSS.escape(a))&&kb.elm(".kb_spread_style_"+CSS.escape(a)).text().match(new RegExp('\\[column-id="'+CSS.escape(l)+'"\\]',"g"))&&(t=n.outerWidth(!1));n=t;f+="[view-id=view_"+k.id+"_"+m+'] [column-id="'+CSS.escape(l)+'"]{max-width:'+n+"px;width:"+n+"px;}";f+="[view-id=view_"+k.id+"_"+m+'] [field-id="'+CSS.escape(l)+'"]{width:'+n+"px;}"}});kb.elm(".kb_spread_style_"+CSS.escape(a))&&kb.elm("head").removeChild(kb.elm(".kb_spread_style_"+CSS.escape(a)));kb.elm("head").append(kb.create("style").addClass("kb_spread_style_"+
a).attr("media","screen").attr("type","text/css").text(f));localStorage.setItem(a,f)}};return d.append(((b,a,f)=>{var l=0,n=(p=>{var h="";g||(h=(p?2:0)+f.buttons.length,h="kb-view-button_shave"+h.toString());return h})("viewer"==f.mode),t=(p,h)=>{var r=p.changedTouches?Array.from(p.changedTouches).first():p,e=p.currentTarget.closest(".kb-view-head-cell"),v=r.pageX,q=p.currentTarget.closest(".kb-view-head-cell").outerWidth(!1),u={move:w=>{var x=!1,A=w.changedTouches?Array.from(w.changedTouches).first():
w,y=q+A.pageX-v;e.css({maxWidth:y.toString()+"px",width:y.toString()+"px"});b.elms('[field-id="'+CSS.escape(h)+'"]').each((z,B)=>z.css({width:y.toString()+"px"}));b.elms('[field-id="'+CSS.escape(h)+'"]').each((z,B)=>{y<z.outerWidth(!1)&&(y=z.outerWidth(!1),x=!0)});x&&e.css({maxWidth:y.toString()+"px",width:y.toString()+"px"});w.stopPropagation();w.preventDefault()},end:w=>{c.set();kb.elm("body").removeClass("kb-resizing");window.off("mousemove,touchmove",u.move);window.off("mouseup,touchend",u.end);
w.stopPropagation();w.preventDefault()}};kb.elm("body").addClass("kb-resizing");window.on("mousemove,touchmove",u.move);window.on("mouseup,touchend",u.end);p.stopPropagation();p.preventDefault()};b.append(kb.create("thead").append(kb.create("tr").addClass("kb-view-head"))).append(kb.create("tbody").append(kb.create("tr").addClass("kb-view-row")));b.elm("thead tr").append(kb.create("th").addClass("kb-view-head-cell kb-view-button "+n+" kb-view-guide"));b.elm("tbody tr").append(kb.create("td").addClass("kb-view-button "+
n+" kb-view-guide").append(kb.create("a").addClass("kb-icon kb-icon-edit kb-view-row-edit"+(f.buttons.includes("detail")?" kb-unuse":""))).append(kb.create("button").addClass("kb-icon kb-icon-add kb-view-row-add"+(f.buttons.includes("add")||"viewer"==f.mode?" kb-unuse":""))).append(kb.create("button").addClass("kb-icon kb-icon-copy kb-view-row-copy"+(f.buttons.includes("clone")||"viewer"==f.mode?" kb-unuse":""))).append(kb.create("button").addClass("kb-icon kb-icon-del kb-view-row-del"+(f.buttons.includes("delete")?
" kb-unuse":""))));(p=>{p.concat(Object.keys(a.fields).filter(h=>!p.includes(h))).each((h,r)=>{((e,v)=>{switch(e.type){case "SUBTABLE":for(var q in e.fields)b.elm("thead tr").append(((u,w)=>{v||l++;return u.addClass("kb-view-head-cell"+(v?" kb-unuse":"")).attr("column-id",w.code).append(kb.create("span").addClass("kb-view-head-caption").html(w.label)).append(kb.create("span").addClass("kb-view-head-resizer").on("mousedown,touchstart",x=>t(x,w.code)))})(kb.create("th"),e.fields[q])),e.fields[q].noLabel=
!g;"viewer"!=f.mode&&(v||l++,b.elm("thead tr").append(kb.create("th").addClass("kb-view-head-cell kb-view-button kb-view-button-tables"+(v?" kb-unuse":""))));break;default:b.elm("thead tr").append((u=>{v||l++;return u.addClass("kb-view-head-cell"+(v?" kb-unuse":"")).attr("column-id",e.code).append(kb.create("span").addClass("kb-view-head-caption").html(e.label)).append(kb.create("span").addClass("kb-view-head-resizer").on("mousedown,touchstart",w=>t(w,e.code)))})(kb.create("th"))),e.noLabel=!g}})(a.fields[h],
0!=f.fields.length?!f.fields.includes(h):!1)});b.elm("tbody tr").append((h=>{p.concat(Object.keys(a.fields).filter(r=>!p.includes(r))).each((r,e)=>{e=a.fields[r];r=0!=f.fields.length?!f.fields.includes(r):!1;switch(e.type){case "SUBTABLE":h.append(kb.create("div").addClass("kb-view-row-cell"+(r?" kb-unuse":"")).append(kb.table.create(e,!0,!0,g,!0)));break;default:h.append(kb.field.create(e,!0).addClass("kb-view-row-cell"+(r?" kb-unuse":"")))}});return h.append(kb.create("input").attr("type","hidden").attr("data-type",
"id"))})(kb.create("td").addClass("kb-scope").attr("form-id","form_"+a.id).attr("colspan",l.toString())))})(0!=f.fields.length?f.fields:Object.keys(a.fields));"viewer"==f.mode?(b.elms(".kb-field").each((p,h)=>p.addClass("kb-readonly")),b.elms(".kb-table-button").each((p,h)=>p.addClass("kb-readonly"))):a.disables.each((p,h)=>{b.elm('[field-id="'+CSS.escape(p.code)+'"]')&&b.elm('[field-id="'+CSS.escape(p.code)+'"]').addClass("kb-readonly")});return b.spread((p,h)=>{p.elm("[form-id=form_"+a.id+"]").on("change",
r=>{p.addClass("kb-unsaved")});p.elm(".kb-view-row-add").on("click",r=>{(e=>{kb.event.call("kb.view.add",{container:e.elm("[form-id=form_"+a.id+"]"),record:kb.record.get(e.elm("[form-id=form_"+a.id+"]"),a,!0).record,viewId:m}).then(v=>{v.error?b.delRow(e):kb.event.call("kb.action.call",{container:e.elm("[form-id=form_"+a.id+"]"),record:v.record,mobile:g,pattern:"create",workplace:"view"}).then(q=>{kb.event.call("kb.style.call",{container:e.elm("[form-id=form_"+a.id+"]"),record:q.record,mobile:q.mobile,
pattern:q.pattern,workplace:q.workplace}).then(u=>{kb.record.set(e.elm("[form-id=form_"+a.id+"]").attr("unsaved","unsaved"),a,u.record).then(()=>{kb.event.call("kb.view.add.complete",{container:e.elm("[form-id=form_"+a.id+"]"),viewId:m})});(w=>{e.elm("[form-id=form_"+a.id+"]").dispatchEvent(w)})(new Event("change"))}).catch(()=>{})}).catch(()=>{})})})(b.insertRow(p))});p.elm(".kb-view-row-del").on("click",r=>{(e=>{e?kb.confirm(kb.constants.common.message.confirm.delete[kb.operator.language],()=>{kb.event.call("kb.view.delete",
{container:p.elm("[form-id=form_"+a.id+"]"),record:kb.record.get(p.elm("[form-id=form_"+a.id+"]"),a,!0).record,viewId:m}).then(v=>{v.error||kb.view.records.delete(a.id,[e]).then(q=>b.delRow(p)).catch(q=>kb.alert(kb.error.parse(q)))})}):b.delRow(p)})(p.elm("[data-type=id]").val())});p.elm(".kb-view-row-copy").on("click",r=>{kb.confirm(kb.constants.common.message.confirm.copy[kb.operator.language],()=>{((e,v)=>{var q=Object.values(kb.field.parallelize(a.fields)).reduce((u,w)=>{"FILE"==w.type&&(w.tableCode?
e[w.tableCode].value.each((x,A)=>{Array.prototype.push.apply(u,x.value[w.code].value)}):Array.prototype.push.apply(u,e[w.code].value));return u},[]);kb.file.clone(q).then(()=>{kb.event.call("kb.view.copy",{container:v.elm("[form-id=form_"+a.id+"]"),record:(u=>{u.$id.value="";return u})(e),viewId:m}).then(u=>{u.error?b.delRow(v):kb.event.call("kb.action.call",{container:v.elm("[form-id=form_"+a.id+"]"),record:u.record,mobile:g,pattern:"reuse",workplace:"view"}).then(w=>{kb.event.call("kb.style.call",
{container:v.elm("[form-id=form_"+a.id+"]"),record:w.record,mobile:w.mobile,pattern:"create",workplace:w.workplace}).then(x=>{kb.record.set(v.elm("[form-id=form_"+a.id+"]").attr("unsaved","unsaved"),a,x.record).then(()=>{v.elms(".kb-table").each((A,y)=>{A.tr.each((z,B)=>{z.hasAttribute("row-id")&&z.removeAttr("row-id")})});kb.event.call("kb.view.copy.complete",{container:v.elm("[form-id=form_"+a.id+"]"),viewId:m})});(A=>{v.elm("[form-id=form_"+a.id+"]").dispatchEvent(A)})(new Event("change"))}).catch(()=>
{})}).catch(()=>{})})})})(kb.record.get(p.elm("[form-id=form_"+a.id+"]"),a,!0).record,b.insertRow(p))})});p.elms(".kb-field").each((r,e)=>{r.closest(".kb-scope").hasAttribute("form-id")&&kb.field.activate(r,a)});p.elms(".kb-table").each((r,e)=>{kb.table.activate(r,a).clearRows();r.addRow()})},(p,h)=>{},!1)})(kb.create("table").addClass("kb-view").attr("view-id","view_"+k.id+"_"+m),kb.extend({},k),kb.extend({},k).view)).on("show",b=>{b=c.key();g||kb.elm(".kb_spread_style_"+CSS.escape(b))||(localStorage.getItem(b)?
(kb.elm("head").append(kb.create("style").addClass("kb_spread_style_"+b).attr("media","screen").attr("type","text/css").text(localStorage.getItem(b))),c.set()):0!=kb.elm("[view-id=view_"+k.id+"_"+m+"]").elm("tbody").elms("tr").length&&c.set(!0))})}load(d){return new Promise((k,m)=>{kintone.api(kintone.api.url("/k/v1/app/views",!0),"GET",{app:d}).then(g=>{(c=>{k({origin:c,calendar:c.filter(b=>"CALENDAR"==b.type),custom:c.filter(b=>"CUSTOM"==b.type),list:c.filter(b=>"LIST"==b.type)})})(Object.values(g.views).sort((c,
b)=>c.index-b.index))}).catch(g=>kb.alert(kb.error.parse(g)))})}};window.kb.attachment||(window.kb.attachment=new KintoneBoosterAttachment);window.kb.record||(window.kb.record=new KintoneBoosterRecord);window.kb.button||(window.kb.button=new KintoneBoosterButton);window.kb.field||(window.kb.field=new KintoneBoosterField);window.kb.table||(window.kb.table=new KintoneBoosterTable);window.kb.view||(window.kb.view=new KintoneBoosterView);
kb.constants=kb.extend({common:{caption:{button:{cancel:{en:"Cancel",ja:"\u30ad\u30e3\u30f3\u30bb\u30eb",zh:"\u53d6\u6d88"},submit:{en:"Submit",ja:"\u4fdd\u5b58",zh:"\u4fdd\u5b58"}},sort:{asc:{en:"asc",ja:"\u6607\u9806",zh:"\u5347\u5e8f"},desc:{en:"desc",ja:"\u964d\u9806",zh:"\u964d\u5e8f"}}},message:{confirm:{changed:{en:"Changes have not been saved.<br>Do you want to leave the page?",ja:"\u5909\u66f4\u304c\u4fdd\u5b58\u3055\u308c\u3066\u3044\u307e\u305b\u3093\u3002<br>\u3053\u306e\u307e\u307e\u30da\u30fc\u30b8\u3092\u79fb\u52d5\u3057\u307e\u3059\u304b\uff1f",
zh:"\u66f4\u6539\u5c1a\u672a\u4fdd\u5b58\u3002<br>\u60a8\u662f\u5426\u8981\u79bb\u5f00\u6b64\u9875\u9762\uff1f"},cancel:{en:"The edits you made will be lost. Are you sure?",ja:"\u7de8\u96c6\u3057\u305f\u5185\u5bb9\u304c\u5931\u308f\u308c\u307e\u3059\u304c\u3001\u3088\u308d\u3057\u3044\u3067\u3059\u304b\uff1f",zh:"\u60a8\u7f16\u8f91\u7684\u5185\u5bb9\u5c06\u4f1a\u4e22\u5931\uff0c\u786e\u5b9a\u5417\uff1f"},copy:{en:"Are you sure on copy?",ja:"\u30b3\u30d4\u30fc\u3057\u3066\u3082\u3088\u308d\u3057\u3044\u3067\u3059\u304b\uff1f",
zh:"\u6211\u53ef\u4ee5\u590d\u5236\u5417\uff1f"},delete:{en:"Are you sure on delete?",ja:"\u524a\u9664\u3057\u3066\u3082\u3088\u308d\u3057\u3044\u3067\u3059\u304b\uff1f",zh:"\u6211\u53ef\u4ee5\u5220\u9664\u5417\uff1f"},save:{en:"Are you sure on copy?",ja:"\u4fdd\u5b58\u3057\u3066\u3082\u3088\u308d\u3057\u3044\u3067\u3059\u304b\uff1f",zh:"\u6211\u53ef\u4ee5\u4fdd\u5b58\u5417\uff1f"},submit:{en:"Are you sure on submit?",ja:"\u9001\u4fe1\u3057\u3066\u3082\u3088\u308d\u3057\u3044\u3067\u3059\u304b\uff1f",
zh:"\u6211\u53ef\u4ee5\u53d1\u9001\u5417\uff1f"}},invalid:{record:{en:"There is an error in the input data.",ja:"\u5165\u529b\u5185\u5bb9\u306b\u8aa4\u308a\u304c\u3042\u308a\u307e\u3059\u3002",zh:"\u8f93\u5165\u5185\u5bb9\u6709\u8bef\u3002"},submit:{en:"No data to submit was found.",ja:"\u7de8\u96c6\u4e2d\u306e\u30c7\u30fc\u30bf\u304c\u3042\u308a\u307e\u305b\u3093\u3002",zh:"\u6b63\u5728\u7f16\u8f91\u7684\u6570\u636e\u4e0d\u5b58\u5728\u3002"}}}},picker:{caption:{name:{en:"Name",ja:"\u8868\u793a\u540d",
zh:"\u663e\u793a\u540d\u79f0"},recordnumber:{en:"Record number",ja:"\u30ec\u30b3\u30fc\u30c9\u756a\u53f7",zh:"\u8bb0\u5f55\u53f7"}}}},kb.constants);