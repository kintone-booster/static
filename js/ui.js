/*
* FileName "ui.js"
* Version: 1.0.0
* Copyright (c) 2023 Pandafirm LLC
* Distributed under the terms of the GNU Lesser General Public License.
* https://opensource.org/licenses/LGPL-2.1
*/
'use strict';window.KintoneBoosterAttachment=class{constructor(){}show(f,k=!0){kb.file.download(f).then(m=>{try{var h=()=>{var e=kb.create("a").css({display:"none"}).attr("href",kb.field.objectUrl(m,f.contentType)).attr("target","_blank").attr("download",f.name);kb.elm("body").append(e);e.click();document.body.removeChild(e)};switch(f.contentType){case "application/javascript":fetch(new Request(kb.field.objectUrl(m,f.contentType))).then(e=>e.text()).then(e=>{var b=e.split("\n");kb.create("div").append((a=>
{b.each((d,l)=>a.append(kb.create("code").css({display:"block"}).text(d)));return a})(kb.create("pre"))).popup("full","full",k?[{src:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADwAAAA8CAYAAAFN++nkAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAA1FJREFUeNpiYKA66J8y8T8ynwmfJE6dQHYAjM9CtAlIihJIcjRAANHD71hdDxIA+RVdAbKf1wMFqeRXgACiqdcbQBiXPBMB/fVQTLxmoG3riRHDlXwWgIjCnHxGJOkPMHmYOCMx0QwDaIZRBgACaDgiYMDtxydPKJE4UKIZL8AVzwZA6jySkCEwji8QtBmoUQBIgbAhTCOIDxXHX4DgSl3Y5CjyMwspaRuvn6EJfwEOtQtIyhiEEsnAAYAAGkV0A4wUFDH/KSmPmYaEj4nJpcT6niQfQw01xCFtSEqQMxLwYT+QKsDmI6RyGV4eYwmRCUC5QpIsRjJEEaj5ARmJTwFI3ccV/CxEmHEfS2svEWjYArQG33yKi3ooCAQ1MXHIzQdaRqxFjtRI1aDgA5X+ClikQdHhSE60jAKaAoAAGkWjYBSgtF8pacOyUGC3AyUOH7Cmz8izmJGUxEREvB4AVouOtGhlvod2Y7GBD0BLBWnWoMdhOUmWEh3HoDYVrKkDteADNktBaogdcGMksZnTCLSkAcnnDEiWgsTriW0KMRKZkEDd8kQiQwcUMgmEEhwLgVKJ5LiDOjARKS04kFNkCkAb9h+gwXaBgG8NoNEjQK2yGmTQeWjD/gCozQ10xAekkaL1pJbduCz+gMfVIAve4x1LxjSLuOwEjdcNVCgZN+BKI4xEpFKi4w3JhwTTA6lFJqjL2o8rQQMtm0CPFgjesfhRMAoGDAAEaNdqbxCEgWhjGKAjMAKbyAg6ATM4gWECGQE2cBRGcAS5eI1VGvt110C8F/hDSNvX69217yqPQCAQbBnF69iuikbJevrh3ywshIUwrf82Md93E7QSjpXJR81NRelE4ixEi6alQOKsRMkI4+XCo/rU7wxAiBo9xFdEsU1X0XhY3sluk5VwhHo2q5c+dTHKm8Pi3fL2LotiP6DAAvHa09ddWQofNWHXvQ8YMMh6Y2iniStJ4wTARDWpuzWKtNTgkm6ZQ4FxnawUVhEOpv26kDFblp8jLFlblqypZ61itAgMFtTVqyVkP9C3J/UWwM3q0KoAYglDUeOW0Z/GaH4i5nEO/THneh7r0vNkgGhXYdt4YBWRKoiNmHeHPe60uh++any7595pCQQCgWDLeALGLWqyLWBxZQAAAABJRU5ErkJggg==",
handler:h}]:[]).show()});break;case "application/json":fetch(new Request(kb.field.objectUrl(m,f.contentType))).then(e=>e.text()).then(e=>{kb.create("div").html(e.replace(/\n/g,"<br>")).popup("full","full",k?[{src:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADwAAAA8CAYAAAFN++nkAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAA1FJREFUeNpiYKA66J8y8T8ynwmfJE6dQHYAjM9CtAlIihJIcjRAANHD71hdDxIA+RVdAbKf1wMFqeRXgACiqdcbQBiXPBMB/fVQTLxmoG3riRHDlXwWgIjCnHxGJOkPMHmYOCMx0QwDaIZRBgACaDgiYMDtxydPKJE4UKIZL8AVzwZA6jySkCEwji8QtBmoUQBIgbAhTCOIDxXHX4DgSl3Y5CjyMwspaRuvn6EJfwEOtQtIyhiEEsnAAYAAGkV0A4wUFDH/KSmPmYaEj4nJpcT6niQfQw01xCFtSEqQMxLwYT+QKsDmI6RyGV4eYwmRCUC5QpIsRjJEEaj5ARmJTwFI3ccV/CxEmHEfS2svEWjYArQG33yKi3ooCAQ1MXHIzQdaRqxFjtRI1aDgA5X+ClikQdHhSE60jAKaAoAAGkWjYBSgtF8pacOyUGC3AyUOH7Cmz8izmJGUxEREvB4AVouOtGhlvod2Y7GBD0BLBWnWoMdhOUmWEh3HoDYVrKkDteADNktBaogdcGMksZnTCLSkAcnnDEiWgsTriW0KMRKZkEDd8kQiQwcUMgmEEhwLgVKJ5LiDOjARKS04kFNkCkAb9h+gwXaBgG8NoNEjQK2yGmTQeWjD/gCozQ10xAekkaL1pJbduCz+gMfVIAve4x1LxjSLuOwEjdcNVCgZN+BKI4xEpFKi4w3JhwTTA6lFJqjL2o8rQQMtm0CPFgjesfhRMAoGDAAEaNdqbxCEgWhjGKAjMAKbyAg6ATM4gWECGQE2cBRGcAS5eI1VGvt110C8F/hDSNvX69217yqPQCAQbBnF69iuikbJevrh3ywshIUwrf82Md93E7QSjpXJR81NRelE4ixEi6alQOKsRMkI4+XCo/rU7wxAiBo9xFdEsU1X0XhY3sluk5VwhHo2q5c+dTHKm8Pi3fL2LotiP6DAAvHa09ddWQofNWHXvQ8YMMh6Y2iniStJ4wTARDWpuzWKtNTgkm6ZQ4FxnawUVhEOpv26kDFblp8jLFlblqypZ61itAgMFtTVqyVkP9C3J/UWwM3q0KoAYglDUeOW0Z/GaH4i5nEO/THneh7r0vNkgGhXYdt4YBWRKoiNmHeHPe60uh++any7595pCQQCgWDLeALGLWqyLWBxZQAAAABJRU5ErkJggg==",
handler:h}]:[]).show()});break;case "application/pdf":"other"!=kb.device()?window.open(kb.field.objectUrl(m,f.contentType)):kb.create("iframe").css({border:"none",height:"100%",outline:"none",width:"100%"}).attr("src",kb.field.objectUrl(m,f.contentType)+"#toolbar=0&navpanes=0").popup("full","full",k?[{src:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADwAAAA8CAYAAAFN++nkAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAA1FJREFUeNpiYKA66J8y8T8ynwmfJE6dQHYAjM9CtAlIihJIcjRAANHD71hdDxIA+RVdAbKf1wMFqeRXgACiqdcbQBiXPBMB/fVQTLxmoG3riRHDlXwWgIjCnHxGJOkPMHmYOCMx0QwDaIZRBgACaDgiYMDtxydPKJE4UKIZL8AVzwZA6jySkCEwji8QtBmoUQBIgbAhTCOIDxXHX4DgSl3Y5CjyMwspaRuvn6EJfwEOtQtIyhiEEsnAAYAAGkV0A4wUFDH/KSmPmYaEj4nJpcT6niQfQw01xCFtSEqQMxLwYT+QKsDmI6RyGV4eYwmRCUC5QpIsRjJEEaj5ARmJTwFI3ccV/CxEmHEfS2svEWjYArQG33yKi3ooCAQ1MXHIzQdaRqxFjtRI1aDgA5X+ClikQdHhSE60jAKaAoAAGkWjYBSgtF8pacOyUGC3AyUOH7Cmz8izmJGUxEREvB4AVouOtGhlvod2Y7GBD0BLBWnWoMdhOUmWEh3HoDYVrKkDteADNktBaogdcGMksZnTCLSkAcnnDEiWgsTriW0KMRKZkEDd8kQiQwcUMgmEEhwLgVKJ5LiDOjARKS04kFNkCkAb9h+gwXaBgG8NoNEjQK2yGmTQeWjD/gCozQ10xAekkaL1pJbduCz+gMfVIAve4x1LxjSLuOwEjdcNVCgZN+BKI4xEpFKi4w3JhwTTA6lFJqjL2o8rQQMtm0CPFgjesfhRMAoGDAAEaNdqbxCEgWhjGKAjMAKbyAg6ATM4gWECGQE2cBRGcAS5eI1VGvt110C8F/hDSNvX69217yqPQCAQbBnF69iuikbJevrh3ywshIUwrf82Md93E7QSjpXJR81NRelE4ixEi6alQOKsRMkI4+XCo/rU7wxAiBo9xFdEsU1X0XhY3sluk5VwhHo2q5c+dTHKm8Pi3fL2LotiP6DAAvHa09ddWQofNWHXvQ8YMMh6Y2iniStJ4wTARDWpuzWKtNTgkm6ZQ4FxnawUVhEOpv26kDFblp8jLFlblqypZ61itAgMFtTVqyVkP9C3J/UWwM3q0KoAYglDUeOW0Z/GaH4i5nEO/THneh7r0vNkgGhXYdt4YBWRKoiNmHeHPe60uh++any7595pCQQCgWDLeALGLWqyLWBxZQAAAABJRU5ErkJggg==",
handler:h}]:[]).show();break;case "audio/mpeg":case "audio/x-m4a":kb.create("audio").css({outline:"none"}).attr("controls","controls").attr("src",kb.field.objectUrl(m,f.contentType)).popup(null,null,k?[{src:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADwAAAA8CAYAAAFN++nkAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAA1FJREFUeNpiYKA66J8y8T8ynwmfJE6dQHYAjM9CtAlIihJIcjRAANHD71hdDxIA+RVdAbKf1wMFqeRXgACiqdcbQBiXPBMB/fVQTLxmoG3riRHDlXwWgIjCnHxGJOkPMHmYOCMx0QwDaIZRBgACaDgiYMDtxydPKJE4UKIZL8AVzwZA6jySkCEwji8QtBmoUQBIgbAhTCOIDxXHX4DgSl3Y5CjyMwspaRuvn6EJfwEOtQtIyhiEEsnAAYAAGkV0A4wUFDH/KSmPmYaEj4nJpcT6niQfQw01xCFtSEqQMxLwYT+QKsDmI6RyGV4eYwmRCUC5QpIsRjJEEaj5ARmJTwFI3ccV/CxEmHEfS2svEWjYArQG33yKi3ooCAQ1MXHIzQdaRqxFjtRI1aDgA5X+ClikQdHhSE60jAKaAoAAGkWjYBSgtF8pacOyUGC3AyUOH7Cmz8izmJGUxEREvB4AVouOtGhlvod2Y7GBD0BLBWnWoMdhOUmWEh3HoDYVrKkDteADNktBaogdcGMksZnTCLSkAcnnDEiWgsTriW0KMRKZkEDd8kQiQwcUMgmEEhwLgVKJ5LiDOjARKS04kFNkCkAb9h+gwXaBgG8NoNEjQK2yGmTQeWjD/gCozQ10xAekkaL1pJbduCz+gMfVIAve4x1LxjSLuOwEjdcNVCgZN+BKI4xEpFKi4w3JhwTTA6lFJqjL2o8rQQMtm0CPFgjesfhRMAoGDAAEaNdqbxCEgWhjGKAjMAKbyAg6ATM4gWECGQE2cBRGcAS5eI1VGvt110C8F/hDSNvX69217yqPQCAQbBnF69iuikbJevrh3ywshIUwrf82Md93E7QSjpXJR81NRelE4ixEi6alQOKsRMkI4+XCo/rU7wxAiBo9xFdEsU1X0XhY3sluk5VwhHo2q5c+dTHKm8Pi3fL2LotiP6DAAvHa09ddWQofNWHXvQ8YMMh6Y2iniStJ4wTARDWpuzWKtNTgkm6ZQ4FxnawUVhEOpv26kDFblp8jLFlblqypZ61itAgMFtTVqyVkP9C3J/UWwM3q0KoAYglDUeOW0Z/GaH4i5nEO/THneh7r0vNkgGhXYdt4YBWRKoiNmHeHPe60uh++any7595pCQQCgWDLeALGLWqyLWBxZQAAAABJRU5ErkJggg==",
handler:h}]:[]).show();break;case "image/bmp":case "image/gif":case "image/jpeg":case "image/png":kb.create("img").css({maxHeight:"calc(100vh - 4em)",maxWidth:"calc(100vw - 2em)"}).attr("src",kb.field.objectUrl(m,f.contentType)).popup(null,null,k?[{src:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADwAAAA8CAYAAAFN++nkAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAA1FJREFUeNpiYKA66J8y8T8ynwmfJE6dQHYAjM9CtAlIihJIcjRAANHD71hdDxIA+RVdAbKf1wMFqeRXgACiqdcbQBiXPBMB/fVQTLxmoG3riRHDlXwWgIjCnHxGJOkPMHmYOCMx0QwDaIZRBgACaDgiYMDtxydPKJE4UKIZL8AVzwZA6jySkCEwji8QtBmoUQBIgbAhTCOIDxXHX4DgSl3Y5CjyMwspaRuvn6EJfwEOtQtIyhiEEsnAAYAAGkV0A4wUFDH/KSmPmYaEj4nJpcT6niQfQw01xCFtSEqQMxLwYT+QKsDmI6RyGV4eYwmRCUC5QpIsRjJEEaj5ARmJTwFI3ccV/CxEmHEfS2svEWjYArQG33yKi3ooCAQ1MXHIzQdaRqxFjtRI1aDgA5X+ClikQdHhSE60jAKaAoAAGkWjYBSgtF8pacOyUGC3AyUOH7Cmz8izmJGUxEREvB4AVouOtGhlvod2Y7GBD0BLBWnWoMdhOUmWEh3HoDYVrKkDteADNktBaogdcGMksZnTCLSkAcnnDEiWgsTriW0KMRKZkEDd8kQiQwcUMgmEEhwLgVKJ5LiDOjARKS04kFNkCkAb9h+gwXaBgG8NoNEjQK2yGmTQeWjD/gCozQ10xAekkaL1pJbduCz+gMfVIAve4x1LxjSLuOwEjdcNVCgZN+BKI4xEpFKi4w3JhwTTA6lFJqjL2o8rQQMtm0CPFgjesfhRMAoGDAAEaNdqbxCEgWhjGKAjMAKbyAg6ATM4gWECGQE2cBRGcAS5eI1VGvt110C8F/hDSNvX69217yqPQCAQbBnF69iuikbJevrh3ywshIUwrf82Md93E7QSjpXJR81NRelE4ixEi6alQOKsRMkI4+XCo/rU7wxAiBo9xFdEsU1X0XhY3sluk5VwhHo2q5c+dTHKm8Pi3fL2LotiP6DAAvHa09ddWQofNWHXvQ8YMMh6Y2iniStJ4wTARDWpuzWKtNTgkm6ZQ4FxnawUVhEOpv26kDFblp8jLFlblqypZ61itAgMFtTVqyVkP9C3J/UWwM3q0KoAYglDUeOW0Z/GaH4i5nEO/THneh7r0vNkgGhXYdt4YBWRKoiNmHeHPe60uh++any7595pCQQCgWDLeALGLWqyLWBxZQAAAABJRU5ErkJggg==",
handler:h}]:[]).show();break;case "text/plain":case "text/css":fetch(new Request(kb.field.objectUrl(m,f.contentType))).then(e=>e.text()).then(e=>{kb.create("div").html(e.replace(/\n/g,"<br>")).popup("full","full",k?[{src:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADwAAAA8CAYAAAFN++nkAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAA1FJREFUeNpiYKA66J8y8T8ynwmfJE6dQHYAjM9CtAlIihJIcjRAANHD71hdDxIA+RVdAbKf1wMFqeRXgACiqdcbQBiXPBMB/fVQTLxmoG3riRHDlXwWgIjCnHxGJOkPMHmYOCMx0QwDaIZRBgACaDgiYMDtxydPKJE4UKIZL8AVzwZA6jySkCEwji8QtBmoUQBIgbAhTCOIDxXHX4DgSl3Y5CjyMwspaRuvn6EJfwEOtQtIyhiEEsnAAYAAGkV0A4wUFDH/KSmPmYaEj4nJpcT6niQfQw01xCFtSEqQMxLwYT+QKsDmI6RyGV4eYwmRCUC5QpIsRjJEEaj5ARmJTwFI3ccV/CxEmHEfS2svEWjYArQG33yKi3ooCAQ1MXHIzQdaRqxFjtRI1aDgA5X+ClikQdHhSE60jAKaAoAAGkWjYBSgtF8pacOyUGC3AyUOH7Cmz8izmJGUxEREvB4AVouOtGhlvod2Y7GBD0BLBWnWoMdhOUmWEh3HoDYVrKkDteADNktBaogdcGMksZnTCLSkAcnnDEiWgsTriW0KMRKZkEDd8kQiQwcUMgmEEhwLgVKJ5LiDOjARKS04kFNkCkAb9h+gwXaBgG8NoNEjQK2yGmTQeWjD/gCozQ10xAekkaL1pJbduCz+gMfVIAve4x1LxjSLuOwEjdcNVCgZN+BKI4xEpFKi4w3JhwTTA6lFJqjL2o8rQQMtm0CPFgjesfhRMAoGDAAEaNdqbxCEgWhjGKAjMAKbyAg6ATM4gWECGQE2cBRGcAS5eI1VGvt110C8F/hDSNvX69217yqPQCAQbBnF69iuikbJevrh3ywshIUwrf82Md93E7QSjpXJR81NRelE4ixEi6alQOKsRMkI4+XCo/rU7wxAiBo9xFdEsU1X0XhY3sluk5VwhHo2q5c+dTHKm8Pi3fL2LotiP6DAAvHa09ddWQofNWHXvQ8YMMh6Y2iniStJ4wTARDWpuzWKtNTgkm6ZQ4FxnawUVhEOpv26kDFblp8jLFlblqypZ61itAgMFtTVqyVkP9C3J/UWwM3q0KoAYglDUeOW0Z/GaH4i5nEO/THneh7r0vNkgGhXYdt4YBWRKoiNmHeHPe60uh++any7595pCQQCgWDLeALGLWqyLWBxZQAAAABJRU5ErkJggg==",
handler:h}]:[]).show()});break;case "text/csv":fetch(new Request(kb.field.objectUrl(m,f.contentType))).then(e=>e.text()).then(e=>{var b=e.parseCSV();0!=b.length&&(a=>{b.each((d,l)=>{a.append((p=>{d.each((r,n)=>p.append(kb.create("td").css({padding:"0.25em"}).html(r.replace(/\n/g,"<br>"))));return p})(kb.create("tr")))});return a})(kb.create("table")).popup(null,"full",k?[{src:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADwAAAA8CAYAAAFN++nkAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAA1FJREFUeNpiYKA66J8y8T8ynwmfJE6dQHYAjM9CtAlIihJIcjRAANHD71hdDxIA+RVdAbKf1wMFqeRXgACiqdcbQBiXPBMB/fVQTLxmoG3riRHDlXwWgIjCnHxGJOkPMHmYOCMx0QwDaIZRBgACaDgiYMDtxydPKJE4UKIZL8AVzwZA6jySkCEwji8QtBmoUQBIgbAhTCOIDxXHX4DgSl3Y5CjyMwspaRuvn6EJfwEOtQtIyhiEEsnAAYAAGkV0A4wUFDH/KSmPmYaEj4nJpcT6niQfQw01xCFtSEqQMxLwYT+QKsDmI6RyGV4eYwmRCUC5QpIsRjJEEaj5ARmJTwFI3ccV/CxEmHEfS2svEWjYArQG33yKi3ooCAQ1MXHIzQdaRqxFjtRI1aDgA5X+ClikQdHhSE60jAKaAoAAGkWjYBSgtF8pacOyUGC3AyUOH7Cmz8izmJGUxEREvB4AVouOtGhlvod2Y7GBD0BLBWnWoMdhOUmWEh3HoDYVrKkDteADNktBaogdcGMksZnTCLSkAcnnDEiWgsTriW0KMRKZkEDd8kQiQwcUMgmEEhwLgVKJ5LiDOjARKS04kFNkCkAb9h+gwXaBgG8NoNEjQK2yGmTQeWjD/gCozQ10xAekkaL1pJbduCz+gMfVIAve4x1LxjSLuOwEjdcNVCgZN+BKI4xEpFKi4w3JhwTTA6lFJqjL2o8rQQMtm0CPFgjesfhRMAoGDAAEaNdqbxCEgWhjGKAjMAKbyAg6ATM4gWECGQE2cBRGcAS5eI1VGvt110C8F/hDSNvX69217yqPQCAQbBnF69iuikbJevrh3ywshIUwrf82Md93E7QSjpXJR81NRelE4ixEi6alQOKsRMkI4+XCo/rU7wxAiBo9xFdEsU1X0XhY3sluk5VwhHo2q5c+dTHKm8Pi3fL2LotiP6DAAvHa09ddWQofNWHXvQ8YMMh6Y2iniStJ4wTARDWpuzWKtNTgkm6ZQ4FxnawUVhEOpv26kDFblp8jLFlblqypZ61itAgMFtTVqyVkP9C3J/UWwM3q0KoAYglDUeOW0Z/GaH4i5nEO/THneh7r0vNkgGhXYdt4YBWRKoiNmHeHPe60uh++any7595pCQQCgWDLeALGLWqyLWBxZQAAAABJRU5ErkJggg==",
handler:h}]:[]).show()});break;case "video/mp4":case "video/mpeg":kb.create("video").css({maxHeight:"calc(100vh - 4em)",maxWidth:"calc(100vw - 2em)",outline:"none"}).attr("controls","controls").attr("src",kb.field.objectUrl(m,f.contentType)).popup(null,null,k?[{src:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADwAAAA8CAYAAAFN++nkAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAA1FJREFUeNpiYKA66J8y8T8ynwmfJE6dQHYAjM9CtAlIihJIcjRAANHD71hdDxIA+RVdAbKf1wMFqeRXgACiqdcbQBiXPBMB/fVQTLxmoG3riRHDlXwWgIjCnHxGJOkPMHmYOCMx0QwDaIZRBgACaDgiYMDtxydPKJE4UKIZL8AVzwZA6jySkCEwji8QtBmoUQBIgbAhTCOIDxXHX4DgSl3Y5CjyMwspaRuvn6EJfwEOtQtIyhiEEsnAAYAAGkV0A4wUFDH/KSmPmYaEj4nJpcT6niQfQw01xCFtSEqQMxLwYT+QKsDmI6RyGV4eYwmRCUC5QpIsRjJEEaj5ARmJTwFI3ccV/CxEmHEfS2svEWjYArQG33yKi3ooCAQ1MXHIzQdaRqxFjtRI1aDgA5X+ClikQdHhSE60jAKaAoAAGkWjYBSgtF8pacOyUGC3AyUOH7Cmz8izmJGUxEREvB4AVouOtGhlvod2Y7GBD0BLBWnWoMdhOUmWEh3HoDYVrKkDteADNktBaogdcGMksZnTCLSkAcnnDEiWgsTriW0KMRKZkEDd8kQiQwcUMgmEEhwLgVKJ5LiDOjARKS04kFNkCkAb9h+gwXaBgG8NoNEjQK2yGmTQeWjD/gCozQ10xAekkaL1pJbduCz+gMfVIAve4x1LxjSLuOwEjdcNVCgZN+BKI4xEpFKi4w3JhwTTA6lFJqjL2o8rQQMtm0CPFgjesfhRMAoGDAAEaNdqbxCEgWhjGKAjMAKbyAg6ATM4gWECGQE2cBRGcAS5eI1VGvt110C8F/hDSNvX69217yqPQCAQbBnF69iuikbJevrh3ywshIUwrf82Md93E7QSjpXJR81NRelE4ixEi6alQOKsRMkI4+XCo/rU7wxAiBo9xFdEsU1X0XhY3sluk5VwhHo2q5c+dTHKm8Pi3fL2LotiP6DAAvHa09ddWQofNWHXvQ8YMMh6Y2iniStJ4wTARDWpuzWKtNTgkm6ZQ4FxnawUVhEOpv26kDFblp8jLFlblqypZ61itAgMFtTVqyVkP9C3J/UWwM3q0KoAYglDUeOW0Z/GaH4i5nEO/THneh7r0vNkgGhXYdt4YBWRKoiNmHeHPe60uh++any7595pCQQCgWDLeALGLWqyLWBxZQAAAABJRU5ErkJggg==",
handler:h}]:[]).show();break;default:h()}}catch(e){kb.alert(kb.error.parse(e))}}).catch(m=>kb.alert(kb.error.parse(m)))}};
window.KintoneBoosterButton=class{constructor(){}create(f,k,m,h,e,b){(a=>{a&&a.parentNode.removeChild(a)})(kb.elm("#"+m));switch(k){case "detail":(f?kintone.mobile.app.getHeaderSpaceElement():kintone.app.record.getHeaderMenuSpaceElement().css({padding:"0 0.75em 0 1em"})).append(kb.create("button").addClass("kb-action-button kb-page-detail "+(f?" kb-mobile":"")).attr("id",m).html(h).on("click",a=>{kb.confirm(e,()=>b())}));break;case "index":(f?kintone.mobile.app.getHeaderSpaceElement():kintone.app.getHeaderMenuSpaceElement()).append(kb.create("button").addClass("kb-action-button kb-page-index "+
(f?" kb-mobile":"")).attr("id",m).html(h).on("click",a=>{kb.confirm(e,()=>b())}))}}};
window.KintoneBoosterField=class{constructor(){this.cache={};this.reserved="CATEGORY CREATED_TIME CREATOR GROUP HR LABEL MODIFIER RECORD_NUMBER REFERENCE_TABLE SPACER STATUS STATUS_ASSIGNEE UPDATED_TIME __ID__ __REVISION__".split(" ")}activate(f,k,m=!0){var h=kb.field.parallelize(k.fields),e=()=>kb.create("div").css({zIndex:kb.popups.alert.cover.style.zIndex-4}).append(kb.create("img").attr("src","data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAB4AAAAeCAYAAAA7MK6iAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAyJpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuMy1jMDExIDY2LjE0NTY2MSwgMjAxMi8wMi8wNi0xNDo1NjoyNyAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvIiB4bWxuczp4bXBNTT0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL21tLyIgeG1sbnM6c3RSZWY9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZVJlZiMiIHhtcDpDcmVhdG9yVG9vbD0iQWRvYmUgUGhvdG9zaG9wIENTNiAoV2luZG93cykiIHhtcE1NOkluc3RhbmNlSUQ9InhtcC5paWQ6QkVGNzA3QTE1RTc4MTFFOEI5MDA5RUE2NDFCQTUzNDciIHhtcE1NOkRvY3VtZW50SUQ9InhtcC5kaWQ6QkVGNzA3QTI1RTc4MTFFOEI5MDA5RUE2NDFCQTUzNDciPiA8eG1wTU06RGVyaXZlZEZyb20gc3RSZWY6aW5zdGFuY2VJRD0ieG1wLmlpZDpCRUY3MDc5RjVFNzgxMUU4QjkwMDlFQTY0MUJBNTM0NyIgc3RSZWY6ZG9jdW1lbnRJRD0ieG1wLmRpZDpCRUY3MDdBMDVFNzgxMUU4QjkwMDlFQTY0MUJBNTM0NyIvPiA8L3JkZjpEZXNjcmlwdGlvbj4gPC9yZGY6UkRGPiA8L3g6eG1wbWV0YT4gPD94cGFja2V0IGVuZD0iciI/PkBlNTAAAADNSURBVHja7NHBCcJAFATQZNBcYwmSmycPlpI2bCVgAVqAVmAFHmxqncAKQVyz+/N/grADc0iyy0Be6ZwrlgiKhZKH83Ae/v/h1X23l9499vfZk2hYOHpgO7ZkH+xzjl9dsze2Ytfsld3MMXxhm8Hzlj1bD/eu7Zf3rf9mMvx2DaXzZ1SHh66hVP5MrTn86RpK48+qDIdcQ4nyxkRXsTcmuoq9oeAq8oaSa7I3FF2TvKHomuQNZddobxi4RnnDyHXUG0auo94wdP3p/RJgAMw4In5GE/6/AAAAAElFTkSuQmCC")).append(kb.create("span")),b=
a=>{((d,l)=>{f.elm(".kb-field-alert")?f.elm(".kb-field-alert").hide():f.elms("input,select,textarea").each((p,r)=>{p.alert&&p.alert.hide()});kb.event.call(a,{container:l,record:kb.record.get(d,k,!0).record}).then(p=>{p.error||(m?kb.event.call("kb.action.call",{container:d,record:p.record,mobile:location.href.match(/\/m\//g)?!0:!1,pattern:"change",field:(r=>{var n=r.code;r.lookup&&(n=r.lookup.fieldMappings.reduce((g,u)=>{g.index<kb.field.cache[k.id].layout.indexOf(u.field)&&(g={index:kb.field.cache[k.id].layout.indexOf(u.field),
field:u.field});return g},{index:-1,field:null}),n=n.field||r.code);return n})(h[f.attr("field-id")]),workplace:d.closest(".kb-view")?"view":"record"}).then(r=>{kb.event.call("kb.style.call",{container:d,record:r.record,mobile:r.mobile,pattern:"$id"in r.record?r.record.$id.value?"edit":"create":"create",workplace:r.workplace}).then(n=>{kb.record.set(d,k,n.record);n=new Event("change");d.attr("unsaved","unsaved").dispatchEvent(n)}).catch(()=>{})}):(kb.record.set(d,k,p.record),(r=>{d.attr("unsaved",
"unsaved").dispatchEvent(r)})(new Event("change"))))})})(f.closest("[form-id=form_"+k.id+"]"),f.closest(".kb-scope"))};f.attr("field-id")&&((a,d)=>{if(d.lookup)(l=>{a.elm(".kb-search").on("click",p=>{l(a.elm(".kb-lookup-search").val(),kb.extend({},d))});a.elm(".kb-open").on("click",p=>{((r,n)=>{a.elm(".kb-lookup-search").val()?kb.view.records.get(n,kb.filter.query.create({code:d.lookup.relatedKeyField},"=",{type:d.type,value:a.elm(".kb-lookup-search").val()})).then(g=>{0!=g.length&&window.open(kb.record.page.detail(r,
n,g.first().$id.value))}).catch(g=>kb.alert(kb.error.parse(g))):window.open(kb.record.page.add(r,n))})(location.href.match(/\/m\//g)?!0:!1,d.lookup.relatedApp.app)});a.elm(".kb-clear").on("click",p=>{kb.confirm(kb.constants.common.message.confirm.delete[kb.operator.language],()=>{a.lookup("").then(()=>b("kb.change."+d.code))})});a.elm("input").on("change",p=>{l(p.currentTarget.val(),kb.extend({},d))})})((l,p)=>{this.load(p.lookup.relatedApp.app).then(r=>{(n=>{var g=()=>{p.picker=(u=>{var c={};u.each((t,
q)=>{t in n.external&&(c[t]=kb.extend({},n.external[t]))});0==Object.keys(c).length&&(c.$id={code:"$id",type:"RECORD_NUMBER",label:kb.constants.picker.caption.recordnumber[kb.operator.language],required:!1,noLabel:!1});return c})(p.lookup.lookupPickerFields);a.recordPicker.show({app:p.lookup.relatedApp.app,query:p.query,sort:p.lookup.sort||"$id asc",picker:p.picker},u=>a.lookup(u.$id.value).then(()=>b("kb.change."+p.code)))};l?(p.query=[p.lookup.filterCond,p.lookup.relatedKeyField+("NUMBER"==p.type?
"=":" like ")+'"'+l+'"'].filter(u=>u).join(" and "),kintone.api(kintone.api.url("/k/v1/records",!0),"GET",{app:p.lookup.relatedApp.app,query:p.query}).then(u=>{1==u.records.length?a.lookup(u.records.first().$id.value).then(()=>b("kb.change."+p.code)):g()}).catch(u=>kb.alert(kb.error.parse(u)))):(p.query=p.lookup.filterCond,g())})({external:r.parallelize,internal:h})})}),a.recordPicker=new KintoneBoosterRecordPicker("record"),a.lookup=(l,p)=>new Promise((r,n)=>{(g=>{var u=()=>{kb.record.set(g,d.tableCode?
k.fields[d.tableCode]:k,(()=>d.lookup.fieldMappings.reduce((c,t)=>{if(t.field in h)switch(h[t.field].type){case "CHECK_BOX":case "FILE":case "GROUP_SELECT":case "MULTI_SELECT":case "ORGANIZATION_SELECT":case "USER_SELECT":c[t.field]={value:[]};break;default:c[t.field]={value:""}}return c},(c=>{c[d.code]={value:""};return c})({})))(),!1).then(()=>r())};l?kintone.api(kintone.api.url("/k/v1/record",!0),"GET",{app:d.lookup.relatedApp.app,id:l}).then(c=>{c.record?kb.record.set(g,d.tableCode?k.fields[d.tableCode]:
k,(()=>d.lookup.fieldMappings.reduce((t,q)=>{q.relatedField in c.record&&q.field in h&&(t[q.field]={value:c.record[q.relatedField].value});return t},(t=>{t[d.code]={value:c.record[d.lookup.relatedKeyField].value};return t})({})))(),!1).then(()=>r()):u()}).catch(c=>kb.alert(kb.error.parse(c))):p?kintone.api(kintone.api.url("/k/v1/records",!0),"GET",{app:d.lookup.relatedApp.app,query:d.lookup.relatedKeyField+'="'+p+'"'}).then(c=>{1==c.records.length?(t=>{kb.record.set(g,d.tableCode?k.fields[d.tableCode]:
k,(()=>d.lookup.fieldMappings.reduce((q,v)=>{v.relatedField in t&&v.field in h&&(q[v.field]={value:t[v.relatedField].value});return q},(q=>{q[d.code]={value:t[d.lookup.relatedKeyField].value};return q})({})))(),!1).then(()=>r())})(c.records.first()):u()}).catch(c=>kb.alert(kb.error.parse(c))):u()})(a.closest(".kb-scope"))});else switch(d.type){case "CHECK_BOX":case "MULTI_SELECT":d.required&&(a.alert=l=>{a.elm(".kb-field-alert")||a.append(e().addClass("kb-field-alert"));a.elm(".kb-field-alert").elm("span").html(l).parentNode.show()});
break;case "COLOR":a.elm(".kb-search").on("click",l=>{kb.pickupColor(p=>{a.css({backgroundColor:p}).elm("input").val(p);b("kb.change."+d.code)})});a.elm("input").on("change",l=>{l.currentTarget.val()?(l=l.currentTarget.val().replace(/#/g,""),l.match(/([0-9A-Fa-f]{3}|[0-9A-Fa-f]{6})$/g)&&(a.css({backgroundColor:"#"+l}).elm("input").val("#"+l),b("kb.change."+d.code))):(a.css({backgroundColor:"transparent"}),b("kb.change."+d.code))});break;case "CONDITION":a.elm(".kb-search").on("click",l=>{kb.filter.build(d.app,
a.elm("input").val(),p=>{a.elm("input").val(p);b("kb.change."+d.code)})});a.reset=l=>{d.app=l;a.elm("input").val("");a.elm(".kb-guide").empty()};a.guide=l=>{a.elm(".kb-guide").append((p=>{p.append(kb.create("button").addClass("kb-icon kb-icon-del kb-guide-item-icon").on("click",r=>{kb.confirm(kb.constants.common.message.confirm.delete[kb.operator.language],()=>{a.elm("input").val(a.elm("input").val().split(" and ").filter(n=>n!=l).join(" and "));b("kb.change."+d.code)})})).append(kb.create("span").addClass("kb-guide-item-label").html(l));
return p})(kb.create("span").addClass("kb-guide-item")))};d.required&&(a.alert=l=>{a.elm(".kb-field-alert")||a.append(e().addClass("kb-field-alert"));a.elm(".kb-field-alert").elm("span").html(l).parentNode.show()});break;case "DATE":a.elm(".kb-search").on("click",l=>{kb.pickupDate(a.elm("input").val(),p=>{a.elm("input").val(p);b("kb.change."+d.code)})});break;case "DATETIME":a.elm(".kb-search").on("click",l=>{kb.pickupDate(a.elm("input").val(),p=>{a.elm("input").val(p);b("kb.change."+d.code)})});
break;case "FILE":a.elm(".kb-search").on("click",l=>{(p=>{kb.elm("body").append(p.on("change",r=>{r.currentTarget.files?(n=>{kb.file.upload(Array.from(r.currentTarget.files).first()).then(g=>{a.elm("input").val(JSON.stringify((a.elm("input").val()?JSON.parse(a.elm("input").val()):[]).concat(g)));b("kb.change."+d.code)}).catch(g=>kb.alert(kb.error.parse(g))).finally(()=>document.body.removeChild(p))})(Array.from(r.currentTarget.files).first()):document.body.removeChild(p)}));p.click()})(kb.create("input").attr("type",
"file").css({display:"none"}))});a.guide=l=>{a.elm(".kb-guide").append((p=>{p.append(kb.create("button").addClass("kb-icon kb-icon-del kb-guide-item-icon").on("click",r=>{kb.confirm(kb.constants.common.message.confirm.delete[kb.operator.language],()=>{a.elm("input").val(JSON.stringify(JSON.parse(a.elm("input").val()).filter(n=>n.fileKey!=l.fileKey)));b("kb.change."+d.code)})})).append(kb.create("span").addClass("kb-guide-item-label").html(l.name).on("click",r=>a.open(l)));return p})(kb.create("span").addClass("kb-guide-item")))};
a.open=l=>{kb.event.call("kb.attachment.call",{mode:"download",downloadable:!0}).then(p=>kb.attachment.show(l,p.downloadable)).catch(()=>{})};d.required&&(a.alert=l=>{a.elm(".kb-field-alert")||a.append(e().addClass("kb-field-alert"));a.elm(".kb-field-alert").elm("span").html(l).parentNode.show()});break;case "GROUP_SELECT":case "ORGANIZATION_SELECT":case "USER_SELECT":(l=>{a.elm(".kb-search").on("click",p=>{a.recordPicker.show({picker:{name:{code:"name",type:"SINGLE_LINE_TEXT",label:kb.constants.picker.caption.name[kb.operator.language],
required:!1,noLabel:!0}}},r=>{(n=>{(g=>{r.each((u,c)=>{g.includes(u.code.value)||n.push({code:u.code.value,name:u.name.value})})})(n.map(g=>g.code));a.elm("input").val(JSON.stringify(n));b("kb.change."+d.code)})(a.elm("input").val()?JSON.parse(a.elm("input").val()):[])})});a.recordPicker=new KintoneBoosterRecordPicker(l,!0,(()=>{var p=[];d.loginuser&&p.push({code:{value:"LOGINUSER()"},name:{value:"Login user"}});d.guestuser&&p.push({code:{value:"GUESTUSER()"},name:{value:"Guest user"}});return p})());
a.guide=p=>{a.elm(".kb-guide").append((r=>{r.append(kb.create("button").addClass("kb-icon kb-icon-del kb-guide-item-icon").on("click",n=>{kb.confirm(kb.constants.common.message.confirm.delete[kb.operator.language],()=>{a.elm("input").val(JSON.stringify(JSON.parse(a.elm("input").val()).filter(g=>g.code!=p.code)));b("kb.change."+d.code)})})).append(kb.create("span").addClass("kb-guide-item-label").html(p.name));return r})(kb.create("span").addClass("kb-guide-item")))};d.required&&(a.alert=p=>{a.elm(".kb-field-alert")||
a.append(e().addClass("kb-field-alert"));a.elm(".kb-field-alert").elm("span").html(p).parentNode.show()})})((()=>{var l="";switch(d.type){case "GROUP_SELECT":l="group";break;case "ORGANIZATION_SELECT":l="organization";break;case "USER_SELECT":l="user"}return l})());case "NUMBER":(l=>{a.on("show",p=>l());l()})(()=>{a.elm(".kb-unit")?a.elm("input").css({width:"calc(100% - "+a.elm(".kb-unit").outerWidth(!0)+"px)"}):a.elm("input").css({width:null})});break;case "RADIO_BUTTON":a.elms("[data-name="+d.code+
"]").each((l,p)=>{l.closest("label").on("click",r=>{(n=>{a.elms("[data-name="+d.code+"]").each((g,u)=>g.checked=n==g.val());b("kb.change."+d.code)})(l.val());r.stopPropagation();r.preventDefault()})});break;case "TIME":a.elm(".kb-hour").elm("select").on("change",l=>{l.currentTarget.val()||a.elm(".kb-minute").elm("select").val("");b("kb.change."+d.id)}),a.elm(".kb-minute").elm("select").on("change",l=>{l.currentTarget.val()||a.elm(".kb-hour").elm("select").val("");b("kb.change."+d.id)})}a.elms("input,select,textarea").each((l,
p)=>{switch(d.type){case "COLOR":case "CONDITION":case "FILE":case "GROUP_SELECT":case "ORGANIZATION_SELECT":case "RADIO_BUTTON":case "TIME":case "USER_SELECT":break;default:l.on("change",r=>b("kb.change."+d.code))}})})(f.elm(".kb-field-value"),h[f.attr("field-id")]);return f}blobToBase64(f,k){var m=new FileReader;m.onload=()=>{k(m.result.replace(/^data:.+;base64,/,""))};m.readAsDataURL(f)}create(f,k=!1){var m=h=>{h.append(kb.create("div").addClass("kb-dropdown kb-hour").append(kb.create("select").assignOption((()=>
{var e=[{value:""}];(24).each(b=>e.push({value:b.toString().lpad("0",2)}));return e})(),"value","value"))).append(kb.create("div").addClass("kb-dropdown kb-minute").append(kb.create("select").assignOption((()=>{var e=[{value:""}];(60).each(b=>e.push({value:b.toString().lpad("0",2)}));return e})(),"value","value")))};if(!("type"in f))throw Error("You shoud setup [type] in field information");return(h=>{h.append(kb.create("span").addClass("kb-field-caption").html(f.label));f.noLabel&&h.elm(".kb-field-caption").addClass("kb-hidden");
h.append((e=>{switch(f.type){case "CALC":switch(f.format){case "NUMBER":case "NUMBER_DIGIT":e.addClass("kb-number")}break;case "CHECK_BOX":case "MULTI_SELECT":(b=>{b.reduce((a,d)=>{a[d.index]=d;return a},Array(b.length).fill("")).each((a,d)=>{e.addClass("kb-checkbox").append(kb.create("label").append(kb.create("input").attr("type","checkbox").val(a.label)).append(kb.create("span").html(a.label)))})})(Object.values(f.options));break;case "COLOR":e.addClass("kb-color").append(kb.create("input").attr("type",
"text").attr("data-type","color")).append(kb.create("button").addClass("kb-icon kb-icon-color kb-search"));break;case "CONDITION":e.addClass("kb-condition").append(kb.create("input").attr("type","hidden")).append(kb.create("button").addClass("kb-icon kb-icon-filter kb-search"));break;case "CREATOR":case "CREATED_TIME":case "MODIFIER":case "UPDATED_TIME":e.append(kb.create("input").attr("type","hidden").attr("data-type",f.type.toLowerCase()));break;case "DATE":e.addClass("kb-date").append(kb.create("input").attr("type",
"text").attr("data-type","date")).append(kb.create("button").addClass("kb-icon kb-icon-date kb-search"));break;case "DATETIME":m(e.addClass("kb-datetime").append(kb.create("input").attr("type","text").attr("data-type","date")).append(kb.create("button").addClass("kb-icon kb-icon-date kb-search")));break;case "DROP_DOWN":(b=>{k?e.addClass("kb-dropdown").append(kb.create("select").assignOption([{label:""}].concat(b.reduce((a,d)=>{d.label&&(a[d.index]=d);return a},Array(b.length).fill(""))),"label",
"label")):e.addClass("kb-dropdown").append(kb.create("select").assignOption(b.reduce((a,d)=>{a[d.index]=d;return a},Array(b.length).fill("")),"label","label"))})(Object.values(f.options));break;case "FILE":e.addClass("kb-file").append(kb.create("input").attr("type","hidden")).append(kb.create("button").addClass("kb-icon kb-icon-file kb-search"));break;case "GROUP_SELECT":e.addClass("kb-group").append(kb.create("input").attr("type","hidden")).append(kb.create("button").addClass("kb-icon kb-icon-group kb-search"));
break;case "LINK":switch(f.protocol){case "WEB":e.addClass("kb-text").append(kb.create("input").attr("type","text").attr("data-type","url"));break;case "CALL":e.addClass("kb-text").append(kb.create("input").attr("type","text").attr("data-type","tel"));break;case "MAIL":e.addClass("kb-text").append(kb.create("input").attr("type","text").attr("data-type","mail"))}break;case "MULTI_LINE_TEXT":case "RICH_TEXT":e.addClass("kb-textarea").append((b=>{f.lines&&b.css({height:"calc("+(1.5*parseFloat(f.lines)).toString()+
"em + 2px)"});return b})(kb.create("textarea")));break;case "NUMBER":f.lookup?e.addClass("kb-lookup").append(kb.create("input").addClass("kb-lookup-search").attr("type","text").attr("data-type","nondemiliternumber")).append(kb.create("button").addClass("kb-icon kb-icon-lookup kb-search")).append(kb.create("button").addClass("kb-icon kb-icon-open kb-open")).append(kb.create("button").addClass("kb-icon kb-icon-del kb-clear")):(e.addClass("kb-number").append((b=>{"displayScale"in f&&b.attr("data-decimals",
f.displayScale);return b.attr("data-type",f.digit?"number":"nondemiliternumber")})(kb.create("input").attr("type","text"))),f.unit&&(b=>{"prefix"==f.unitPosition?e.insertBefore(b,e.elm("input")):e.insertBefore(b,e.elm("input").nextElementSibling)})(kb.create("span").addClass("kb-unit").html(f.unit)));break;case "ORGANIZATION_SELECT":e.addClass("kb-organization").append(kb.create("input").attr("type","hidden")).append(kb.create("button").addClass("kb-icon kb-icon-organization kb-search"));break;case "RADIO_BUTTON":(b=>
{b.reduce((a,d)=>{a[d.index]=d;return a},Array(b.length).fill("")).each((a,d)=>{var l=e.addClass("kb-radio"),p=l.append;a=kb.create("label").append(kb.create("input").attr("type","radio").attr("data-name",f.code).val(a.label)).append(kb.create("span").html(a.label));0==d&&(a.elm("input").checked=!0);p.call(l,a)})})(Object.values(f.options));break;case "RECORD_NUMBER":e.addClass("kb-id");break;case "SINGLE_LINE_TEXT":if(f.lookup)e.addClass("kb-lookup").append(kb.create("input").addClass("kb-lookup-search").attr("type",
"text").attr("data-type","text")).append(kb.create("button").addClass("kb-icon kb-icon-lookup kb-search")).append(kb.create("button").addClass("kb-icon kb-icon-open kb-open")).append(kb.create("button").addClass("kb-icon kb-icon-del kb-clear"));else switch(f.format){case "password":e.addClass("kb-text").append(kb.create("input").attr("type","password").attr("data-type",f.type));break;default:e.addClass("kb-text").append(kb.create("input").attr("type","text").attr("data-type",f.format?f.format:"text"))}break;
case "SPACER":e.html(f.contents);break;case "STATUS_ASSIGNEE":e.append(kb.create("input").attr("type","hidden"));break;case "TIME":m(e);break;case "USER_SELECT":e.addClass("kb-user").append(kb.create("input").attr("type","hidden")).append(kb.create("button").addClass("kb-icon kb-icon-user kb-search"))}return"SPACER"!=f.type?e.append(kb.create("span").addClass("kb-guide")):e})(kb.create("div").addClass("kb-field-value")));switch(f.type){case "CALC":case "CATEGORY":case "CONDITION":case "CREATED_TIME":case "CREATOR":case "FILE":case "GROUP_SELECT":case "MODIFIER":case "ORGANIZATION_SELECT":case "RECORD_NUMBER":case "REFERENCE_TABLE":case "STATUS":case "STATUS_ASSIGNEE":case "UPDATED_TIME":case "USER_SELECT":h.elm(".kb-guide").addClass("kb-fixed")}if(f.required)switch(f.type){case "CALC":case "CATEGORY":case "CHECK_BOX":case "CONDITION":case "CREATED_TIME":case "CREATOR":case "FILE":case "GROUP_SELECT":case "MODIFIER":case "MULTI_SELECT":case "ORGANIZATION_SELECT":case "RECORD_NUMBER":case "REFERENCE_TABLE":case "STATUS":case "STATUS_ASSIGNEE":case "UPDATED_TIME":case "USER_SELECT":break;
default:h.elms("input,select,textarea").each((e,b)=>e.attr("required","required"))}f.placeholder&&h.elms("input,select,textarea").each((e,b)=>e.attr("placeholder",f.placeholder));return h})(kb.create("div").addClass("kb-field").attr("field-id",f.code))}get(f,k,m){var h=null;if(f.tableCode)h=kb.elms(".field-"+f.id).map(e=>{switch(m){case "create":case "edit":e.value=k?e.elm("input[type=text],textarea,ul")?e.elm("input[type=text],textarea,ul"):e.elm("[class^=forms-]"):e.elm(".input-checkbox-cybozu,.input-date-cybozu,.input-datetime-cybozu,.input-file-cybozu,.input-radio-cybozu,.input-text-outer-cybozu,.input-time-cybozu,.multipleselect-cybozu,.select-cybozu");
break;case "detail":case "print":e.value=k?e.elm(".value-"+f.id):e}return e});else switch(h=kb.elm(".field-"+f.id),m){case "create":case "edit":h.value=k?h.elm("input[type=text],textarea,ul")?h.elm("input[type=text],textarea,ul"):h.elm("[class^=forms-]"):h.elm(".input-checkbox-cybozu,.input-date-cybozu,.input-datetime-cybozu,.input-file-cybozu,.input-radio-cybozu,.input-text-outer-cybozu,.input-time-cybozu,.multipleselect-cybozu,.select-cybozu");break;case "detail":case "print":h.value=h.elm(".value-"+
f.id)}return h}isEmpty(f){var k=!0;if(Array.isArray(f))k=0==f.length;else switch(typeof f){case "object":k=null===f||0==Object.keys(f).length;break;case "number":k=Number.isNaN(f);break;case "string":k=0==f.toString().length}return k}load(f,k){return new Promise((m,h)=>{f in this.cache?m(this.cache[f]):kintone.api(kintone.api.url("/k/v1/app/form/layout",!0),"GET",{app:f}).then(e=>{(b=>{var a=[],d=[],l=[],p=(r,n=!0)=>r.reduce((g,u)=>{switch(u.type){case "GROUP":n&&a.push({code:u.code,fields:u.layout.flatMap(c=>
c.fields)});g=g.concat(p(u.layout));break;case "ROW":n&&(d=u.fields.reduce((c,t)=>{t.elementId&&c.push(t);return c},d));g=u.fields.reduce((c,t)=>{"code"in t&&c.push(t.code);return c},g);break;case "SUBTABLE":n?(l.push({code:u.code,fields:u.fields}),g=u.fields.reduce((c,t)=>{"code"in t&&c.push(t.code);return c},g)):g.push(u.code)}return g},[]);kintone.api(kintone.api.url("/k/v1/app/form/fields",!0),"GET",{app:f,lang:"user"}).then(r=>{(n=>{n.each((g,u)=>{delete r.properties[g]})})(Object.values(r.properties).reduce((n,
g)=>{switch(g.type){case "CATEGORY":g.enabled||n.push(g.code);break;case "STATUS":g.enabled||(n.push(g.code),n.push(Object.values(r.properties).filter(u=>"STATUS_ASSIGNEE"==u.type).first().code))}return n},[]));((n,g,u)=>{this.cache[f]={origin:((c,t)=>{c=c.reduce((v,w)=>{v[w]=t[w];"SUBTABLE"==t[w].type&&(v[w].fields=(x=>x.fields.reduce((z,y)=>{z[y.code]=t[x.code].fields[y.code];return z},{}))(l.filter(x=>x.code==w).first()));delete t[w];return v},{});for(var q in t)c[q]=t[q];return c})(p(b,!1),kb.extend({},
r.properties)),groups:a.reduce((c,t)=>{c[t.code]=r.properties[t.code];c[t.code].fields=t.fields;return c},{}),tables:l.reduce((c,t)=>{c[t.code]=(q=>{q.fields=t.fields.reduce((v,w)=>{v[w.code]=n[w.code];return v},{});return q})(r.properties[t.code]);t.code in u.table&&(c[t.code].id=u.table[t.code]);return c},{}),changes:(c=>{var t=[];t=Object.values(n).reduce((q,v)=>{c.includes(v.code)||q.push(v.code);return q},[]);return t.concat(l.map(q=>q.code))})((()=>{var c=[],t;for(t in n)(q=>{kb.field.reserved.includes(q.type)?
c.push(q.code):(q.expression&&c.push(q.code),q.lookup&&(c.push(q.code),(v=>{v.field&&(c=c.concat(q.lookup.fieldMappings.reduce((w,x)=>{x.field!=v.field&&w.push(x.field);return w},[])))})(q.lookup.fieldMappings.reduce((v,w)=>{v.index<g.indexOf(w.field)&&(v={index:g.indexOf(w.field),field:w.field});return v},{index:-1,field:null}))))})(n[t]);return Array.from(new Set(c))})()),criterias:(()=>{var c={};g.each((q,v)=>{["FILE","REFERENCE_TABLE"].includes(n[q].type)||(c[q]=n[q])});for(var t in n)(q=>{switch(q.type){case "CALC":case "CREATED_TIME":case "CREATOR":case "MODIFIER":case "RECORD_NUMBER":case "UPDATED_TIME":c[q.code]=
q;break;case "STATUS":q.enabled&&(c[q.code]=q,(v=>{c[v.code]=v})(Object.values(n).filter(v=>"STATUS_ASSIGNEE"==v.type).first()))}})(n[t]);return c})(),disables:(()=>{var c=[],t;for(t in n)(q=>{kb.field.reserved.includes(q.type)?c.push(q.code):(q.expression&&c.push(q.code),q.lookup&&(v=>{0!=v.length&&(c=c.concat(v))})(q.lookup.fieldMappings.map(v=>v.field)))})(n[t]);return Array.from(new Set(c))})(),layout:g,parallelize:(()=>{var c={};g.each((q,v)=>{c[q]=n[q]});for(var t in n)(q=>{switch(q.type){case "CATEGORY":q.enabled&&
(c[q.code]=q);break;case "CREATED_TIME":case "CREATOR":case "MODIFIER":case "RECORD_NUMBER":case "UPDATED_TIME":c[q.code]=q;break;case "STATUS":q.enabled&&(c[q.code]=q,(v=>{c[v.code]=v})(Object.values(n).filter(v=>"STATUS_ASSIGNEE"==v.type).first()))}q.code in u.field&&q.code in c&&(c[q.code].id=u.field[q.code])})(n[t]);return c})(),placed:(()=>{var c={};g.each((t,q)=>{["REFERENCE_TABLE"].includes(n[t].type)||(c[t]=n[t])});return c})(),spacers:d,sorts:(()=>{var c={};g.each((q,v)=>{q=n[q];switch(q.type){case "CALC":case "CREATED_TIME":case "CREATOR":case "DATE":case "DATETIME":case "DROP_DOWN":case "LINK":case "MODIFIER":case "NUMBER":case "RADIO_BUTTON":case "RECORD_NUMBER":case "SINGLE_LINE_TEXT":case "TIME":case "UPDATED_TIME":q.tableCode||
(c[q.code]=q)}});for(var t in n)(q=>{switch(q.type){case "CALC":case "CREATED_TIME":case "CREATOR":case "MODIFIER":case "RECORD_NUMBER":case "UPDATED_TIME":c[q.code]=q;break;case "STATUS":q.enabled&&(c[q.code]=q)}})(n[t]);return c})()};m(this.cache[f])})(kb.field.parallelize(r.properties),p(b),(()=>{var n={field:{},table:{}};k&&(Object.values(cybozu.data.page.FORM_DATA.schema.table.fieldList).each((g,u)=>{n.field[g.var]=g.id}),"subTable"in cybozu.data.page.FORM_DATA.schema&&Object.values(cybozu.data.page.FORM_DATA.schema.subTable).each((g,
u)=>{n.table[g.var]=g.id;Object.values(g.fieldList).each((c,t)=>{n.field[c.var]=c.id})}));return n})())}).catch(r=>kb.alert(kb.error.parse(r)))})(e.layout)}).catch(e=>kb.alert(kb.error.parse(e)))})}parallelize(f){f=kb.extend({},f);var k={},m;for(m in f){var h=void 0,e=f[m];switch(e.type){case "SUBTABLE":var b=e.code;for(h in e.fields)e.fields[h]=kb.extend({tableCode:b},e.fields[h]),k[e.fields[h].code]=e.fields[h];break;default:e=kb.extend({tableCode:""},e),k[e.code]=e}}return k}stringify(f,k,m,h=
!1){var e="";if(f&&k)switch(f.type){case "CATEGORY":case "CHECK_BOX":case "MULTI_SELECT":e=k.join(m);break;case "CREATOR":case "MODIFIER":e=k.name;break;case "CREATED_TIME":case "DATETIME":case "UPDATED_TIME":e=k.parseDateTime().format("Y-m-d H:i");break;case "FILE":case "GROUP_SELECT":case "ORGANIZATION_SELECT":case "STATUS_ASSIGNEE":case "USER_SELECT":e=k.map(b=>b.name).join(m);break;case "MULTI_LINE_TEXT":case "RICH_TEXT":e=h?k:k.replace(/\n/g,"");break;case "NUMBER":kb.isNumeric(k)&&(e=f.digit?
Number(k).comma(f.displayScale):f.displayScale?Number(k).toFloor(parseInt(f.displayScale)):k);f.unit&&(e="prefix"==f.unitPosition?f.unit+" "+e:e+" "+f.unit);break;default:e=k}return e}typing(f,k,m=!1){var h=!1;if("SINGLE_LINE_TEXT"==k.type)switch(f.type){case "CALC":case "CREATED_TIME":case "DATE":case "DATETIME":case "DROP_DOWN":case "LINK":case "NUMBER":case "RADIO_BUTTON":case "RECORD_NUMBER":case "SINGLE_LINE_TEXT":case "STATUS":case "TIME":case "UPDATED_TIME":h=m?!0:!k.expression}if(!h)switch(f.type){case "CALC":if(k.type==
f.type)h=k.format==f.format&&m;else switch(f.format){case "DATE":case "DATETIME":case "TIME":h=k.type==f.format;break;case "NUMBER":case "NUMBER_DIGIT":h=(m?["NUMBER","RECORD_NUMBER"]:["NUMBER"]).includes(k.type)}break;case "CHECK_BOX":case "MULTI_SELECT":h=["CHECK_BOX","MULTI_SELECT"].includes(k.type);break;case "CREATED_TIME":case "DATETIME":case "UPDATED_TIME":h="CALC"==k.type?"DATETIME"==k.format&&m:(m?["CREATED_TIME","DATETIME","UPDATED_TIME"]:["DATETIME"]).includes(k.type);break;case "CREATOR":case "MODIFIER":case "STATUS_ASSIGNEE":case "USER_SELECT":h=
(m?["CREATOR","MODIFIER","STATUS_ASSIGNEE","USER_SELECT"]:["USER_SELECT"]).includes(k.type);break;case "DATE":h="CALC"==k.type?"DATE"==k.format&&m:k.type==f.type;break;case "DROP_DOWN":case "RADIO_BUTTON":h=["DROP_DOWN","LINK","RADIO_BUTTON"].includes(k.type);break;case "FILE":case "MULTI_LINE_TEXT":case "RICH_TEXT":h=m?!1:k.type==f.type;break;case "GROUP_SELECT":case "LINK":case "ORGANIZATION_SELECT":case "STATUS":case "TIME":h=k.type==f.type;break;case "NUMBER":case "RECORD_NUMBER":h="CALC"==k.type?
"NUMBER"==k.format&&m:(m?["NUMBER","RECORD_NUMBER"]:["NUMBER"]).includes(k.type);break;case "SINGLE_LINE_TEXT":h=m?["DROP_DOWN","RADIO_BUTTON","LINK","MULTI_LINE_TEXT","RICH_TEXT"].includes(k.type):["LINK","MULTI_LINE_TEXT","RICH_TEXT"].includes(k.type)}return h}objectUrl(f,k){var m=null,h=window.URL||window.webkitURL;if("string"===typeof f){var e=atob(f),b=new Uint8Array(e.length);e.length.each(a=>b[a]=e.charCodeAt(a));m=new Blob([b.buffer],{type:k})}else m=f;return h.createObjectURL(m)}};
window.KintoneBoosterIcon=class{constructor(){}create(f,k,m,h,e){(b=>{b&&b.parentNode.removeChild(b)})(kb.elm("#"+m));switch(k){case "detail":(f?kintone.mobile.app.getHeaderSpaceElement():kintone.app.record.getHeaderMenuSpaceElement().css({padding:"0 0.75em 0 1em"})).append(kb.create("button").addClass("kb-action-icon kb-icon kb-icon-"+h+" kb-page-detail "+(f?" kb-mobile":"")).attr("id",m).on("click",b=>{e&&e()}));break;case "index":(f?kintone.mobile.app.getHeaderSpaceElement():kintone.app.getHeaderMenuSpaceElement()).append(kb.create("button").addClass("kb-action-icon kb-icon kb-icon-"+
h+" kb-page-index "+(f?" kb-mobile":"")).attr("id",m).on("click",b=>{e&&e()}))}}};
window.KintoneBoosterRecord=class{constructor(){this.comments={get:(f,k)=>new Promise((m,h)=>{var e=(b,a,d)=>{kintone.api(kintone.api.url("/k/v1/record/comments",!0),"GET",{app:f,record:k,order:"asc",offset:a}).then(l=>{Array.prototype.push.apply(b,l.comments);a+=10;10==l.comments.length?e(b,a,d):d(b)}).catch(l=>h(l))};e([],0,b=>m(b))}),set:(f,k,m,h=!1)=>new Promise((e,b)=>{var a=(d,l)=>{0!=m.length?kintone.api(kintone.api.url("/k/v1/record/comment",!0),"POST",{app:f,record:k,comment:{text:m[d].text,
mentions:m[d].mentions}}).then(p=>{h||kb.progressUpdate();d++;d<m.length?a(d,l):l()}).catch(p=>b(p)):l()};h||kb.progressStart(m.length);a(0,()=>{h||kb.progressEnd();e()})})};this.page={add:(f,k)=>kintone.api.url("/k/",!0).replace(/\.json/g,"")+(f?"m/"+k:k)+"/edit",detail:(f,k,m)=>kintone.api.url("/k/",!0).replace(/\.json/g,"")+(f?"m/"+k:k)+"/show"+(f?"?":"#")+"record="+m,edit:(f,k,m)=>kintone.api.url("/k/",!0).replace(/\.json/g,"")+(f?"m/"+k:k)+"/show"+(f?"?":"#")+"record="+m+(f?"#":"&")+"mode=edit"}}create(f,
k=!0){var m={},h;for(h in f.fields)(e=>{switch(e.type){case "CHECK_BOX":case "CONDITION":case "FILE":case "GROUP_SELECT":case "MULTI_SELECT":case "ORGANIZATION_SELECT":case "USER_SELECT":m[h]={type:e.type,value:[]};break;case "RADIO_BUTTON":(b=>{m[h]={type:e.type,value:0!=b.length?b.reduce((a,d)=>{a[d.index]=d;return a},Array(b.length).fill("")).first().label:""}})(Object.values(e.options));break;case "SUBTABLE":m[h]={type:e.type,value:[{value:this.create(e,!1)}]};break;default:kb.field.reserved.includes(e.type)||
(m[h]={type:e.type,value:""})}})(f.fields[h]);k&&(m.$id={type:"__ID__",value:""});return m}get(f,k,m){var h={error:!1,record:{}};if(!m)for(var e in k.fields)if(((b,a)=>{if(b)switch("SUBTABLE"!=a.type&&(b=b.elm(".kb-field-value")),a.type){case "CHECK_BOX":case "MULTI_SELECT":a.required&&!b.elms("input").some(d=>d.checked)&&(b.alert(kb.constants.common.message.invalid.required[kb.operator.language]),h.error=!0);break;case "FILE":case "GROUP_SELECT":case "ORGANIZATION_SELECT":case "USER_SELECT":a.required&&
(d=>{0==d.length&&(b.alert(kb.constants.common.message.invalid.required[kb.operator.language]),h.error=!0)})(b.elm("input").val()?JSON.parse(b.elm("input").val()):[]);break;case "SUBTABLE":break;default:b.elms("input,select,textarea").each((d,l)=>{d.checkValidity()||(h.error=!0)})}})(f.elm('[field-id="'+CSS.escape(e)+'"]'),k.fields[e]),h.error)break;if(h.error)kb.alert(kb.constants.common.message.invalid.record[kb.operator.language]);else{for(e in k.fields)((b,a)=>{if(b)switch("SUBTABLE"!=a.type&&
(b=b.elm(".kb-field-value")),a.type){case "CALC":h.record[a.code]={type:a.type,value:null};break;case "CHECK_BOX":case "MULTI_SELECT":h.record[a.code]={type:a.type,value:(()=>{var d=[];b.elms("input").each((l,p)=>{l.checked&&!l.parentNode.hasClass("kb-hidden")&&d.push(l.val())});return d})()};break;case "CREATED_TIME":case "UPDATED_TIME":h.record[a.code]={type:a.type,value:b.elm("input").val()?b.elm("input").val():(new Date).format("ISO")};break;case "CREATOR":case "MODIFIER":h.record[a.code]={type:a.type,
value:b.elm("input").val()?JSON.parse(b.elm("input").val()):{code:kb.operator.code,name:kb.operator.name}};break;case "DATETIME":h.record[a.code]={type:a.type,value:(()=>{var d="";b.elm("input").val()&&(b.elm(".kb-hour").elm("select").val()||b.elm(".kb-hour").elm("select").val("00"),b.elm(".kb-minute").elm("select").val()||b.elm(".kb-minute").elm("select").val("00"));b.elm("input").val()&&b.elm(".kb-hour").elm("select").val()&&b.elm(".kb-minute").elm("select").val()&&(d=(b.elm("input").val()+" "+
b.elm(".kb-hour").elm("select").val()+":"+b.elm(".kb-minute").elm("select").val()+":00").parseDateTime().format("ISO"));return d})()};break;case "DROP_DOWN":h.record[a.code]={type:a.type,value:b.elm("select").val()};break;case "FILE":case "GROUP_SELECT":case "ORGANIZATION_SELECT":case "STATUS_ASSIGNEE":case "USER_SELECT":h.record[a.code]={type:a.type,value:b.elm("input").val()?JSON.parse(b.elm("input").val()):[]};break;case "MULTI_LINE_TEXT":case "RICH_TEXT":h.record[a.code]={type:a.type,value:b.elm("textarea").val()};
break;case "NUMBER":h.record[a.code]={type:a.type,value:kb.isNumeric(b.elm("input").val())?parseFloat(b.elm("input").val()):b.elm("input").val()};break;case "RADIO_BUTTON":h.record[a.code]={type:a.type,value:(()=>{var d="";b.elms("[data-name="+a.code+"]").each((l,p)=>{l.checked&&!l.parentNode.hasClass("kb-hidden")&&(d=l.val())});return d})()};break;case "RECORD_NUMBER":case "STATUS":h.record[a.code]={type:a.type,value:b.elm(".kb-guide").text()};break;case "SUBTABLE":h.record[a.code]={type:a.type,
value:(()=>{var d=[];b.tr.each((l,p)=>{p=this.get(l,a,m);if(p.error)return h.error=p.error,KB_BREAK;d.push(l.hasAttribute("row-id")?{id:l.attr("row-id"),value:p.record}:{value:p.record})});return d})()};break;case "TIME":h.record[a.code]={type:a.type,value:(()=>{var d="";b.elm(".kb-hour").elm("select").val()&&(b.elm(".kb-minute").elm("select").val()||b.elm(".kb-minute").elm("select").val("00"));b.elm(".kb-minute").elm("select").val()&&(b.elm(".kb-hour").elm("select").val()||b.elm(".kb-hour").elm("select").val("00"));
b.elm(".kb-hour").elm("select").val()&&b.elm(".kb-minute").elm("select").val()&&(d=b.elm(".kb-hour").elm("select").val()+":"+b.elm(".kb-minute").elm("select").val());return d})()};break;default:kb.field.reserved.includes(a.type)||(h.record[a.code]={type:a.type,value:b.elm("input").val()})}})(f.elm('[field-id="'+CSS.escape(e)+'"]'),k.fields[e]);f.elm("[data-type=id]")&&(h.record.$id={value:f.elm("[data-type=id]").val()?parseInt(f.elm("[data-type=id]").val()):f.elm("[data-type=id]").val()})}return h}set(f,
k,m){return new Promise((h,e)=>{var b=(a,d,l,p)=>{var r=[],n;for(n in l)((g,u,c)=>{if(g&&c){"disabled"in c&&(c.disabled?g.addClass("kb-disabled"):g.removeClass("kb-disabled"));"hidden"in c&&(c.hidden?g.addClass("kb-hidden"):g.removeClass("kb-hidden"));if("SUBTABLE"!=u.type)switch(g=g.elm(".kb-field-value"),"backcolor"in c&&(c.backcolor?g.addClass("kb-force-backcolor").elm(".kb-guide").css({backgroundColor:c.backcolor}):g.removeClass("kb-force-backcolor").elm(".kb-guide").css({backgroundColor:""})),
"forecolor"in c&&(c.forecolor?g.addClass("kb-force-forecolor").elm(".kb-guide").css({color:c.forecolor}):g.removeClass("kb-force-forecolor").elm(".kb-guide").css({color:""})),"error"in c&&(g.alert?g.alert(c.error):g.elms("input,select,textarea").each((q,v)=>{q.alert&&q.alert.elm("span").html(c.error).parentNode.show()})),u.type){case "CALC":case "CATEGORY":case "CHECK_BOX":case "CONDITION":case "CREATED_TIME":case "CREATOR":case "FILE":case "GROUP_SELECT":case "MODIFIER":case "MULTI_SELECT":case "ORGANIZATION_SELECT":case "RADIO_BUTTON":case "RECORD_NUMBER":case "REFERENCE_TABLE":case "SPACER":case "STATUS":case "STATUS_ASSIGNEE":case "UPDATED_TIME":case "USER_SELECT":"backcolor"in
c&&g.css({backgroundColor:c.backcolor?c.backcolor:""});"forecolor"in c&&g.css({color:c.forecolor?c.forecolor:""});break;default:g.elms("input,select,textarea").each((q,v)=>{"backcolor"in c&&q.css({backgroundColor:c.backcolor?c.backcolor:""});"forecolor"in c&&q.css({color:c.forecolor?c.forecolor:""})})}switch(u.type){case "CALC":case "RECORD_NUMBER":case "STATUS":g.elm(".kb-guide").html(c.value);break;case "CATEGORY":g.elm(".kb-guide").html(c.value.join("<br>"));break;case "CHECK_BOX":case "MULTI_SELECT":g.elms("input").each((q,
v)=>{q.checked=c.value.includes(q.val())});g.elm(".kb-guide").html(c.value.join("<br>"));break;case "COLOR":g.css({backgroundColor:c.value?c.value:"transparent"}).elm("input").val(c.value);g.elm(".kb-guide").html(c.value);break;case "CONDITION":g.elm(".kb-guide").empty();c.value?(g.elm("input").val(c.value),c.value.split(" and ").each((q,v)=>g.guide(q))):g.elm("input").val("");break;case "CREATOR":case "MODIFIER":g.elm("input").val(JSON.stringify(c.value));g.elm(".kb-guide").html(c.value.name);break;
case "CREATED_TIME":case "UPDATED_TIME":c.value?(g.elm("input").val(c.value),g.elm(".kb-guide").html((new Date(c.value)).format("Y-m-d H:i"))):(g.elm("input").val(""),g.elm(".kb-guide").html(""));break;case "DATETIME":if(c.value){var t=c.value.parseDateTime();g.elm("input").val(t.format("Y-m-d"));g.elm(".kb-hour").elm("select").val(t.format("H"));g.elm(".kb-minute").elm("select").val(t.format("i"));g.elm(".kb-guide").html(t.format("Y-m-d H:i"))}else g.elm("input").val(""),g.elm(".kb-hour").elm("select").val(""),
g.elm(".kb-minute").elm("select").val(""),g.elm(".kb-guide").html("");break;case "DROP_DOWN":g.elm("select").val(c.value);g.elm(".kb-guide").html(g.elm("select").selectedText());break;case "FILE":case "GROUP_SELECT":case "ORGANIZATION_SELECT":case "USER_SELECT":g.elm(".kb-guide").empty();c.value?(g.elm("input").val(JSON.stringify(c.value)),c.value.each((q,v)=>g.guide(q))):g.elm("input").val("[]");break;case "LINK":g.elm("input").val(c.value);g.elm(".kb-guide").empty();if(c.value)switch(u.protocol){case "MAIL":g.elm(".kb-guide").append(kb.create("a").attr("href",
"mailto:"+c.value).html(c.value));break;case "CALL":g.elm(".kb-guide").append(kb.create("a").attr("href","tel:"+c.value).html(c.value));break;case "WEB":g.elm(".kb-guide").append(kb.create("a").attr("href",c.value).attr("target","_blank").html(c.value))}break;case "MULTI_LINE_TEXT":case "RICH_TEXT":g.elm("textarea").val(c.value);g.elm(".kb-guide").html(c.value.replace(/\n/g,"<br>"));break;case "NUMBER":c.lookup?r.push({field:g,value:c.value}):(u.digit?kb.isNumeric(c.value)?(g.elm("input").val(Number(c.value).comma(u.displayScale)),
g.elm(".kb-guide").html(Number(c.value).comma(u.displayScale))):(g.elm("input").val(c.value),g.elm(".kb-guide").html(c.value)):u.displayScale?kb.isNumeric(c.value)?(g.elm("input").val(Number(c.value).toFloor(parseInt(u.displayScale))),g.elm(".kb-guide").html(Number(c.value).toFloor(parseInt(u.displayScale)))):(g.elm("input").val(c.value),g.elm(".kb-guide").html(c.value)):(g.elm("input").val(c.value),g.elm(".kb-guide").html(c.value)),u.unit&&("prefix"==u.unitPosition?g.elm(".kb-guide").html(u.unit+
" "+g.elm(".kb-guide").text()):g.elm(".kb-guide").html(g.elm(".kb-guide").text()+" "+u.unit)));break;case "RADIO_BUTTON":g.elms("[data-name="+n+"]").each((q,v)=>{q.checked=c.value==q.val()});g.elm(".kb-guide").html(c.value);break;case "SPACER":break;case "STATUS_ASSIGNEE":g.elm(".kb-guide").empty();c.value?(g.elm("input").val(JSON.stringify(c.value)),c.value.each((q,v)=>{g.elm(".kb-guide").append(kb.create("span").addClass("kb-guide-item").append(kb.create("span").addClass("kb-guide-item-label").html(q.name)))})):
g.elm("input").val("[]");break;case "SUBTABLE":if(0==c.value.length)g.clearRows();else{g.tr.each((q,v)=>{c.value.length>v&&b(q,u,(w=>{if(c.disabled)for(var x in w)w[x].disabled=!0;return w})(c.value.map(w=>w.value)[v]),w=>r=r.concat(w))});for(t=g.tr.length;t<c.value.length;t++)b(g.addRow(),u,(q=>{if(c.disabled)for(var v in q)q[v].disabled=!0;return q})(c.value.map(q=>q.value)[t]),q=>r=r.concat(q));g.tr.slice(c.value.length).each((q,v)=>g.delRow(q))}0==g.tr.length?(q=>{c.disabled&&b(q,u,(v=>{for(var w in v)v[w].disabled=
!0;return v})(this.get(q,u,!0).record),v=>r=r.concat(v))})(g.addRow()):g.tr.each((q,v)=>{"id"in c.value[v]&&q.attr("row-id",c.value[v].id)});break;case "TIME":c.value?(g.elm(".kb-hour").elm("select").val(c.value.split(":")[0]),g.elm(".kb-minute").elm("select").val(c.value.split(":")[1]),g.elm(".kb-guide").html(c.value)):(g.elm(".kb-hour").elm("select").val(""),g.elm(".kb-minute").elm("select").val(""),g.elm(".kb-guide").html(""));break;default:c.lookup?r.push({field:g,value:c.value}):(g.elm("input").val(c.value),
g.elm(".kb-guide").html(c.value))}}})(a.elm('[field-id="'+CSS.escape(n)+'"]'),d.fields[n],l[n]);"$id"in l&&a.elm("[data-type=id]")&&a.elm("[data-type=id]").val(l.$id.value);p(r)};b(f,k,m,a=>{var d=(l,p)=>{0!=a.length?a[l].field.lookup(null,a[l].value).then(()=>{l++;l<a.length?d(l,p):p()}):p(!1)};d(0,()=>{f.hasOwnProperty("cleanup")&&f.cleanup();h()})})})}simplify(f,k){var m={},h;for(h in f.fields)(e=>{switch(e.type){case "CATEGORY":case "CHECK_BOX":case "MULTI_SELECT":m[h]={value:h in k?Array.from(new Set(k[h].value.sort())):
[]};break;case "CALC":case "CREATED_TIME":case "CREATOR":case "FILE":case "MODIFIER":case "RECORD_NUMBER":case "REFERENCE_TABLE":case "SPACER":case "STATUS":case "UPDATED_TIME":break;case "GROUP_SELECT":case "ORGANIZATION_SELECT":case "STATUS_ASSIGNEE":case "USER_SELECT":m[h]={value:h in k?Array.from(new Set(k[h].value.map(b=>b.code).sort())):[]};break;case "NUMBER":m[h]={value:h in k?kb.isNumeric(k[h].value)?k[h].value.toString():"":""};break;case "SUBTABLE":m[h]={value:k[h].value.reduce((b,a)=>
{b.push({value:this.simplify(e,a.value)});return b},[])};break;default:m[h]={value:h in k?(k[h].value||" ").toString().replace(/[\r\n]*/g,""):""}}})(f.fields[h]);return m}};
window.KintoneBoosterRecordBuilder=class extends KintoneBoosterDialog{constructor(){super(999996,!1,!1);this.table=this.handler=null;this.container.css({height:"calc(100% - 1em)",width:"55em"});this.contents.addClass("kb-recordbuilder").css({padding:"0"})}build(f,k,m){var h=b=>{b=[];b.push({code:"",label:""});for(var a in f){var d=f[a];switch(d.type){case "CALC":case "CATEGORY":case "CREATED_TIME":case "CREATOR":case "FILE":case "GROUP":case "HR":case "LABEL":case "MODIFIER":case "RECORD_NUMBER":case "REFERENCE_TABLE":case "SPACER":case "STATUS":case "STATUS_ASSIGNEE":case "SUBTABLE":case "UPDATED_TIME":break;
default:b.push({code:a,label:d.label})}}return b},e=()=>{this.table=kb.table.create({code:"fields",type:"SUBTABLE",label:"",noLabel:!0,fields:{field:{code:"field",type:"DROP_DOWN",label:"",required:!1,noLabel:!0,options:[]},value:{code:"value",type:"SPACER",label:"",required:!1,noLabel:!0,contents:""}}}).spread((b,a)=>{b.elm(".kb-table-row-add").on("click",d=>{this.table.insertRow(b)});b.elm(".kb-table-row-del").on("click",d=>{kb.confirm(kb.constants.common.message.confirm.delete[kb.operator.language],
()=>{this.table.delRow(b)})});(d=>{(l=>{l.field.empty().assignOption(h(),"label","code").on("change",p=>p.currentTarget.rebuild()).rebuild=()=>new Promise((p,r)=>{l.value.empty();l.field.val()&&(n=>{n.code="value";n.label="";n.required=!1;n.noLabel=!0;switch(n.type){case "NUMBER":n.unit="";break;case "USER_SELECT":n.loginuser=!0}l.value.append(kb.field.activate(kb.field.create(n),(g=>{g.fields[n.code]=n;return g})({id:"recordbuilder",fields:{}})));l.value.elms("input,select,textarea").each((g,u)=>
g.initialize());l.value.get=()=>kb.record.get(d,{fields:{value:n}},!0).record.value.value})(kb.extend({},f[l.field.val()]));p({})})})({field:d.elm("[field-id=field]").elm("select"),value:d.elm("[field-id=value]").css({padding:"0"})})})(b.addClass("kb-scope").attr("form-id","form_recordbuilder"))},(b,a)=>{0==b.tr.length&&b.addRow()},!1);this.contents.empty().append(this.table);this.handler&&this.ok.off("click",this.handler);this.handler=b=>{this.hide();m(this.table.tr.reduce((a,d)=>{var l=d.elm("[field-id=field]").elm("select");
d=d.elm("[field-id=value]");l.val()&&(d=d.get(),a[l.val()]={value:d},f[l.val()].lookup&&(a[l.val()].lookup=d?!0:"CLEAR"));return a},{}))};this.ok.on("click",this.handler);this.cancel.on("click",b=>this.hide());this.table.addRow();super.show()};0==kb.roleSet.user.length?kb.roleSet.load().then(()=>e()):e()}};
window.KintoneBoosterRecordPicker=class extends KintoneBoosterDialog{constructor(f,k,m){super(999997,!1,!k);this.multiSelect=k;this.prepend=m;this.type=f;this.limit=50;this.offset=0;this.table=null;this.fieldInfo={};this.records=[];this.selection=[];this.img=this.parts.icon.clone().css({top:"0px"});this.prev=this.img.clone().css({right:"4em"}).attr("src","data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADwAAAA8CAYAAAFN++nkAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAjZJREFUeNpiYKAJ6J8y8T+MzYIm0QCk6pHFmNA016ObhqKgMCefkfoOBggg6vr9Psz/LLgCBcVb6BI4gxSvQqJMAQggugYDinNYSNVAUDOxHmbCJghNRo2ENDMSG+VASoGq6RMggIY7Agbae6Limdh4ZyGgaT2QCiAphRGbyliwaALZtJ7s5EksYCTF2ehJE6fNUIUbqFIIUFQuYUskAwcAAmgUUTP3F5CUpSi0DD07TqCZxUDLQBXBfVL1sZBpmQCQoiiPsJCRIQWoES3ENAn2AykHaic+Rlr6GF8DgJGWcUx1i4lN1TS1GF8+HpC2FqGSa+QBgAAaRaNgFBBVcJDVm6BCL4uo2ouFShYaAKnzNG/6oFkKstCALm0uarS7mMi0tJ+ujT1i+79UtRhav/ZTKwewUDubULN5S5MRO4KJC9pu+kB3i6GWC4KoAWvQkxL0hFqYJOdjqIET6BLUWCwHBbsg3S2GWv4B6vsLdLUYyQGGQMqQ5omL2IKG6omL3tluFIwCkgFAgPbN6AZAGASi1XQQR3BD3aSrGhLilzZqoQK9iwu8RLnrUfFAEORKbla63NNSRbq21KPZOCQFqJIqC133wAxJt2FU+uZsCHRPF9d+QgFzq7FJlwymgHk/U3pCdgfmgpMm7PL3p5MVIU8bsTQUpbtxcRsxB6xtI9Ka02CaPL7SLdFSLUtrDi2TwJq2ZB5YOni4ApaIlm6Bvx4eQgC/8fVQwE9sLizwnc3hbwMIgobRAdIK28oCHbudAAAAAElFTkSuQmCC").on("click",
h=>{this.offset-=this.limit;this.search()});this.next=this.img.clone().css({right:"2em"}).attr("src","data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADwAAAA8CAYAAAFN++nkAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAi1JREFUeNpiYKAa6J8y8T8Q30cXZ0LjK4AU4lMANw3GZkGXLMzJZ2QgpIskABBAVPI/Xr9DA6gBn7/rcUri9DNJACCAaO9lXICRkGZ8HmQkxWZ0g5iIdGEjNhew4NHwAKhBkWaBCxBAwwUBo+o9sWqxRZUAsamMiUDJtJ4szVAQgM8VTMRmFiAOIEszLsBCjCJcOYuQzRvwZUkWUm2jWiIZOAAQQKMIW8QV0MJcRmKyExI3EJjsNgyExchAEeiIBwNhMTIQBDriw0BYDAMfgA4QHAiLkcEBoCMcKSo1aeFjallMchxTYjFFqZpUi6mWjwes5Bp5ACCARtEoGJlNn/+0KESI7RD0U7vRTEpPRADqewN6WwwD54GWnx/Ixh5Z9TBVOn1A8B7osP6BsBgECshplzENVLZjona2JzbbUdtiogdDaGHxB2K69dS2uJDe7WqSBy+o4eMJ5IyYUOpjsksuci2+ALTQkBIXk2OxIdDSC5TGDwuJ2USQWomRidrZZBSMggEHAAHaNaMbAEEYiBLDgo7AJo7gaI7gCI5giMSAn0LLNb0XBuAlhF4LXIQQU3Q/vZfcnsPI2jNPtSZck+e66W/utCjcpPzw/DC4vAjXZPHNk/DbDxT53YvwVz6pvecACNec5aY/vAg3zb5UmUMVFitzFoSHlrklOCMa2OPQI40qLHZpIQmrlKXZwurBI06SnBYtNYUhmgdpYbj2UEIYegAwStjMiIcQQkxxA49895hLUEtfAAAAAElFTkSuQmCC").on("click",
h=>{this.offset+=this.limit;this.search()});this.submit=this.img.clone().css({left:"0"}).attr("src","data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADwAAAA8CAYAAAFN++nkAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAA7BJREFUeNpiYKAa6J8yMQFK/yfbhP9Qej7RigkpOk+U1QABRLnf92MTZ4LSDkgKHbDpNiDoHZACvIqIChCAAKIIMeLwNtxHhTn5jCTFNHoo4FLPRISZ58mJNQdCwctIauIlKRzwAYAAGqKIkUBcNwIDp4GsRAIqFoC4gBiNAaTmEOQUZkBpWfCeXJtB4AFSMRgAYoNSE9Zyg5R0TVbaRteEnK4JZkn0TAA0rIGcwPxP+4KNWAAQQKO5mVCeg2WdA8DYP0Azi6FZTACILwAtMkQSB4ndxyZHjfbNf2LaE1RNsqBMQ4phUMsdSLEDV04+gBSkRJW3pMY5E45iA2RIIxC/x9cQhEbFeiB2pHqqhlYz/TikHUGOhLZXzpNS6TNSIT2A4nY/MQUuVS0mpibD5gCqt4NwOCARaPkCuhSJ0CyZMFo5wABAAI2iUTCwLRBoLVWAVBI10NRioIUK0JYG0UUhxRaj1TiBQEs2oLWu66FcQaDcB1ItZiHUu8bmK2hQw1op78kp85lw+HY9kUGpiFRnU24xEICaMwSDD+iwBzC3UstiEJhIpBlkta+ZqJAlBahtcT2RZhhQ0+IFxDRvkdrSgVSxGJhoEqHM9wRKs/1Q9RuoGdSCSL2E+WiW7oc5Cpbl8A3Jkduufo8jAT0AWqqIRQ1RDTtSuqmw+PwANPgCWm/CgNRWJTUa9Lja03gtp0Y+xpWi5+Nr3lJsMTRFJ5JqOTV8zAANUpyW08xiIiynncV4LBekW0MO1GQiawxwFAwrABCgXau9QRCIoYQJWMENdAJlBCZQJjCOwAZugE4AG+AGygSs4AjapJra8HF3HEcx96J/jCR91uu1r8+/PDw8/k+FUGw+jzhg9gGGT+iSMjJkLoMwzgxVS5v/xKG1Jp9tA+IfIIDOPDYRMZwRRgnozogq77dxysvZvwE2Z7E4wi17h2yMyMacI5Dl1dTZDjWCixjZZKyiiFm9EAmlmjrDOvMDlc5KE9FhQOwArHU3k1MSpqgtx3FzVbRMCW8tDnURq+AyzjCe108wO4uTZ8GOykNSlYYrqWEBJiMy25Dr7SvRiWs8WuQ7OIOpSveERalg9/j5/exJeqcVYeC7gUIUBd3i+Q9R7N5y8v0n/pDl7IRbyB/e733QvxmAwK+cQE+bSmHFVjC7F5RbVRQwirgI82vPrsE6cTFuXxTPc4NHtYiLszcbEofitlG5JUJphCFbuKdLNR77FM3lZdgw48om0MU49juIO1dMPDw8PJziBXvFttyY+HdhAAAAAElFTkSuQmCC").on("click",
h=>{this.offset=0;this.search()});this.input=this.parts.input.clone().css({paddingLeft:"2em",paddingRight:"4em"}).attr("placeholder",kb.constants.common.prompt.keyword[kb.operator.language]).attr("type","text").on("keydown",h=>{if(13==(h.keyCode||h.which))return this.offset=0,this.search(),h.stopPropagation(),h.preventDefault(),!1});this.container.css({height:"calc(34em + 16px)",minWidth:"16em"});this.contents.css({padding:"0px"});this.header.css({boxShadow:"none"}).append(this.input).append(this.next).append(this.prev).append(this.submit)}search(f){switch(this.type){case "record":kintone.api(kintone.api.url("/k/v1/records",
!0),"GET",{app:this.fieldInfo.app,query:(()=>{var m=[];this.fieldInfo.query&&m.push(this.fieldInfo.query);this.input.val()&&m.push((h=>{var e=[];h.each((b,a)=>{for(var d in this.fieldInfo.picker)switch(a=this.fieldInfo.picker[d],a.type){case "LINK":case "MULTI_LINE_TEXT":case "RICH_TEXT":case "SINGLE_LINE_TEXT":e.push(a.code+' like "'+b+'"')}});return 0!=e.length?"("+e.join(" or ")+")":""})(this.input.val().split(/[ \u3000]/).filter(h=>h)));return m.join(" and ")+" order by "+(this.fieldInfo.sort?
this.fieldInfo.sort:"$id asc")+" limit "+this.limit+" offset "+this.offset})(),totalCount:!0}).then(m=>{this.records=m.records;this.table.clearRows();this.records.each((h,e)=>{(b=>{kb.record.set(b,{fields:this.fieldInfo.picker},h);this.multiSelect&&this.selection.some(a=>a.$id.value==h.$id.value)&&b.css({backgroundColor:"rgba(66,165,245,0.5)",color:""})})(this.table.addRow())});0<this.offset?this.prev.show():this.prev.hide();this.offset+(this.limit==this.records.length?this.limit:this.records.length)<
parseInt(m.totalCount)?this.next.show():this.next.hide();f&&f()}).catch(m=>kb.alert(kb.error.parse(m)));break;default:var k=()=>{var m=(()=>{var h=this.prepend?this.prepend.concat(kb.roleSet[this.type]):kb.extend({},kb.roleSet[this.type]);this.input.val()&&(e=>{h=h.filter(b=>{var a=!1;b.name.value&&(a=e.some(d=>b.name.value.match(new RegExp(d,"ig"))));return a})})(this.input.val().replace(/[\u3000 ]+/g," ").split(" ").filter(e=>e));return h})();this.records=m.slice(this.offset,this.offset+this.limit);
this.table.clearRows();this.records.each((h,e)=>{(b=>{kb.record.set(b,{fields:this.fieldInfo.picker},h);this.multiSelect&&this.selection.some(a=>a.code.value==h.code.value)&&b.css({backgroundColor:"rgba(66,165,245,0.5)",color:""})})(this.table.addRow())});0<this.offset?this.prev.show():this.prev.hide();this.offset+(this.limit==this.records.length?this.limit:this.records.length)<m.length?this.next.show():this.next.hide();f&&f()};0==kb.roleSet.user.length?kb.roleSet.load().then(()=>k()):k()}}show(f,
k){var m=this.parts.div.clone().css({borderTop:"1px solid #42a5f5",borderBottom:"1px solid #42a5f5",lineHeight:"2em",padding:"0px 0.5em"}),h=this.parts.td.clone().css({cursor:"pointer",padding:"0",userSelect:"none"}),e=this.parts.th.clone().css({backgroundColor:kb.themeColor().backcolor});this.offset=0;this.fieldInfo=f;this.records=[];this.selection=[];this.input.val("");this.table=this.parts.table.clone().css({marginBottom:"0.5em"}).append(kb.create("thead").append(kb.create("tr"))).append(kb.create("tbody").append(kb.create("tr")));
for(var b in this.fieldInfo.picker)(a=>{this.table.elm("thead tr").append(e.clone().append(m.clone().html("label"in a?a.label:"")));var d=this.table.elm("tbody tr"),l=d.append,p=h.clone(),r=p.append,n=kb.field,g=n.create;a=kb.extend({},a);a.noLabel=!0;l.call(d,r.call(p,g.call(n,a).css({width:"100%"}).addClass("kb-picker kb-readonly")))})(this.fieldInfo.picker[b]);this.contents.empty().append(this.table.spread((a,d)=>{a.on("click",l=>{(p=>{this.multiSelect?(r=>{r.length==this.selection.length?(this.selection.push(kb.extend({},
p)),a.css({backgroundColor:"rgba(66,165,245,0.5)",color:""})):(this.selection=r,a.css({backgroundColor:"transparent",color:kb.themeColor().forecolor}))})(this.selection.filter(r=>"record"==this.type?r.$id.value!=p.$id.value:r.code.value!=p.code.value)):(k&&k(p),this.hide())})(this.records[d])});(l=>{a.addClass("kb-scope").elms(".kb-field").each((p,r)=>kb.field.activate(p,l))})({id:"recordPicker",fields:kb.extend({},this.fieldInfo.picker)})}));this.multiSelect&&(this.handler&&this.ok.off("click",this.handler),
this.handler=a=>{k&&k(this.selection);this.hide()},this.ok.on("click",this.handler),this.cancel.on("click",a=>this.hide()));this.search(()=>super.show())}};
window.KintoneBoosterTable=class{constructor(){}activate(f,k){return f.spread((m,h)=>{(e=>{m.elm(".kb-table-row-add").on("click",b=>{f.insertRow(m);kb.event.call("kb.row.add."+f.attr("field-id"),{container:f,record:kb.record.get(e,k,!0).record,rowindex:parseInt(m.attr("row-idx"))+1}).then(a=>{a.error?f.delRow(m):kb.event.call("kb.action.call",{container:e,record:a.record,mobile:location.href.match(/\/m\//g)?!0:!1,pattern:"change",field:f.attr("field-id"),workplace:e.closest(".kb-view")?"view":"record"}).then(d=>
{kb.event.call("kb.style.call",{container:e,record:d.record,mobile:d.mobile,pattern:"$id"in d.record?d.record.$id.value?"edit":"create":"create",workplace:d.workplace}).then(l=>{kb.record.set(e,k,l.record);l=new Event("change");e.attr("unsaved","unsaved").dispatchEvent(l)}).catch(()=>{})})})});m.elm(".kb-table-row-copy").on("click",b=>{f.insertRow(m);kb.event.call("kb.row.copy."+f.attr("field-id"),{container:f,record:((a,d)=>{a[f.attr("field-id")].value[d+1]={value:kb.extend({},a[f.attr("field-id")].value[d].value)};
return a})(kb.record.get(e,k,!0).record,parseInt(m.attr("row-idx"))),rowindex:parseInt(m.attr("row-idx"))+1}).then(a=>{a.error?f.delRow(m):kb.event.call("kb.action.call",{container:e,record:a.record,mobile:location.href.match(/\/m\//g)?!0:!1,pattern:"change",field:f.attr("field-id"),workplace:e.closest(".kb-view")?"view":"record"}).then(d=>{kb.event.call("kb.style.call",{container:e,record:d.record,mobile:d.mobile,pattern:"$id"in d.record?d.record.$id.value?"edit":"create":"create",workplace:d.workplace}).then(l=>
{kb.record.set(e,k,l.record);l=new Event("change");e.attr("unsaved","unsaved").dispatchEvent(l)}).catch(()=>{})})})});m.elm(".kb-table-row-del").on("click",b=>{kb.confirm(kb.constants.common.message.confirm.delete[kb.operator.language],()=>{kb.event.call("kb.row.del."+f.attr("field-id"),{container:f,record:kb.record.get(e,k,!0).record,rowindex:parseInt(m.attr("row-idx"))}).then(a=>{a.error||(f.delRow(m),kb.event.call("kb.action.call",{container:e,record:kb.record.get(e,k,!0).record,mobile:location.href.match(/\/m\//g)?
!0:!1,pattern:"change",field:f.attr("field-id"),workplace:e.closest(".kb-view")?"view":"record"}).then(d=>{kb.event.call("kb.style.call",{container:e,record:d.record,mobile:d.mobile,pattern:"$id"in d.record?d.record.$id.value?"edit":"create":"create",workplace:d.workplace}).then(l=>{kb.record.set(e,k,l.record);l=new Event("change");e.attr("unsaved","unsaved").dispatchEvent(l)}).catch(()=>{})}))})})});m.elms(".kb-field").each((b,a)=>kb.field.activate(b,k));f.tr.each((b,a)=>b.attr("row-idx",a))})(f.closest("[form-id=form_"+
k.id+"]"))},(m,h)=>{0==m.tr.length?m.addRow():m.tr.each((e,b)=>e.attr("row-idx",b))},!1)}create(f,k,m,h,e){return(b=>{m||h||b.append(kb.create("thead").append(kb.create("tr")));b.append(kb.create("tbody").append(kb.create("tr").addClass("kb-scope").attr("row-idx","")));for(var a in f.fields)(d=>{m||h||b.elm("thead tr").append(kb.create("th").append(kb.create("span").html(d.label)));var l=b.elm("tbody tr"),p=l.append,r=kb.create("td"),n=r.append,g=kb.field,u=g.create;d=kb.extend({},d);h||(d.noLabel=
!0);p.call(l,n.call(r,u.call(g,d,e)))})(f.fields[a]);m||h||b.elm("thead tr").append(kb.create("th").addClass("kb-table-button"+(k?" kb-table-button-extension":"")));b.elm("tbody tr").append(kb.create("td").addClass("kb-table-button"+(k?" kb-table-button-extension":"")).append(kb.create("button").addClass("kb-icon kb-icon-add kb-table-row-add")).append(kb.create("button").addClass("kb-icon kb-icon-copy kb-table-row-copy").css({display:k?"inline-block":"none"})).append(kb.create("button").addClass("kb-icon kb-icon-del kb-table-row-del")));
for(a in f.fields)(d=>{d.lookup&&d.lookup.fieldMappings.each((l,p)=>{l.field in f.fields&&b.elm('[field-id="'+CSS.escape(l.field)+'"]')&&b.elm('[field-id="'+CSS.escape(l.field)+'"]').addClass("kb-readonly")})})(f.fields[a]);return b.attr("field-id",f.code)})(kb.create("table").addClass("kb-table"))}};
window.KintoneBoosterView=class{constructor(){this.records={delete:(f,k,m=!1)=>new Promise((h,e)=>{var b=(a,d)=>{0!=k.length?kintone.api(kintone.api.url("/k/v1/records",!0),"DELETE",{app:f,ids:k.slice(a,a+100)}).then(l=>{m||kb.progressUpdate();a+=100;0<k.slice(a,a+100).length?b(a,d):d()}).catch(l=>e(l)):d()};m||kb.progressStart(Math.ceil(k.length/100));b(0,()=>{m||kb.progressEnd();h()})}),get:(f,k,m)=>new Promise((h,e)=>{(b=>{var a=(d,l,p)=>{kintone.api(kintone.api.url("/k/v1/records",!0),"GET",{app:f,
query:k+" order by "+b+" limit 500 offset "+l.toString()}).then(r=>{Array.prototype.push.apply(d,r.records);l+=500;500==r.records.length?a(d,l,p):p(d)}).catch(r=>e(r))};kintone.api(kintone.api.url("/k/v1/records",!0),"GET",{app:f,query:k,totalCount:!0}).then(d=>{1E4>parseInt(d.totalCount)?a([],0,l=>h(l)):kintone.api(kintone.api.url("/k/v1/records/cursor",!0),"POST",{app:f,query:k+" order by "+b,size:500}).then(l=>{(p=>{var r=(n,g)=>{kintone.api(kintone.api.url("/k/v1/records/cursor",!0),"GET",{id:p}).then(u=>
{Array.prototype.push.apply(n,u.records);u.next?r(n,g):g(n)}).catch(u=>e(u))};r([],n=>h(n))})(l.id)}).catch(l=>e(l))}).catch(d=>e(d))})(m||"$id asc")}),set:(f,k,m=!1,h=!1)=>new Promise((e,b)=>{var a=(l,p)=>{0!=k.post.length?kintone.api(kintone.api.url("/k/v1/records",!0),"POST",{app:f,records:(r=>{h&&(r=r.map(n=>this.records.transform(n,"POST")));return r})(k.post.slice(l,l+100))}).then(r=>{m||kb.progressUpdate();l+=100;0<k.post.slice(l,l+100).length?a(l,p):p(r.ids.last())}).catch(r=>b(r)):p()},d=
(l,p)=>{0!=k.put.length?kintone.api(kintone.api.url("/k/v1/records",!0),"PUT",{app:f,records:(r=>{h&&(r=r.map(n=>this.records.transform(n.record)));return r})(k.put.slice(l,l+100))}).then(r=>{m||kb.progressUpdate();l+=100;0<k.put.slice(l,l+100).length?d(l,p):p()}).catch(r=>b(r)):p()};"post"in k||(k.post=[]);"put"in k||(k.put=[]);m||kb.progressStart(Math.ceil(k.post.length/100)+Math.ceil(k.put.length/100));a(0,l=>{d(0,()=>{m||kb.progressEnd();e(l)})})}),transform:(f,k="PUT")=>{var m=null;switch(k){case "POST":m=
(()=>{var h={},e;for(e in f)kb.field.reserved.includes(f[e].type)||(h[e]=f[e]);return h})();break;case "PUT":m={id:f.$id.value,record:(()=>{var h={},e;for(e in f)kb.field.reserved.includes(f[e].type)||(h[e]=f[e]);return h})()}}return m}}}create(f,k,m,h){var e={key:()=>"view_"+k.id+"_"+m+"_"+location.host.split(".").first(),set:b=>{var a=e.key(),d="[view-id=view_"+k.id+"_"+m+"] .kb-guide{min-width:auto !important;}";kb.elm("[view-id=view_"+k.id+"_"+m+"]").elms(".kb-view-head-resizer").each((l,p)=>
{p=l.closest(".kb-view-head-cell");if(!p.hasClass("kb-unuse")){l=p.attr("column-id");var r=150;b||kb.elm(".kb_spread_style_"+CSS.escape(a))&&kb.elm(".kb_spread_style_"+CSS.escape(a)).text().match(new RegExp('\\[column-id="'+CSS.escape(l)+'"\\]',"g"))&&(r=p.outerWidth(!1));p=r;d+="[view-id=view_"+k.id+"_"+m+'] [column-id="'+CSS.escape(l)+'"]{max-width:'+p+"px;width:"+p+"px;}";d+="[view-id=view_"+k.id+"_"+m+'] [field-id="'+CSS.escape(l)+'"]{width:'+p+"px;}"}});kb.elm(".kb_spread_style_"+CSS.escape(a))&&
kb.elm("head").removeChild(kb.elm(".kb_spread_style_"+CSS.escape(a)));kb.elm("head").append(kb.create("style").addClass("kb_spread_style_"+a).attr("media","screen").attr("type","text/css").text(d));localStorage.setItem(a,d)}};return f.append(((b,a,d)=>{var l=0,p=(n=>{var g="";h||(g=(n?2:0)+d.buttons.length,g="kb-view-button_shave"+g.toString());return g})("viewer"==d.mode),r=(n,g)=>{var u=n.changedTouches?Array.from(n.changedTouches).first():n,c=n.currentTarget.closest(".kb-view-head-cell"),t=u.pageX,
q=n.currentTarget.closest(".kb-view-head-cell").outerWidth(!1),v={move:w=>{var x=!1,z=w.changedTouches?Array.from(w.changedTouches).first():w,y=q+z.pageX-t;c.css({maxWidth:y.toString()+"px",width:y.toString()+"px"});b.elms('[field-id="'+CSS.escape(g)+'"]').each((A,B)=>A.css({width:y.toString()+"px"}));b.elms('[field-id="'+CSS.escape(g)+'"]').each((A,B)=>{y<A.outerWidth(!1)&&(y=A.outerWidth(!1),x=!0)});x&&c.css({maxWidth:y.toString()+"px",width:y.toString()+"px"});w.stopPropagation();w.preventDefault()},
end:w=>{e.set();kb.elm("body").removeClass("kb-resizing");window.off("mousemove,touchmove",v.move);window.off("mouseup,touchend",v.end);w.stopPropagation();w.preventDefault()}};kb.elm("body").addClass("kb-resizing");window.on("mousemove,touchmove",v.move);window.on("mouseup,touchend",v.end);n.stopPropagation();n.preventDefault()};b.append(kb.create("thead").append(kb.create("tr").addClass("kb-view-head"))).append(kb.create("tbody").append(kb.create("tr").addClass("kb-view-row")));b.elm("thead tr").append(kb.create("th").addClass("kb-view-head-cell kb-view-button "+
p+" kb-view-guide"));b.elm("tbody tr").append(kb.create("td").addClass("kb-view-button "+p+" kb-view-guide").append(kb.create("a").addClass("kb-icon kb-icon-edit kb-view-row-edit"+(d.buttons.includes("detail")?" kb-unuse":""))).append(kb.create("button").addClass("kb-icon kb-icon-add kb-view-row-add"+(d.buttons.includes("add")||"viewer"==d.mode?" kb-unuse":""))).append(kb.create("button").addClass("kb-icon kb-icon-copy kb-view-row-copy"+(d.buttons.includes("clone")||"viewer"==d.mode?" kb-unuse":""))).append(kb.create("button").addClass("kb-icon kb-icon-del kb-view-row-del"+
(d.buttons.includes("delete")?" kb-unuse":""))));(n=>{n.concat(Object.keys(a.fields).filter(g=>!n.includes(g))).each((g,u)=>{((c,t)=>{switch(c.type){case "SUBTABLE":for(var q in c.fields)b.elm("thead tr").append(((v,w)=>{t||l++;return v.addClass("kb-view-head-cell"+(t?" kb-unuse":"")).attr("column-id",w.code).append(kb.create("span").addClass("kb-view-head-caption").html(w.label)).append(kb.create("span").addClass("kb-view-head-resizer").on("mousedown,touchstart",x=>r(x,w.code)))})(kb.create("th"),
c.fields[q])),c.fields[q].noLabel=!h;"viewer"!=d.mode&&(t||l++,b.elm("thead tr").append(kb.create("th").addClass("kb-view-head-cell kb-view-button kb-view-button-tables"+(t?" kb-unuse":""))));break;default:b.elm("thead tr").append((v=>{t||l++;return v.addClass("kb-view-head-cell"+(t?" kb-unuse":"")).attr("column-id",c.code).append(kb.create("span").addClass("kb-view-head-caption").html(c.label)).append(kb.create("span").addClass("kb-view-head-resizer").on("mousedown,touchstart",w=>r(w,c.code)))})(kb.create("th"))),
c.noLabel=!h}})(a.fields[g],0!=d.fields.length?!d.fields.includes(g):!1)});b.elm("tbody tr").append((g=>{n.concat(Object.keys(a.fields).filter(u=>!n.includes(u))).each((u,c)=>{c=a.fields[u];u=0!=d.fields.length?!d.fields.includes(u):!1;switch(c.type){case "SUBTABLE":g.append(kb.create("div").addClass("kb-view-row-cell"+(u?" kb-unuse":"")).append(kb.table.create(c,!0,!0,h,!0)));break;default:g.append(kb.field.create(c,!0).addClass("kb-view-row-cell"+(u?" kb-unuse":"")))}});return g.append(kb.create("input").attr("type",
"hidden").attr("data-type","id"))})(kb.create("td").addClass("kb-scope").attr("form-id","form_"+a.id).attr("colspan",l.toString())))})(0!=d.fields.length?d.fields:Object.keys(a.fields));"viewer"==d.mode?(b.elms(".kb-field").each((n,g)=>n.addClass("kb-readonly")),b.elms(".kb-table-button").each((n,g)=>n.addClass("kb-readonly"))):a.disables.each((n,g)=>{b.elm('[field-id="'+CSS.escape(n.code)+'"]')&&b.elm('[field-id="'+CSS.escape(n.code)+'"]').addClass("kb-readonly")});return b.spread((n,g)=>{n.elm("[form-id=form_"+
a.id+"]").on("change",u=>{n.addClass("kb-unsaved")});n.elm(".kb-view-row-add").on("click",u=>{(c=>{kb.event.call("kb.view.add",{container:c.elm("[form-id=form_"+a.id+"]"),record:kb.record.get(c.elm("[form-id=form_"+a.id+"]"),a,!0).record,viewId:m}).then(t=>{t.error?b.delRow(c):kb.event.call("kb.action.call",{container:c.elm("[form-id=form_"+a.id+"]"),record:t.record,mobile:h,pattern:"create",workplace:"view"}).then(q=>{kb.event.call("kb.style.call",{container:c.elm("[form-id=form_"+a.id+"]"),record:q.record,
mobile:q.mobile,pattern:q.pattern,workplace:q.workplace}).then(v=>{kb.record.set(c.elm("[form-id=form_"+a.id+"]").attr("unsaved","unsaved"),a,v.record).then(()=>{kb.event.call("kb.view.add.complete",{container:c.elm("[form-id=form_"+a.id+"]"),viewId:m})});(w=>{c.elm("[form-id=form_"+a.id+"]").dispatchEvent(w)})(new Event("change"))}).catch(()=>{})}).catch(()=>{})})})(b.insertRow(n))});n.elm(".kb-view-row-del").on("click",u=>{(c=>{c?kb.confirm(kb.constants.common.message.confirm.delete[kb.operator.language],
()=>{kb.event.call("kb.view.delete",{container:n.elm("[form-id=form_"+a.id+"]"),record:kb.record.get(n.elm("[form-id=form_"+a.id+"]"),a,!0).record,viewId:m}).then(t=>{t.error||kb.view.records.delete(a.id,[c]).then(q=>b.delRow(n)).catch(q=>kb.alert(kb.error.parse(q)))})}):b.delRow(n)})(n.elm("[data-type=id]").val())});n.elm(".kb-view-row-copy").on("click",u=>{kb.confirm(kb.constants.common.message.confirm.copy[kb.operator.language],()=>{((c,t)=>{var q=Object.values(kb.field.parallelize(a.fields)).reduce((v,
w)=>{"FILE"==w.type&&(w.tableCode?c[w.tableCode].value.each((x,z)=>{Array.prototype.push.apply(v,x.value[w.code].value)}):Array.prototype.push.apply(v,c[w.code].value));return v},[]);kb.file.clone(q).then(()=>{kb.event.call("kb.view.copy",{container:t.elm("[form-id=form_"+a.id+"]"),record:(v=>{v.$id.value="";return v})(c),viewId:m}).then(v=>{v.error?b.delRow(t):kb.event.call("kb.action.call",{container:t.elm("[form-id=form_"+a.id+"]"),record:v.record,mobile:h,pattern:"reuse",workplace:"view"}).then(w=>
{kb.event.call("kb.style.call",{container:t.elm("[form-id=form_"+a.id+"]"),record:w.record,mobile:w.mobile,pattern:"create",workplace:w.workplace}).then(x=>{kb.record.set(t.elm("[form-id=form_"+a.id+"]").attr("unsaved","unsaved"),a,x.record).then(()=>{t.elms(".kb-table").each((z,y)=>{z.tr.each((A,B)=>{A.hasAttribute("row-id")&&A.removeAttr("row-id")})});kb.event.call("kb.view.copy.complete",{container:t.elm("[form-id=form_"+a.id+"]"),viewId:m})});(z=>{t.elm("[form-id=form_"+a.id+"]").dispatchEvent(z)})(new Event("change"))}).catch(()=>
{})}).catch(()=>{})})})})(kb.record.get(n.elm("[form-id=form_"+a.id+"]"),a,!0).record,b.insertRow(n))})});n.elms(".kb-field").each((u,c)=>{u.closest(".kb-scope").hasAttribute("form-id")&&kb.field.activate(u,a)});n.elms(".kb-table").each((u,c)=>{kb.table.activate(u,a).clearRows();u.addRow()})},(n,g)=>{},!1)})(kb.create("table").addClass("kb-view").attr("view-id","view_"+k.id+"_"+m),kb.extend({},k),kb.extend({},k).view)).on("show",b=>{b=e.key();h||kb.elm(".kb_spread_style_"+CSS.escape(b))||(localStorage.getItem(b)?
(kb.elm("head").append(kb.create("style").addClass("kb_spread_style_"+b).attr("media","screen").attr("type","text/css").text(localStorage.getItem(b))),e.set()):0!=kb.elm("[view-id=view_"+k.id+"_"+m+"]").elm("tbody").elms("tr").length&&e.set(!0))})}load(f){return new Promise((k,m)=>{kintone.api(kintone.api.url("/k/v1/app/views",!0),"GET",{app:f}).then(h=>{(e=>{k({origin:e,calendar:e.filter(b=>"CALENDAR"==b.type),custom:e.filter(b=>"CUSTOM"==b.type),list:e.filter(b=>"LIST"==b.type)})})(Object.values(h.views).sort((e,
b)=>e.index-b.index))}).catch(h=>kb.alert(kb.error.parse(h)))})}};window.kb.attachment||(window.kb.attachment=new KintoneBoosterAttachment);window.kb.record||(window.kb.record=new KintoneBoosterRecord,window.kb.record.builder=new KintoneBoosterRecordBuilder);window.kb.button||(window.kb.button=new KintoneBoosterButton);window.kb.field||(window.kb.field=new KintoneBoosterField);window.kb.icon||(window.kb.icon=new KintoneBoosterIcon);window.kb.table||(window.kb.table=new KintoneBoosterTable);
window.kb.view||(window.kb.view=new KintoneBoosterView);
kb.constants=kb.extend({common:{caption:{button:{cancel:{en:"Cancel",ja:"\u30ad\u30e3\u30f3\u30bb\u30eb",zh:"\u53d6\u6d88"},submit:{en:"Submit",ja:"\u4fdd\u5b58",zh:"\u4fdd\u5b58"}},sort:{asc:{en:"asc",ja:"\u6607\u9806",zh:"\u5347\u5e8f"},desc:{en:"desc",ja:"\u964d\u9806",zh:"\u964d\u5e8f"}}},message:{confirm:{changed:{en:"Changes have not been saved.<br>Do you want to leave the page?",ja:"\u5909\u66f4\u304c\u4fdd\u5b58\u3055\u308c\u3066\u3044\u307e\u305b\u3093\u3002<br>\u3053\u306e\u307e\u307e\u30da\u30fc\u30b8\u3092\u79fb\u52d5\u3057\u307e\u3059\u304b\uff1f",zh:"\u66f4\u6539\u5c1a\u672a\u4fdd\u5b58\u3002<br>\u60a8\u662f\u5426\u8981\u79bb\u5f00\u6b64\u9875\u9762\uff1f"},
cancel:{en:"The edits you made will be lost. Are you sure?",ja:"\u7de8\u96c6\u3057\u305f\u5185\u5bb9\u304c\u5931\u308f\u308c\u307e\u3059\u304c\u3001\u3088\u308d\u3057\u3044\u3067\u3059\u304b\uff1f",zh:"\u60a8\u7f16\u8f91\u7684\u5185\u5bb9\u5c06\u4f1a\u4e22\u5931\uff0c\u786e\u5b9a\u5417\uff1f"},copy:{en:"Are you sure on copy?",ja:"\u30b3\u30d4\u30fc\u3057\u3066\u3082\u3088\u308d\u3057\u3044\u3067\u3059\u304b\uff1f",zh:"\u6211\u53ef\u4ee5\u590d\u5236\u5417\uff1f"},delete:{en:"Are you sure on delete?",
ja:"\u524a\u9664\u3057\u3066\u3082\u3088\u308d\u3057\u3044\u3067\u3059\u304b\uff1f",zh:"\u6211\u53ef\u4ee5\u5220\u9664\u5417\uff1f"},save:{en:"Are you sure on copy?",ja:"\u4fdd\u5b58\u3057\u3066\u3082\u3088\u308d\u3057\u3044\u3067\u3059\u304b\uff1f",zh:"\u6211\u53ef\u4ee5\u4fdd\u5b58\u5417\uff1f"},submit:{en:"Are you sure on submit?",ja:"\u9001\u4fe1\u3057\u3066\u3082\u3088\u308d\u3057\u3044\u3067\u3059\u304b\uff1f",zh:"\u6211\u53ef\u4ee5\u53d1\u9001\u5417\uff1f"}},invalid:{record:{en:"There is an error in the input data.",
ja:"\u5165\u529b\u5185\u5bb9\u306b\u8aa4\u308a\u304c\u3042\u308a\u307e\u3059\u3002",zh:"\u8f93\u5165\u5185\u5bb9\u6709\u8bef\u3002"},submit:{en:"No data to submit was found.",ja:"\u7de8\u96c6\u4e2d\u306e\u30c7\u30fc\u30bf\u304c\u3042\u308a\u307e\u305b\u3093\u3002",zh:"\u6b63\u5728\u7f16\u8f91\u7684\u6570\u636e\u4e0d\u5b58\u5728\u3002"}}}},picker:{caption:{name:{en:"Name",ja:"\u8868\u793a\u540d",zh:"\u663e\u793a\u540d\u79f0"},recordnumber:{en:"Record number",ja:"\u30ec\u30b3\u30fc\u30c9\u756a\u53f7",
zh:"\u8bb0\u5f55\u53f7"}}}},kb.constants);