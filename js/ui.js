/*
* FileName "ui.js"
* Version: 1.0.0
* Copyright (c) 2023 Pandafirm LLC
* Distributed under the terms of the GNU Lesser General Public License.
* https://opensource.org/licenses/LGPL-2.1
*/
'use strict';window.KintoneBoosterAttachment=class{constructor(){}show(d,l=!0){kb.file.download(d).then(p=>{try{var m=()=>{var e=kb.create("a").css({display:"none"}).attr("href",kb.field.objectUrl(p,d.contentType)).attr("target","_blank").attr("download",d.name);kb.elm("body").append(e);e.click();document.body.removeChild(e)};switch(d.contentType){case "application/javascript":fetch(new Request(kb.field.objectUrl(p,d.contentType))).then(e=>e.text()).then(e=>{var g=e.split("\n");kb.create("div").append((a=>{g.each((b,
f)=>a.append(kb.create("code").css({display:"block"}).text(b)));return a})(kb.create("pre"))).popup("full","full",l?[{src:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADwAAAA8CAYAAAFN++nkAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAA1FJREFUeNpiYKA66J8y8T8ynwmfJE6dQHYAjM9CtAlIihJIcjRAANHD71hdDxIA+RVdAbKf1wMFqeRXgACiqdcbQBiXPBMB/fVQTLxmoG3riRHDlXwWgIjCnHxGJOkPMHmYOCMx0QwDaIZRBgACaDgiYMDtxydPKJE4UKIZL8AVzwZA6jySkCEwji8QtBmoUQBIgbAhTCOIDxXHX4DgSl3Y5CjyMwspaRuvn6EJfwEOtQtIyhiEEsnAAYAAGkV0A4wUFDH/KSmPmYaEj4nJpcT6niQfQw01xCFtSEqQMxLwYT+QKsDmI6RyGV4eYwmRCUC5QpIsRjJEEaj5ARmJTwFI3ccV/CxEmHEfS2svEWjYArQG33yKi3ooCAQ1MXHIzQdaRqxFjtRI1aDgA5X+ClikQdHhSE60jAKaAoAAGkWjYBSgtF8pacOyUGC3AyUOH7Cmz8izmJGUxEREvB4AVouOtGhlvod2Y7GBD0BLBWnWoMdhOUmWEh3HoDYVrKkDteADNktBaogdcGMksZnTCLSkAcnnDEiWgsTriW0KMRKZkEDd8kQiQwcUMgmEEhwLgVKJ5LiDOjARKS04kFNkCkAb9h+gwXaBgG8NoNEjQK2yGmTQeWjD/gCozQ10xAekkaL1pJbduCz+gMfVIAve4x1LxjSLuOwEjdcNVCgZN+BKI4xEpFKi4w3JhwTTA6lFJqjL2o8rQQMtm0CPFgjesfhRMAoGDAAEaNdqbxCEgWhjGKAjMAKbyAg6ATM4gWECGQE2cBRGcAS5eI1VGvt110C8F/hDSNvX69217yqPQCAQbBnF69iuikbJevrh3ywshIUwrf82Md93E7QSjpXJR81NRelE4ixEi6alQOKsRMkI4+XCo/rU7wxAiBo9xFdEsU1X0XhY3sluk5VwhHo2q5c+dTHKm8Pi3fL2LotiP6DAAvHa09ddWQofNWHXvQ8YMMh6Y2iniStJ4wTARDWpuzWKtNTgkm6ZQ4FxnawUVhEOpv26kDFblp8jLFlblqypZ61itAgMFtTVqyVkP9C3J/UWwM3q0KoAYglDUeOW0Z/GaH4i5nEO/THneh7r0vNkgGhXYdt4YBWRKoiNmHeHPe60uh++any7595pCQQCgWDLeALGLWqyLWBxZQAAAABJRU5ErkJggg==",
handler:m}]:[]).show()});break;case "application/json":fetch(new Request(kb.field.objectUrl(p,d.contentType))).then(e=>e.text()).then(e=>{kb.create("div").html(e.replace(/\n/g,"<br>")).popup("full","full",l?[{src:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADwAAAA8CAYAAAFN++nkAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAA1FJREFUeNpiYKA66J8y8T8ynwmfJE6dQHYAjM9CtAlIihJIcjRAANHD71hdDxIA+RVdAbKf1wMFqeRXgACiqdcbQBiXPBMB/fVQTLxmoG3riRHDlXwWgIjCnHxGJOkPMHmYOCMx0QwDaIZRBgACaDgiYMDtxydPKJE4UKIZL8AVzwZA6jySkCEwji8QtBmoUQBIgbAhTCOIDxXHX4DgSl3Y5CjyMwspaRuvn6EJfwEOtQtIyhiEEsnAAYAAGkV0A4wUFDH/KSmPmYaEj4nJpcT6niQfQw01xCFtSEqQMxLwYT+QKsDmI6RyGV4eYwmRCUC5QpIsRjJEEaj5ARmJTwFI3ccV/CxEmHEfS2svEWjYArQG33yKi3ooCAQ1MXHIzQdaRqxFjtRI1aDgA5X+ClikQdHhSE60jAKaAoAAGkWjYBSgtF8pacOyUGC3AyUOH7Cmz8izmJGUxEREvB4AVouOtGhlvod2Y7GBD0BLBWnWoMdhOUmWEh3HoDYVrKkDteADNktBaogdcGMksZnTCLSkAcnnDEiWgsTriW0KMRKZkEDd8kQiQwcUMgmEEhwLgVKJ5LiDOjARKS04kFNkCkAb9h+gwXaBgG8NoNEjQK2yGmTQeWjD/gCozQ10xAekkaL1pJbduCz+gMfVIAve4x1LxjSLuOwEjdcNVCgZN+BKI4xEpFKi4w3JhwTTA6lFJqjL2o8rQQMtm0CPFgjesfhRMAoGDAAEaNdqbxCEgWhjGKAjMAKbyAg6ATM4gWECGQE2cBRGcAS5eI1VGvt110C8F/hDSNvX69217yqPQCAQbBnF69iuikbJevrh3ywshIUwrf82Md93E7QSjpXJR81NRelE4ixEi6alQOKsRMkI4+XCo/rU7wxAiBo9xFdEsU1X0XhY3sluk5VwhHo2q5c+dTHKm8Pi3fL2LotiP6DAAvHa09ddWQofNWHXvQ8YMMh6Y2iniStJ4wTARDWpuzWKtNTgkm6ZQ4FxnawUVhEOpv26kDFblp8jLFlblqypZ61itAgMFtTVqyVkP9C3J/UWwM3q0KoAYglDUeOW0Z/GaH4i5nEO/THneh7r0vNkgGhXYdt4YBWRKoiNmHeHPe60uh++any7595pCQQCgWDLeALGLWqyLWBxZQAAAABJRU5ErkJggg==",
handler:m}]:[]).show()});break;case "application/pdf":"other"!=kb.device()?window.open(kb.field.objectUrl(p,d.contentType)):kb.create("iframe").css({border:"none",height:"100%",outline:"none",width:"100%"}).attr("src",kb.field.objectUrl(p,d.contentType)+"#toolbar=0&navpanes=0").popup("full","full",l?[{src:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADwAAAA8CAYAAAFN++nkAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAA1FJREFUeNpiYKA66J8y8T8ynwmfJE6dQHYAjM9CtAlIihJIcjRAANHD71hdDxIA+RVdAbKf1wMFqeRXgACiqdcbQBiXPBMB/fVQTLxmoG3riRHDlXwWgIjCnHxGJOkPMHmYOCMx0QwDaIZRBgACaDgiYMDtxydPKJE4UKIZL8AVzwZA6jySkCEwji8QtBmoUQBIgbAhTCOIDxXHX4DgSl3Y5CjyMwspaRuvn6EJfwEOtQtIyhiEEsnAAYAAGkV0A4wUFDH/KSmPmYaEj4nJpcT6niQfQw01xCFtSEqQMxLwYT+QKsDmI6RyGV4eYwmRCUC5QpIsRjJEEaj5ARmJTwFI3ccV/CxEmHEfS2svEWjYArQG33yKi3ooCAQ1MXHIzQdaRqxFjtRI1aDgA5X+ClikQdHhSE60jAKaAoAAGkWjYBSgtF8pacOyUGC3AyUOH7Cmz8izmJGUxEREvB4AVouOtGhlvod2Y7GBD0BLBWnWoMdhOUmWEh3HoDYVrKkDteADNktBaogdcGMksZnTCLSkAcnnDEiWgsTriW0KMRKZkEDd8kQiQwcUMgmEEhwLgVKJ5LiDOjARKS04kFNkCkAb9h+gwXaBgG8NoNEjQK2yGmTQeWjD/gCozQ10xAekkaL1pJbduCz+gMfVIAve4x1LxjSLuOwEjdcNVCgZN+BKI4xEpFKi4w3JhwTTA6lFJqjL2o8rQQMtm0CPFgjesfhRMAoGDAAEaNdqbxCEgWhjGKAjMAKbyAg6ATM4gWECGQE2cBRGcAS5eI1VGvt110C8F/hDSNvX69217yqPQCAQbBnF69iuikbJevrh3ywshIUwrf82Md93E7QSjpXJR81NRelE4ixEi6alQOKsRMkI4+XCo/rU7wxAiBo9xFdEsU1X0XhY3sluk5VwhHo2q5c+dTHKm8Pi3fL2LotiP6DAAvHa09ddWQofNWHXvQ8YMMh6Y2iniStJ4wTARDWpuzWKtNTgkm6ZQ4FxnawUVhEOpv26kDFblp8jLFlblqypZ61itAgMFtTVqyVkP9C3J/UWwM3q0KoAYglDUeOW0Z/GaH4i5nEO/THneh7r0vNkgGhXYdt4YBWRKoiNmHeHPe60uh++any7595pCQQCgWDLeALGLWqyLWBxZQAAAABJRU5ErkJggg==",
handler:m}]:[]).show();break;case "audio/mpeg":case "audio/x-m4a":kb.create("audio").css({outline:"none"}).attr("controls","controls").attr("src",kb.field.objectUrl(p,d.contentType)).popup(null,null,l?[{src:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADwAAAA8CAYAAAFN++nkAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAA1FJREFUeNpiYKA66J8y8T8ynwmfJE6dQHYAjM9CtAlIihJIcjRAANHD71hdDxIA+RVdAbKf1wMFqeRXgACiqdcbQBiXPBMB/fVQTLxmoG3riRHDlXwWgIjCnHxGJOkPMHmYOCMx0QwDaIZRBgACaDgiYMDtxydPKJE4UKIZL8AVzwZA6jySkCEwji8QtBmoUQBIgbAhTCOIDxXHX4DgSl3Y5CjyMwspaRuvn6EJfwEOtQtIyhiEEsnAAYAAGkV0A4wUFDH/KSmPmYaEj4nJpcT6niQfQw01xCFtSEqQMxLwYT+QKsDmI6RyGV4eYwmRCUC5QpIsRjJEEaj5ARmJTwFI3ccV/CxEmHEfS2svEWjYArQG33yKi3ooCAQ1MXHIzQdaRqxFjtRI1aDgA5X+ClikQdHhSE60jAKaAoAAGkWjYBSgtF8pacOyUGC3AyUOH7Cmz8izmJGUxEREvB4AVouOtGhlvod2Y7GBD0BLBWnWoMdhOUmWEh3HoDYVrKkDteADNktBaogdcGMksZnTCLSkAcnnDEiWgsTriW0KMRKZkEDd8kQiQwcUMgmEEhwLgVKJ5LiDOjARKS04kFNkCkAb9h+gwXaBgG8NoNEjQK2yGmTQeWjD/gCozQ10xAekkaL1pJbduCz+gMfVIAve4x1LxjSLuOwEjdcNVCgZN+BKI4xEpFKi4w3JhwTTA6lFJqjL2o8rQQMtm0CPFgjesfhRMAoGDAAEaNdqbxCEgWhjGKAjMAKbyAg6ATM4gWECGQE2cBRGcAS5eI1VGvt110C8F/hDSNvX69217yqPQCAQbBnF69iuikbJevrh3ywshIUwrf82Md93E7QSjpXJR81NRelE4ixEi6alQOKsRMkI4+XCo/rU7wxAiBo9xFdEsU1X0XhY3sluk5VwhHo2q5c+dTHKm8Pi3fL2LotiP6DAAvHa09ddWQofNWHXvQ8YMMh6Y2iniStJ4wTARDWpuzWKtNTgkm6ZQ4FxnawUVhEOpv26kDFblp8jLFlblqypZ61itAgMFtTVqyVkP9C3J/UWwM3q0KoAYglDUeOW0Z/GaH4i5nEO/THneh7r0vNkgGhXYdt4YBWRKoiNmHeHPe60uh++any7595pCQQCgWDLeALGLWqyLWBxZQAAAABJRU5ErkJggg==",
handler:m}]:[]).show();break;case "image/bmp":case "image/gif":case "image/jpeg":case "image/png":kb.create("img").css({maxHeight:"calc(100vh - 4em)",maxWidth:"calc(100vw - 2em)"}).attr("src",kb.field.objectUrl(p,d.contentType)).popup(null,null,l?[{src:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADwAAAA8CAYAAAFN++nkAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAA1FJREFUeNpiYKA66J8y8T8ynwmfJE6dQHYAjM9CtAlIihJIcjRAANHD71hdDxIA+RVdAbKf1wMFqeRXgACiqdcbQBiXPBMB/fVQTLxmoG3riRHDlXwWgIjCnHxGJOkPMHmYOCMx0QwDaIZRBgACaDgiYMDtxydPKJE4UKIZL8AVzwZA6jySkCEwji8QtBmoUQBIgbAhTCOIDxXHX4DgSl3Y5CjyMwspaRuvn6EJfwEOtQtIyhiEEsnAAYAAGkV0A4wUFDH/KSmPmYaEj4nJpcT6niQfQw01xCFtSEqQMxLwYT+QKsDmI6RyGV4eYwmRCUC5QpIsRjJEEaj5ARmJTwFI3ccV/CxEmHEfS2svEWjYArQG33yKi3ooCAQ1MXHIzQdaRqxFjtRI1aDgA5X+ClikQdHhSE60jAKaAoAAGkWjYBSgtF8pacOyUGC3AyUOH7Cmz8izmJGUxEREvB4AVouOtGhlvod2Y7GBD0BLBWnWoMdhOUmWEh3HoDYVrKkDteADNktBaogdcGMksZnTCLSkAcnnDEiWgsTriW0KMRKZkEDd8kQiQwcUMgmEEhwLgVKJ5LiDOjARKS04kFNkCkAb9h+gwXaBgG8NoNEjQK2yGmTQeWjD/gCozQ10xAekkaL1pJbduCz+gMfVIAve4x1LxjSLuOwEjdcNVCgZN+BKI4xEpFKi4w3JhwTTA6lFJqjL2o8rQQMtm0CPFgjesfhRMAoGDAAEaNdqbxCEgWhjGKAjMAKbyAg6ATM4gWECGQE2cBRGcAS5eI1VGvt110C8F/hDSNvX69217yqPQCAQbBnF69iuikbJevrh3ywshIUwrf82Md93E7QSjpXJR81NRelE4ixEi6alQOKsRMkI4+XCo/rU7wxAiBo9xFdEsU1X0XhY3sluk5VwhHo2q5c+dTHKm8Pi3fL2LotiP6DAAvHa09ddWQofNWHXvQ8YMMh6Y2iniStJ4wTARDWpuzWKtNTgkm6ZQ4FxnawUVhEOpv26kDFblp8jLFlblqypZ61itAgMFtTVqyVkP9C3J/UWwM3q0KoAYglDUeOW0Z/GaH4i5nEO/THneh7r0vNkgGhXYdt4YBWRKoiNmHeHPe60uh++any7595pCQQCgWDLeALGLWqyLWBxZQAAAABJRU5ErkJggg==",
handler:m}]:[]).show();break;case "text/plain":case "text/css":fetch(new Request(kb.field.objectUrl(p,d.contentType))).then(e=>e.text()).then(e=>{kb.create("div").html(e.replace(/\n/g,"<br>")).popup("full","full",l?[{src:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADwAAAA8CAYAAAFN++nkAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAA1FJREFUeNpiYKA66J8y8T8ynwmfJE6dQHYAjM9CtAlIihJIcjRAANHD71hdDxIA+RVdAbKf1wMFqeRXgACiqdcbQBiXPBMB/fVQTLxmoG3riRHDlXwWgIjCnHxGJOkPMHmYOCMx0QwDaIZRBgACaDgiYMDtxydPKJE4UKIZL8AVzwZA6jySkCEwji8QtBmoUQBIgbAhTCOIDxXHX4DgSl3Y5CjyMwspaRuvn6EJfwEOtQtIyhiEEsnAAYAAGkV0A4wUFDH/KSmPmYaEj4nJpcT6niQfQw01xCFtSEqQMxLwYT+QKsDmI6RyGV4eYwmRCUC5QpIsRjJEEaj5ARmJTwFI3ccV/CxEmHEfS2svEWjYArQG33yKi3ooCAQ1MXHIzQdaRqxFjtRI1aDgA5X+ClikQdHhSE60jAKaAoAAGkWjYBSgtF8pacOyUGC3AyUOH7Cmz8izmJGUxEREvB4AVouOtGhlvod2Y7GBD0BLBWnWoMdhOUmWEh3HoDYVrKkDteADNktBaogdcGMksZnTCLSkAcnnDEiWgsTriW0KMRKZkEDd8kQiQwcUMgmEEhwLgVKJ5LiDOjARKS04kFNkCkAb9h+gwXaBgG8NoNEjQK2yGmTQeWjD/gCozQ10xAekkaL1pJbduCz+gMfVIAve4x1LxjSLuOwEjdcNVCgZN+BKI4xEpFKi4w3JhwTTA6lFJqjL2o8rQQMtm0CPFgjesfhRMAoGDAAEaNdqbxCEgWhjGKAjMAKbyAg6ATM4gWECGQE2cBRGcAS5eI1VGvt110C8F/hDSNvX69217yqPQCAQbBnF69iuikbJevrh3ywshIUwrf82Md93E7QSjpXJR81NRelE4ixEi6alQOKsRMkI4+XCo/rU7wxAiBo9xFdEsU1X0XhY3sluk5VwhHo2q5c+dTHKm8Pi3fL2LotiP6DAAvHa09ddWQofNWHXvQ8YMMh6Y2iniStJ4wTARDWpuzWKtNTgkm6ZQ4FxnawUVhEOpv26kDFblp8jLFlblqypZ61itAgMFtTVqyVkP9C3J/UWwM3q0KoAYglDUeOW0Z/GaH4i5nEO/THneh7r0vNkgGhXYdt4YBWRKoiNmHeHPe60uh++any7595pCQQCgWDLeALGLWqyLWBxZQAAAABJRU5ErkJggg==",
handler:m}]:[]).show()});break;case "text/csv":fetch(new Request(kb.field.objectUrl(p,d.contentType))).then(e=>e.text()).then(e=>{var g=e.parseCSV();0!=g.length&&(a=>{g.each((b,f)=>{a.append((q=>{b.each((u,k)=>q.append(kb.create("td").css({padding:"0.25em"}).html(u.replace(/\n/g,"<br>"))));return q})(kb.create("tr")))});return a})(kb.create("table")).popup(null,"full",l?[{src:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADwAAAA8CAYAAAFN++nkAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAA1FJREFUeNpiYKA66J8y8T8ynwmfJE6dQHYAjM9CtAlIihJIcjRAANHD71hdDxIA+RVdAbKf1wMFqeRXgACiqdcbQBiXPBMB/fVQTLxmoG3riRHDlXwWgIjCnHxGJOkPMHmYOCMx0QwDaIZRBgACaDgiYMDtxydPKJE4UKIZL8AVzwZA6jySkCEwji8QtBmoUQBIgbAhTCOIDxXHX4DgSl3Y5CjyMwspaRuvn6EJfwEOtQtIyhiEEsnAAYAAGkV0A4wUFDH/KSmPmYaEj4nJpcT6niQfQw01xCFtSEqQMxLwYT+QKsDmI6RyGV4eYwmRCUC5QpIsRjJEEaj5ARmJTwFI3ccV/CxEmHEfS2svEWjYArQG33yKi3ooCAQ1MXHIzQdaRqxFjtRI1aDgA5X+ClikQdHhSE60jAKaAoAAGkWjYBSgtF8pacOyUGC3AyUOH7Cmz8izmJGUxEREvB4AVouOtGhlvod2Y7GBD0BLBWnWoMdhOUmWEh3HoDYVrKkDteADNktBaogdcGMksZnTCLSkAcnnDEiWgsTriW0KMRKZkEDd8kQiQwcUMgmEEhwLgVKJ5LiDOjARKS04kFNkCkAb9h+gwXaBgG8NoNEjQK2yGmTQeWjD/gCozQ10xAekkaL1pJbduCz+gMfVIAve4x1LxjSLuOwEjdcNVCgZN+BKI4xEpFKi4w3JhwTTA6lFJqjL2o8rQQMtm0CPFgjesfhRMAoGDAAEaNdqbxCEgWhjGKAjMAKbyAg6ATM4gWECGQE2cBRGcAS5eI1VGvt110C8F/hDSNvX69217yqPQCAQbBnF69iuikbJevrh3ywshIUwrf82Md93E7QSjpXJR81NRelE4ixEi6alQOKsRMkI4+XCo/rU7wxAiBo9xFdEsU1X0XhY3sluk5VwhHo2q5c+dTHKm8Pi3fL2LotiP6DAAvHa09ddWQofNWHXvQ8YMMh6Y2iniStJ4wTARDWpuzWKtNTgkm6ZQ4FxnawUVhEOpv26kDFblp8jLFlblqypZ61itAgMFtTVqyVkP9C3J/UWwM3q0KoAYglDUeOW0Z/GaH4i5nEO/THneh7r0vNkgGhXYdt4YBWRKoiNmHeHPe60uh++any7595pCQQCgWDLeALGLWqyLWBxZQAAAABJRU5ErkJggg==",
handler:m}]:[]).show()});break;case "video/mp4":case "video/mpeg":kb.create("video").css({maxHeight:"calc(100vh - 4em)",maxWidth:"calc(100vw - 2em)",outline:"none"}).attr("controls","controls").attr("src",kb.field.objectUrl(p,d.contentType)).popup(null,null,l?[{src:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADwAAAA8CAYAAAFN++nkAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAA1FJREFUeNpiYKA66J8y8T8ynwmfJE6dQHYAjM9CtAlIihJIcjRAANHD71hdDxIA+RVdAbKf1wMFqeRXgACiqdcbQBiXPBMB/fVQTLxmoG3riRHDlXwWgIjCnHxGJOkPMHmYOCMx0QwDaIZRBgACaDgiYMDtxydPKJE4UKIZL8AVzwZA6jySkCEwji8QtBmoUQBIgbAhTCOIDxXHX4DgSl3Y5CjyMwspaRuvn6EJfwEOtQtIyhiEEsnAAYAAGkV0A4wUFDH/KSmPmYaEj4nJpcT6niQfQw01xCFtSEqQMxLwYT+QKsDmI6RyGV4eYwmRCUC5QpIsRjJEEaj5ARmJTwFI3ccV/CxEmHEfS2svEWjYArQG33yKi3ooCAQ1MXHIzQdaRqxFjtRI1aDgA5X+ClikQdHhSE60jAKaAoAAGkWjYBSgtF8pacOyUGC3AyUOH7Cmz8izmJGUxEREvB4AVouOtGhlvod2Y7GBD0BLBWnWoMdhOUmWEh3HoDYVrKkDteADNktBaogdcGMksZnTCLSkAcnnDEiWgsTriW0KMRKZkEDd8kQiQwcUMgmEEhwLgVKJ5LiDOjARKS04kFNkCkAb9h+gwXaBgG8NoNEjQK2yGmTQeWjD/gCozQ10xAekkaL1pJbduCz+gMfVIAve4x1LxjSLuOwEjdcNVCgZN+BKI4xEpFKi4w3JhwTTA6lFJqjL2o8rQQMtm0CPFgjesfhRMAoGDAAEaNdqbxCEgWhjGKAjMAKbyAg6ATM4gWECGQE2cBRGcAS5eI1VGvt110C8F/hDSNvX69217yqPQCAQbBnF69iuikbJevrh3ywshIUwrf82Md93E7QSjpXJR81NRelE4ixEi6alQOKsRMkI4+XCo/rU7wxAiBo9xFdEsU1X0XhY3sluk5VwhHo2q5c+dTHKm8Pi3fL2LotiP6DAAvHa09ddWQofNWHXvQ8YMMh6Y2iniStJ4wTARDWpuzWKtNTgkm6ZQ4FxnawUVhEOpv26kDFblp8jLFlblqypZ61itAgMFtTVqyVkP9C3J/UWwM3q0KoAYglDUeOW0Z/GaH4i5nEO/THneh7r0vNkgGhXYdt4YBWRKoiNmHeHPe60uh++any7595pCQQCgWDLeALGLWqyLWBxZQAAAABJRU5ErkJggg==",
handler:m}]:[]).show();break;default:m()}}catch(e){kb.alert(kb.error.parse(e))}}).catch(p=>kb.alert(kb.error.parse(p)))}};
window.KintoneBoosterButton=class{constructor(){}create(d,l,p,m,e,g){(a=>{a&&a.parentNode.removeChild(a)})(kb.elm("#"+p));switch(l){case "detail":(d?kintone.mobile.app.getHeaderSpaceElement():kintone.app.record.getHeaderMenuSpaceElement().css({padding:"0 0.75em 0 1em"})).append(kb.create("button").addClass("kb-action-button kb-page-detail "+(d?" kb-mobile":"")).attr("id",p).html(m).on("click",a=>{kb.confirm(e,()=>g())}));break;case "index":(d?kintone.mobile.app.getHeaderSpaceElement():kintone.app.getHeaderMenuSpaceElement()).append(kb.create("button").addClass("kb-action-button kb-page-index "+
(d?" kb-mobile":"")).attr("id",p).html(m).on("click",a=>{kb.confirm(e,()=>g())}))}}};
window.KintoneBoosterField=class{constructor(){this.cache={};this.reserved="CATEGORY CREATED_TIME CREATOR GROUP HR LABEL MODIFIER RECORD_NUMBER REFERENCE_TABLE SPACER STATUS STATUS_ASSIGNEE UPDATED_TIME __ID__ __REVISION__".split(" ")}activate(d,l,p=!0){var m=kb.field.parallelize(l.fields),e=()=>kb.create("div").css({zIndex:kb.popups.alert.cover.style.zIndex-4}).append(kb.create("img").attr("src","data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAB4AAAAeCAYAAAA7MK6iAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAyJpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuMy1jMDExIDY2LjE0NTY2MSwgMjAxMi8wMi8wNi0xNDo1NjoyNyAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvIiB4bWxuczp4bXBNTT0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL21tLyIgeG1sbnM6c3RSZWY9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZVJlZiMiIHhtcDpDcmVhdG9yVG9vbD0iQWRvYmUgUGhvdG9zaG9wIENTNiAoV2luZG93cykiIHhtcE1NOkluc3RhbmNlSUQ9InhtcC5paWQ6QkVGNzA3QTE1RTc4MTFFOEI5MDA5RUE2NDFCQTUzNDciIHhtcE1NOkRvY3VtZW50SUQ9InhtcC5kaWQ6QkVGNzA3QTI1RTc4MTFFOEI5MDA5RUE2NDFCQTUzNDciPiA8eG1wTU06RGVyaXZlZEZyb20gc3RSZWY6aW5zdGFuY2VJRD0ieG1wLmlpZDpCRUY3MDc5RjVFNzgxMUU4QjkwMDlFQTY0MUJBNTM0NyIgc3RSZWY6ZG9jdW1lbnRJRD0ieG1wLmRpZDpCRUY3MDdBMDVFNzgxMUU4QjkwMDlFQTY0MUJBNTM0NyIvPiA8L3JkZjpEZXNjcmlwdGlvbj4gPC9yZGY6UkRGPiA8L3g6eG1wbWV0YT4gPD94cGFja2V0IGVuZD0iciI/PkBlNTAAAADNSURBVHja7NHBCcJAFATQZNBcYwmSmycPlpI2bCVgAVqAVmAFHmxqncAKQVyz+/N/grADc0iyy0Be6ZwrlgiKhZKH83Ae/v/h1X23l9499vfZk2hYOHpgO7ZkH+xzjl9dsze2Ytfsld3MMXxhm8Hzlj1bD/eu7Zf3rf9mMvx2DaXzZ1SHh66hVP5MrTn86RpK48+qDIdcQ4nyxkRXsTcmuoq9oeAq8oaSa7I3FF2TvKHomuQNZddobxi4RnnDyHXUG0auo94wdP3p/RJgAMw4In5GE/6/AAAAAElFTkSuQmCC")).append(kb.create("span")),g=
a=>{((b,f)=>{d.elm(".kb-field-alert")?d.elm(".kb-field-alert").hide():d.elms("input,select,textarea").each((q,u)=>{q.alert&&q.alert.hide()});kb.event.call(a,{container:f,record:kb.record.get(b,l,!0).record}).then(q=>{q.error||(p?kb.event.call("kb.action.call",{container:b,record:q.record,mobile:location.href.match(/\/m\//g)?!0:!1,pattern:"change",field:(u=>{var k=u.code;u.lookup&&(k=u.lookup.fieldMappings.reduce((h,r)=>{h.index<kb.field.cache[l.id].layout.indexOf(r.field)&&(h={index:kb.field.cache[l.id].layout.indexOf(r.field),
field:r.field});return h},{index:-1,field:null}),k=k.field||u.code);return k})(m[d.attr("field-id")]),workplace:b.closest(".kb-view")?"view":"record"}).then(u=>{kb.event.call("kb.style.call",{container:b,record:u.record,mobile:u.mobile,pattern:"$id"in u.record?u.record.$id.value?"edit":"create":"create",workplace:u.workplace}).then(k=>{kb.event.call("kb.cascade.call",k).then(h=>{kb.record.set(b,l,h.record);h=new Event("change");b.attr("unsaved","unsaved").dispatchEvent(h)}).catch(()=>{})}).catch(()=>
{})}):(kb.record.set(b,l,q.record),(u=>{b.attr("unsaved","unsaved").dispatchEvent(u)})(new Event("change"))))})})(d.closest("[form-id=form_"+l.id+"]"),d.closest(".kb-scope"))};d.attr("field-id")&&((a,b)=>{if(b.lookup)(f=>{a.elm(".kb-search").on("click",q=>{f(a.elm(".kb-lookup-search").val(),kb.extend({},b))});a.elm(".kb-open").on("click",q=>{((u,k)=>{a.elm(".kb-lookup-search").val()?kb.view.records.get(k,kb.filter.query.create({code:b.lookup.relatedKeyField},"=",{type:b.type,value:a.elm(".kb-lookup-search").val()})).then(h=>
{0!=h.length&&window.open(kb.record.page.detail(u,k,h.first().$id.value))}).catch(h=>kb.alert(kb.error.parse(h))):window.open(kb.record.page.add(u,k))})(location.href.match(/\/m\//g)?!0:!1,b.lookup.relatedApp.app)});a.elm(".kb-clear").on("click",q=>{kb.confirm(kb.constants.common.message.confirm.delete[kb.operator.language],()=>{a.lookup("").then(()=>g("kb.change."+b.code))})});a.elm("input").on("change",q=>{f(q.currentTarget.val(),kb.extend({},b))})})((f,q)=>{this.load(q.lookup.relatedApp.app).then(u=>
{(k=>{var h=()=>{q.picker=(r=>{var c={};r.each((v,n)=>{v in k.external&&(c[v]=kb.extend({},k.external[v]))});0==Object.keys(c).length&&(c.$id={code:"$id",type:"RECORD_NUMBER",label:kb.constants.picker.caption.recordnumber[kb.operator.language],required:!1,noLabel:!1});return c})(q.lookup.lookupPickerFields);a.recordPicker.show({app:q.lookup.relatedApp.app,query:q.query,sort:q.lookup.sort||"$id asc",picker:q.picker},r=>a.lookup(r.$id.value).then(()=>g("kb.change."+q.code)))};f?(q.query=[q.lookup.filterCond,
q.lookup.relatedKeyField+(["LINK","SINGLE_LINE_TEXT"].includes(q.type)?" like ":"=")+'"'+f+'"'].filter(r=>r).join(" and "),kintone.api(kintone.api.url("/k/v1/records",!0),"GET",{app:q.lookup.relatedApp.app,query:q.query}).then(r=>{1==r.records.length?a.lookup(r.records.first().$id.value).then(()=>g("kb.change."+q.code)):h()}).catch(r=>kb.alert(kb.error.parse(r)))):(q.query=q.lookup.filterCond,h())})({external:u.parallelize,internal:m})})}),a.recordPicker=new KintoneBoosterRecordPicker("record"),a.lookup=
(f,q)=>new Promise((u,k)=>{(h=>{var r=()=>{kb.record.set(h,b.tableCode?l.fields[b.tableCode]:l,(()=>b.lookup.fieldMappings.reduce((c,v)=>{if(v.field in m)switch(m[v.field].type){case "CHECK_BOX":case "FILE":case "GROUP_SELECT":case "MULTI_SELECT":case "ORGANIZATION_SELECT":case "USER_SELECT":c[v.field]={value:[]};break;default:c[v.field]={value:""}}return c},(c=>{c[b.code]={value:""};return c})({})))(),!1).then(()=>u())};f?kintone.api(kintone.api.url("/k/v1/record",!0),"GET",{app:b.lookup.relatedApp.app,
id:f}).then(c=>{c.record?kb.record.set(h,b.tableCode?l.fields[b.tableCode]:l,(()=>b.lookup.fieldMappings.reduce((v,n)=>{n.relatedField in c.record&&n.field in m&&(v[n.field]={value:c.record[n.relatedField].value});return v},(v=>{v[b.code]={value:c.record[b.lookup.relatedKeyField].value};return v})({})))(),!1).then(()=>u()):r()}).catch(c=>kb.alert(kb.error.parse(c))):q?kintone.api(kintone.api.url("/k/v1/records",!0),"GET",{app:b.lookup.relatedApp.app,query:b.lookup.relatedKeyField+'="'+q+'"'}).then(c=>
{1==c.records.length?(v=>{kb.record.set(h,b.tableCode?l.fields[b.tableCode]:l,(()=>b.lookup.fieldMappings.reduce((n,t)=>{t.relatedField in v&&t.field in m&&(n[t.field]={value:v[t.relatedField].value});return n},(n=>{n[b.code]={value:v[b.lookup.relatedKeyField].value};return n})({})))(),!1).then(()=>u())})(c.records.first()):r()}).catch(c=>kb.alert(kb.error.parse(c))):r()})(a.closest(".kb-scope"))});else switch(b.type){case "CHECK_BOX":case "MULTI_SELECT":b.required&&(a.alert=f=>{a.elm(".kb-field-alert")||
a.append(e().addClass("kb-field-alert"));a.elm(".kb-field-alert").elm("span").html(f).parentNode.show()});break;case "COLOR":a.elm(".kb-search").on("click",f=>{kb.pickupColor(q=>{a.css({backgroundColor:q}).elm("input").val(q);g("kb.change."+b.code)})});a.elm("input").on("change",f=>{f.currentTarget.val()?(f=f.currentTarget.val().replace(/#/g,""),f.match(/([0-9A-Fa-f]{3}|[0-9A-Fa-f]{6})$/g)&&(a.css({backgroundColor:"#"+f}).elm("input").val("#"+f),g("kb.change."+b.code))):(a.css({backgroundColor:"transparent"}),
g("kb.change."+b.code))});break;case "CONDITION":a.elm(".kb-search").on("click",f=>{kb.filter.build(b.app,a.elm("input").val(),q=>{a.elm("input").val(q);g("kb.change."+b.code)})});a.reset=f=>{b.app=f;a.elm("input").val("");a.elm(".kb-guide").empty()};a.guide=f=>{a.elm(".kb-guide").append((q=>{q.append(kb.create("button").addClass("kb-icon kb-icon-del kb-guide-item-icon").on("click",u=>{kb.confirm(kb.constants.common.message.confirm.delete[kb.operator.language],()=>{a.elm("input").val(a.elm("input").val().split(" and ").filter(k=>
k!=f).join(" and "));g("kb.change."+b.code)})})).append(kb.create("span").addClass("kb-guide-item-label").html(f));return q})(kb.create("span").addClass("kb-guide-item")))};b.required&&(a.alert=f=>{a.elm(".kb-field-alert")||a.append(e().addClass("kb-field-alert"));a.elm(".kb-field-alert").elm("span").html(f).parentNode.show()});break;case "DATE":a.elm(".kb-search").on("click",f=>{kb.pickupDate(a.elm("input").val(),q=>{a.elm("input").val(q);g("kb.change."+b.code)})});break;case "DATETIME":a.elm(".kb-search").on("click",
f=>{kb.pickupDate(a.elm("input").val(),q=>{a.elm("input").val(q);g("kb.change."+b.code)})});break;case "FILE":a.elm(".kb-search").on("click",f=>{(q=>{kb.elm("body").append(q.on("change",u=>{u.currentTarget.files?(k=>{kb.file.upload(Array.from(u.currentTarget.files).first()).then(h=>{a.elm("input").val(JSON.stringify((a.elm("input").val()?JSON.parse(a.elm("input").val()):[]).concat(h)));g("kb.change."+b.code)}).catch(h=>kb.alert(kb.error.parse(h))).finally(()=>document.body.removeChild(q))})(Array.from(u.currentTarget.files).first()):
document.body.removeChild(q)}));q.click()})(kb.create("input").attr("type","file").css({display:"none"}))});a.guide=f=>{a.elm(".kb-guide").append((q=>{q.append(kb.create("button").addClass("kb-icon kb-icon-del kb-guide-item-icon").on("click",u=>{kb.confirm(kb.constants.common.message.confirm.delete[kb.operator.language],()=>{a.elm("input").val(JSON.stringify(JSON.parse(a.elm("input").val()).filter(k=>k.fileKey!=f.fileKey)));g("kb.change."+b.code)})})).append(kb.create("span").addClass("kb-guide-item-label").html(f.name).on("click",
u=>a.open(f)));return q})(kb.create("span").addClass("kb-guide-item")))};a.open=f=>{kb.event.call("kb.attachment.call",{mode:"download",downloadable:!0}).then(q=>kb.attachment.show(f,q.downloadable)).catch(()=>{})};b.required&&(a.alert=f=>{a.elm(".kb-field-alert")||a.append(e().addClass("kb-field-alert"));a.elm(".kb-field-alert").elm("span").html(f).parentNode.show()});break;case "GROUP_SELECT":case "ORGANIZATION_SELECT":case "USER_SELECT":(f=>{a.elm(".kb-search").on("click",q=>{a.recordPicker.show({picker:{name:{code:"name",
type:"SINGLE_LINE_TEXT",label:kb.constants.picker.caption.name[kb.operator.language],required:!1,noLabel:!0}}},u=>{(k=>{(h=>{u.each((r,c)=>{h.includes(r.code.value)||k.push({code:r.code.value,name:r.name.value})})})(k.map(h=>h.code));a.elm("input").val(JSON.stringify(k));g("kb.change."+b.code)})(a.elm("input").val()?JSON.parse(a.elm("input").val()):[])})});a.recordPicker=new KintoneBoosterRecordPicker(f,!0,(()=>{var q=[];b.loginuser&&q.push({code:{value:"LOGINUSER()"},name:{value:"Login user"}});
b.guestuser&&q.push({code:{value:"GUESTUSER()"},name:{value:"Guest user"}});return q})());a.guide=q=>{a.elm(".kb-guide").append((u=>{u.append(kb.create("button").addClass("kb-icon kb-icon-del kb-guide-item-icon").on("click",k=>{kb.confirm(kb.constants.common.message.confirm.delete[kb.operator.language],()=>{a.elm("input").val(JSON.stringify(JSON.parse(a.elm("input").val()).filter(h=>h.code!=q.code)));g("kb.change."+b.code)})})).append(kb.create("span").addClass("kb-guide-item-label").html(q.name));
return u})(kb.create("span").addClass("kb-guide-item")))};b.required&&(a.alert=q=>{a.elm(".kb-field-alert")||a.append(e().addClass("kb-field-alert"));a.elm(".kb-field-alert").elm("span").html(q).parentNode.show()})})((()=>{var f="";switch(b.type){case "GROUP_SELECT":f="group";break;case "ORGANIZATION_SELECT":f="organization";break;case "USER_SELECT":f="user"}return f})());case "NUMBER":(f=>{a.on("show",q=>f());f()})(()=>{a.elm(".kb-unit")?a.elm("input").css({width:"calc(100% - "+a.elm(".kb-unit").outerWidth(!0)+
"px)"}):a.elm("input").css({width:null})});break;case "RADIO_BUTTON":a.elms("[data-name="+b.code+"]").each((f,q)=>{f.closest("label").on("click",u=>{(k=>{a.elms("[data-name="+b.code+"]").each((h,r)=>h.checked=k==h.val());g("kb.change."+b.code)})(f.val());u.stopPropagation();u.preventDefault()})});break;case "TIME":a.elm(".kb-hour").elm("select").on("change",f=>{f.currentTarget.val()||a.elm(".kb-minute").elm("select").val("");g("kb.change."+b.code)}),a.elm(".kb-minute").elm("select").on("change",f=>
{f.currentTarget.val()||a.elm(".kb-hour").elm("select").val("");g("kb.change."+b.code)})}a.elms("input,select,textarea").each((f,q)=>{switch(b.type){case "COLOR":case "CONDITION":case "FILE":case "GROUP_SELECT":case "ORGANIZATION_SELECT":case "RADIO_BUTTON":case "TIME":case "USER_SELECT":break;default:f.on("change",u=>g("kb.change."+b.code))}})})(d.elm(".kb-field-value"),m[d.attr("field-id")]);return d}blobToBase64(d,l){var p=new FileReader;p.onload=()=>{l(p.result.replace(/^data:.+;base64,/,""))};
p.readAsDataURL(d)}create(d,l=!1){var p=m=>{m.append(kb.create("div").addClass("kb-dropdown kb-hour").append(kb.create("select").assignOption((()=>{var e=[{value:""}];(24).each(g=>e.push({value:g.toString().lpad("0",2)}));return e})(),"value","value"))).append(kb.create("div").addClass("kb-dropdown kb-minute").append(kb.create("select").assignOption((()=>{var e=[{value:""}];(60).each(g=>e.push({value:g.toString().lpad("0",2)}));return e})(),"value","value")))};if(!("type"in d))throw Error("You shoud setup [type] in field information");
return(m=>{m.append(kb.create("span").addClass("kb-field-caption").html(d.label));d.noLabel&&m.elm(".kb-field-caption").addClass("kb-hidden");m.append((e=>{switch(d.type){case "CALC":switch(d.format){case "NUMBER":case "NUMBER_DIGIT":e.addClass("kb-number")}break;case "CHECK_BOX":case "MULTI_SELECT":(a=>{a.reduce((b,f)=>{b[f.index]=f;return b},Array(a.length).fill("")).each((b,f)=>{e.addClass("kb-checkbox").append(kb.create("label").append(kb.create("input").attr("type","checkbox").val(b.label)).append(kb.create("span").html(b.label)))})})(Object.values(d.options));
break;case "COLOR":e.addClass("kb-color").append(kb.create("input").attr("type","text").attr("data-type","color")).append(kb.create("button").addClass("kb-icon kb-icon-color kb-search"));break;case "CONDITION":e.addClass("kb-condition").append(kb.create("input").attr("type","hidden")).append(kb.create("button").addClass("kb-icon kb-icon-filter kb-search"));break;case "CREATOR":case "CREATED_TIME":case "MODIFIER":case "UPDATED_TIME":e.append(kb.create("input").attr("type","hidden").attr("data-type",
d.type.toLowerCase()));break;case "DATE":e.addClass("kb-date").append(kb.create("input").attr("type","text").attr("data-type","date")).append(kb.create("button").addClass("kb-icon kb-icon-date kb-search"));break;case "DATETIME":p(e.addClass("kb-datetime").append(kb.create("input").attr("type","text").attr("data-type","date")).append(kb.create("button").addClass("kb-icon kb-icon-date kb-search")));break;case "DROP_DOWN":(a=>{l?e.addClass("kb-dropdown").append(kb.create("select").assignOption([{label:""}].concat(a.reduce((b,
f)=>{f.label&&(b[f.index]=f);return b},Array(a.length).fill(""))),"label","label")):e.addClass("kb-dropdown").append(kb.create("select").assignOption(a.reduce((b,f)=>{b[f.index]=f;return b},Array(a.length).fill("")),"label","label"))})(Object.values(d.options));break;case "FILE":e.addClass("kb-file").append(kb.create("input").attr("type","hidden")).append(kb.create("button").addClass("kb-icon kb-icon-file kb-search"));break;case "GROUP_SELECT":e.addClass("kb-group").append(kb.create("input").attr("type",
"hidden")).append(kb.create("button").addClass("kb-icon kb-icon-group kb-search"));break;case "LINK":var g="";switch(d.protocol){case "WEB":g="url";break;case "CALL":g="tel";break;case "MAIL":g="mail"}d.lookup?e.addClass("kb-lookup").append(kb.create("input").addClass("kb-lookup-search").attr("type","text").attr("data-type",g)).append(kb.create("button").addClass("kb-icon kb-icon-lookup kb-search")).append(kb.create("button").addClass("kb-icon kb-icon-open kb-open")).append(kb.create("button").addClass("kb-icon kb-icon-del kb-clear")):
e.addClass("kb-text").append(kb.create("input").attr("type","text").attr("data-type",g));break;case "MULTI_LINE_TEXT":case "RICH_TEXT":e.addClass("kb-textarea").append((a=>{d.lines&&a.css({height:"calc("+(1.5*parseFloat(d.lines)).toString()+"em + 2px)"});return a})(kb.create("textarea")));break;case "NUMBER":d.lookup?e.addClass("kb-lookup").append(kb.create("input").addClass("kb-lookup-search").attr("type","text").attr("data-type","nondemiliternumber")).append(kb.create("button").addClass("kb-icon kb-icon-lookup kb-search")).append(kb.create("button").addClass("kb-icon kb-icon-open kb-open")).append(kb.create("button").addClass("kb-icon kb-icon-del kb-clear")):
(e.addClass("kb-number").append((a=>{"displayScale"in d&&a.attr("data-decimals",d.displayScale);return a.attr("data-type",d.digit?"number":"nondemiliternumber")})(kb.create("input").attr("type","text"))),d.unit&&(a=>{"BEFORE"==d.unitPosition?e.insertBefore(a,e.elm("input")):e.insertBefore(a,e.elm("input").nextElementSibling)})(kb.create("span").addClass("kb-unit").html(d.unit)));break;case "ORGANIZATION_SELECT":e.addClass("kb-organization").append(kb.create("input").attr("type","hidden")).append(kb.create("button").addClass("kb-icon kb-icon-organization kb-search"));
break;case "RADIO_BUTTON":(a=>{a.reduce((b,f)=>{b[f.index]=f;return b},Array(a.length).fill("")).each((b,f)=>{var q=e.addClass("kb-radio"),u=q.append;b=kb.create("label").append(kb.create("input").attr("type","radio").attr("data-name",d.code).val(b.label)).append(kb.create("span").html(b.label));0==f&&(b.elm("input").checked=!0);u.call(q,b)})})(Object.values(d.options));break;case "RECORD_NUMBER":e.addClass("kb-id");break;case "SINGLE_LINE_TEXT":if(d.lookup)e.addClass("kb-lookup").append(kb.create("input").addClass("kb-lookup-search").attr("type",
"text").attr("data-type","text")).append(kb.create("button").addClass("kb-icon kb-icon-lookup kb-search")).append(kb.create("button").addClass("kb-icon kb-icon-open kb-open")).append(kb.create("button").addClass("kb-icon kb-icon-del kb-clear"));else switch(d.format){case "password":e.addClass("kb-text").append(kb.create("input").attr("type","password").attr("data-type",d.type));break;default:e.addClass("kb-text").append(kb.create("input").attr("type","text").attr("data-type",d.format?d.format:"text"))}break;
case "SPACER":e.html(d.contents);break;case "STATUS_ASSIGNEE":e.append(kb.create("input").attr("type","hidden"));break;case "TIME":p(e);break;case "USER_SELECT":e.addClass("kb-user").append(kb.create("input").attr("type","hidden")).append(kb.create("button").addClass("kb-icon kb-icon-user kb-search"))}return"SPACER"!=d.type?e.append(kb.create("span").addClass("kb-guide")):e})(kb.create("div").addClass("kb-field-value")));switch(d.type){case "CALC":case "CATEGORY":case "CONDITION":case "CREATED_TIME":case "CREATOR":case "FILE":case "GROUP_SELECT":case "MODIFIER":case "ORGANIZATION_SELECT":case "RECORD_NUMBER":case "REFERENCE_TABLE":case "STATUS":case "STATUS_ASSIGNEE":case "UPDATED_TIME":case "USER_SELECT":m.elm(".kb-guide").addClass("kb-fixed")}if(d.required)switch(d.type){case "CALC":case "CATEGORY":case "CHECK_BOX":case "CONDITION":case "CREATED_TIME":case "CREATOR":case "FILE":case "GROUP_SELECT":case "MODIFIER":case "MULTI_SELECT":case "ORGANIZATION_SELECT":case "RECORD_NUMBER":case "REFERENCE_TABLE":case "STATUS":case "STATUS_ASSIGNEE":case "UPDATED_TIME":case "USER_SELECT":break;
default:m.elms("input,select,textarea").each((e,g)=>e.attr("required","required"))}d.placeholder&&m.elms("input,select,textarea").each((e,g)=>e.attr("placeholder",d.placeholder));return m})(kb.create("div").addClass("kb-field").attr("field-id",d.code))}get(d,l,p){var m=null;if(d.tableCode)m=kb.elms(".field-"+d.id).map(e=>{switch(p){case "create":case "edit":e.value=l?e.elm("input[type=text],textarea,ul")?e.elm("input[type=text],textarea,ul"):e.elm("[class^=forms-]"):e.elm(".input-checkbox-cybozu,.input-date-cybozu,.input-datetime-cybozu,.input-file-cybozu,.input-radio-cybozu,.input-text-outer-cybozu,.input-time-cybozu,.multipleselect-cybozu,.select-cybozu");
break;case "detail":case "print":e.value=l?e.elm(".value-"+d.id):e}return e});else if(m=kb.elm(".field-"+d.id))switch(p){case "create":case "edit":m.value=l?m.elm("input[type=text],textarea,ul")?m.elm("input[type=text],textarea,ul"):m.elm("[class^=forms-]"):m.elm(".input-checkbox-cybozu,.input-date-cybozu,.input-datetime-cybozu,.input-file-cybozu,.input-radio-cybozu,.input-text-outer-cybozu,.input-time-cybozu,.multipleselect-cybozu,.select-cybozu");break;case "detail":case "print":m.value=m.elm(".value-"+
d.id)}return m}isEmpty(d){var l=!0;if(Array.isArray(d))l=0==d.length;else switch(typeof d){case "object":l=null===d||0==Object.keys(d).length;break;case "number":l=Number.isNaN(d);break;case "string":l=0==d.toString().length}return l}load(d,l){return new Promise((p,m)=>{d in this.cache?p(this.cache[d]):kintone.api(kintone.api.url("/k/v1/app/form/layout",!0),"GET",{app:d}).then(e=>{(g=>{var a=[],b=[],f=[],q=(u,k=!0)=>u.reduce((h,r)=>{switch(r.type){case "GROUP":k&&a.push({code:r.code,fields:r.layout.flatMap(c=>
c.fields)});h=h.concat(q(r.layout));break;case "ROW":k&&(b=r.fields.reduce((c,v)=>{v.elementId&&c.push(v);return c},b));h=r.fields.reduce((c,v)=>{"code"in v&&c.push(v.code);return c},h);break;case "SUBTABLE":k?(f.push({code:r.code,fields:r.fields}),h=r.fields.reduce((c,v)=>{"code"in v&&c.push(v.code);return c},h)):h.push(r.code)}return h},[]);kintone.api(kintone.api.url("/k/v1/app/form/fields",!0),"GET",{app:d,lang:"user"}).then(u=>{(k=>{k.each((h,r)=>{delete u.properties[h]})})(Object.values(u.properties).reduce((k,
h)=>{switch(h.type){case "CATEGORY":h.enabled||k.push(h.code);break;case "STATUS":h.enabled||(k.push(h.code),k.push(Object.values(u.properties).filter(r=>"STATUS_ASSIGNEE"==r.type).first().code))}return k},[]));((k,h,r)=>{this.cache[d]={origin:((c,v)=>{c=c.reduce((t,w)=>{t[w]=v[w];"SUBTABLE"==v[w].type&&(t[w].fields=(x=>x.fields.reduce((y,z)=>{y[z.code]=v[x.code].fields[z.code];return y},{}))(f.filter(x=>x.code==w).first()));delete v[w];return t},{});for(var n in v)c[n]=v[n];return c})(q(g,!1),kb.extend({},
u.properties)),groups:a.reduce((c,v)=>{c[v.code]=u.properties[v.code];c[v.code].fields=v.fields;return c},{}),tables:f.reduce((c,v)=>{c[v.code]=(n=>{n.fields=v.fields.reduce((t,w)=>{t[w.code]=k[w.code];return t},{});return n})(u.properties[v.code]);v.code in r.table&&(c[v.code].id=r.table[v.code]);return c},{}),changes:(c=>{var v=[];h.each((n,t)=>{c.includes(n)||v.push(n)});return v.concat(f.map(n=>n.code))})((()=>{var c=[],v;for(v in k)(n=>{kb.field.reserved.includes(n.type)?c.push(n.code):(n.expression&&
c.push(n.code),n.lookup&&(c.push(n.code),(t=>{t.field&&(n.lookup.triggerField=t.field,c=c.concat(n.lookup.fieldMappings.reduce((w,x)=>{x.field!=t.field&&w.push(x.field);return w},[])))})(n.lookup.fieldMappings.reduce((t,w)=>{t.index<h.indexOf(w.field)&&(t={index:h.indexOf(w.field),field:w.field});return t},{index:-1,field:null}))))})(k[v]);return Array.from(new Set(c))})()),criterias:(()=>{var c={};h.each((n,t)=>{["FILE","REFERENCE_TABLE"].includes(k[n].type)||(c[n]=k[n])});for(var v in k)(n=>{switch(n.type){case "CALC":case "CREATED_TIME":case "CREATOR":case "MODIFIER":case "RECORD_NUMBER":case "UPDATED_TIME":c[n.code]=
n;break;case "STATUS":n.enabled&&(c[n.code]=n,(t=>{c[t.code]=t})(Object.values(k).filter(t=>"STATUS_ASSIGNEE"==t.type).first()))}})(k[v]);return c})(),disables:(()=>{var c=[],v;for(v in k)(n=>{kb.field.reserved.includes(n.type)?c.push(n.code):(n.expression&&c.push(n.code),n.lookup&&(t=>{0!=t.length&&(c=c.concat(t))})(n.lookup.fieldMappings.map(t=>t.field)))})(k[v]);return Array.from(new Set(c))})(),layout:h,parallelize:(()=>{var c={};h.each((n,t)=>{c[n]=k[n]});for(var v in k)(n=>{switch(n.type){case "CATEGORY":n.enabled&&
(c[n.code]=n);break;case "CREATED_TIME":case "CREATOR":case "MODIFIER":case "RECORD_NUMBER":case "UPDATED_TIME":c[n.code]=n;break;case "STATUS":n.enabled&&(c[n.code]=n,(t=>{c[t.code]=t})(Object.values(k).filter(t=>"STATUS_ASSIGNEE"==t.type).first()))}n.code in r.field&&n.code in c&&(c[n.code].id=r.field[n.code])})(k[v]);return c})(),placed:(()=>{var c={};h.each((v,n)=>{["REFERENCE_TABLE"].includes(k[v].type)||(c[v]=k[v])});return c})(),spacers:b,sorts:(()=>{var c={};h.each((n,t)=>{n=k[n];switch(n.type){case "CALC":case "CREATED_TIME":case "CREATOR":case "DATE":case "DATETIME":case "DROP_DOWN":case "LINK":case "MODIFIER":case "NUMBER":case "RADIO_BUTTON":case "RECORD_NUMBER":case "SINGLE_LINE_TEXT":case "TIME":case "UPDATED_TIME":n.tableCode||
(c[n.code]=n)}});for(var v in k)(n=>{switch(n.type){case "CALC":case "CREATED_TIME":case "CREATOR":case "MODIFIER":case "RECORD_NUMBER":case "UPDATED_TIME":c[n.code]=n;break;case "STATUS":n.enabled&&(c[n.code]=n)}})(k[v]);return c})()};p(this.cache[d])})(kb.field.parallelize(u.properties),q(g),(()=>{var k={field:{},table:{}};l&&(Object.values(cybozu.data.page.FORM_DATA.schema.table.fieldList).each((h,r)=>{k.field[h.var]=h.id}),"subTable"in cybozu.data.page.FORM_DATA.schema&&Object.values(cybozu.data.page.FORM_DATA.schema.subTable).each((h,
r)=>{k.table[h.var]=h.id;Object.values(h.fieldList).each((c,v)=>{k.field[c.var]=c.id})}));return k})())}).catch(u=>kb.alert(kb.error.parse(u)))})(e.layout)}).catch(e=>kb.alert(kb.error.parse(e)))})}parallelize(d){d=kb.extend({},d);var l={},p;for(p in d){var m=void 0,e=d[p];switch(e.type){case "SUBTABLE":var g=e.code;for(m in e.fields)e.fields[m]=kb.extend({tableCode:g},e.fields[m]),l[e.fields[m].code]=e.fields[m];break;default:e=kb.extend({tableCode:""},e),l[e.code]=e}}return l}stringify(d,l,p,m=
!1){var e="";if(d&&l)switch(d.type){case "CALC":switch(d.format){case "NUMBER":case "NUMBER_DIGIT":kb.isNumeric(l)&&(e="NUMBER_DIGIT"==d.format?Number(l).comma(d.displayScale):d.displayScale?Number(l).toFloor(parseInt(d.displayScale)):l);d.unit&&(e="BEFORE"==d.unitPosition?d.unit+" "+e:e+" "+d.unit);break;default:e=l}break;case "CATEGORY":case "CHECK_BOX":case "MULTI_SELECT":e=l.join(p);break;case "CREATOR":case "MODIFIER":e=l.name;break;case "CREATED_TIME":case "DATETIME":case "UPDATED_TIME":e=l.parseDateTime().format("Y-m-d H:i");
break;case "FILE":case "GROUP_SELECT":case "ORGANIZATION_SELECT":case "STATUS_ASSIGNEE":case "USER_SELECT":e=l.map(g=>g.name).join(p);break;case "MULTI_LINE_TEXT":case "RICH_TEXT":e=m?l:l.replace(/\n/g,"");break;case "NUMBER":kb.isNumeric(l)&&(e=d.digit?Number(l).comma(d.displayScale):d.displayScale?Number(l).toFloor(parseInt(d.displayScale)):l);d.unit&&(e="BEFORE"==d.unitPosition?d.unit+" "+e:e+" "+d.unit);break;default:e=l}return e}typing(d,l,p=!1){var m=!1;if("SINGLE_LINE_TEXT"==l.type)switch(d.type){case "CALC":case "CREATED_TIME":case "DATE":case "DATETIME":case "DROP_DOWN":case "LINK":case "NUMBER":case "RADIO_BUTTON":case "RECORD_NUMBER":case "SINGLE_LINE_TEXT":case "STATUS":case "TIME":case "UPDATED_TIME":m=
p?!0:!l.expression}if(!m)switch(d.type){case "CALC":if(l.type==d.type)m=l.format==d.format&&p;else switch(d.format){case "DATE":case "DATETIME":case "TIME":m=l.type==d.format;break;case "NUMBER":case "NUMBER_DIGIT":m=(p?["NUMBER","RECORD_NUMBER"]:["NUMBER"]).includes(l.type)}break;case "CHECK_BOX":case "MULTI_SELECT":m=["CHECK_BOX","MULTI_SELECT"].includes(l.type);break;case "CREATED_TIME":case "DATETIME":case "UPDATED_TIME":m="CALC"==l.type?"DATETIME"==l.format&&p:(p?["CREATED_TIME","DATETIME","UPDATED_TIME"]:
["DATETIME"]).includes(l.type);break;case "CREATOR":case "MODIFIER":case "STATUS_ASSIGNEE":case "USER_SELECT":m=(p?["CREATOR","MODIFIER","STATUS_ASSIGNEE","USER_SELECT"]:["USER_SELECT"]).includes(l.type);break;case "DATE":m="CALC"==l.type?"DATE"==l.format&&p:l.type==d.type;break;case "DROP_DOWN":case "RADIO_BUTTON":m=["DROP_DOWN","LINK","RADIO_BUTTON"].includes(l.type);break;case "FILE":case "MULTI_LINE_TEXT":case "RICH_TEXT":m=p?!1:l.type==d.type;break;case "GROUP_SELECT":case "LINK":case "ORGANIZATION_SELECT":case "STATUS":case "TIME":m=
l.type==d.type;break;case "NUMBER":case "RECORD_NUMBER":m="CALC"==l.type?"NUMBER"==l.format&&p:(p?["NUMBER","RECORD_NUMBER"]:["NUMBER"]).includes(l.type);break;case "SINGLE_LINE_TEXT":m=p?["DROP_DOWN","RADIO_BUTTON","LINK","MULTI_LINE_TEXT","RICH_TEXT"].includes(l.type):["LINK","MULTI_LINE_TEXT","RICH_TEXT"].includes(l.type)}return m}uniqueLookups(d,l,p){var m=(e,g)=>{(a=>{kb.field.load(a.lookup.relatedApp.app).then(b=>{var f=b.origin[a.lookup.relatedKeyField];(f.unique||"RECORD_NUMBER"==f.type)&&
l(a,b);e++;e<d.length?m(e,g):g()})})(d[e])};0!=d.length?m(0,()=>p()):p()}objectUrl(d,l){var p=null,m=window.URL||window.webkitURL;if("string"===typeof d){var e=atob(d),g=new Uint8Array(e.length);e.length.each(a=>g[a]=e.charCodeAt(a));p=new Blob([g.buffer],{type:l})}else p=d;return m.createObjectURL(p)}};
window.KintoneBoosterIcon=class{constructor(){}create(d,l,p,m,e){(g=>{g&&g.parentNode.removeChild(g)})(kb.elm("#"+p));switch(l){case "detail":(d?kintone.mobile.app.getHeaderSpaceElement():kintone.app.record.getHeaderMenuSpaceElement().css({padding:"0 0.75em 0 1em"})).append(kb.create("button").addClass("kb-action-icon kb-icon kb-icon-"+m+" kb-page-detail "+(d?" kb-mobile":"")).attr("id",p).on("click",g=>{e&&e()}));break;case "index":(d?kintone.mobile.app.getHeaderSpaceElement():kintone.app.getHeaderMenuSpaceElement()).append(kb.create("button").addClass("kb-action-icon kb-icon kb-icon-"+
m+" kb-page-index "+(d?" kb-mobile":"")).attr("id",p).on("click",g=>{e&&e()}))}}};
window.KintoneBoosterRecord=class{constructor(){this.comments={get:(d,l)=>new Promise((p,m)=>{var e=(g,a,b)=>{kintone.api(kintone.api.url("/k/v1/record/comments",!0),"GET",{app:d,record:l,order:"asc",offset:a}).then(f=>{Array.prototype.push.apply(g,f.comments);a+=10;10==f.comments.length?e(g,a,b):b(g)}).catch(f=>{"GAIA_RE12"==f.code?b([]):m(f)})};e([],0,g=>p(g))}),set:(d,l,p,m=!1)=>new Promise((e,g)=>{var a=(b,f)=>{0!=p.length?kintone.api(kintone.api.url("/k/v1/record/comment",!0),"POST",{app:d,record:l,
comment:{text:p[b].text,mentions:p[b].mentions}}).then(q=>{m||kb.progressUpdate();b++;b<p.length?a(b,f):f()}).catch(q=>{"GAIA_RE12"==q.code?f():g(q)}):f()};m||kb.progressStart(p.length);a(0,()=>{m||kb.progressEnd();e()})})};this.page={add:(d,l)=>kintone.api.url("/k/",!0).replace(/\.json/g,"")+(d?"m/"+l:l)+"/edit",detail:(d,l,p)=>kintone.api.url("/k/",!0).replace(/\.json/g,"")+(d?"m/"+l:l)+"/show"+(d?"?":"#")+"record="+p,edit:(d,l,p)=>kintone.api.url("/k/",!0).replace(/\.json/g,"")+(d?"m/"+l:l)+"/show"+
(d?"?":"#")+"record="+p+(d?"#":"&")+"mode=edit",reuse:(d,l,p)=>kintone.api.url("/k/",!0).replace(/\.json/g,"")+(d?"m/"+l:l)+"/edit?record="+p+(d?"&reuse=true":""),view:(d,l,p,m)=>{var e=[];p&&e.push("view="+p);m&&e.push("query="+encodeURIComponent(m));return kintone.api.url("/k/",!0).replace(/\.json/g,"")+(d?"m/"+l:l)+(0!=e.length?"/?"+e.join("&"):"/")}}}create(d,l=!0){var p={},m;for(m in d.fields)(e=>{switch(e.type){case "CHECK_BOX":case "CONDITION":case "FILE":case "GROUP_SELECT":case "MULTI_SELECT":case "ORGANIZATION_SELECT":case "USER_SELECT":p[m]=
{type:e.type,value:[]};break;case "RADIO_BUTTON":(g=>{p[m]={type:e.type,value:0!=g.length?g.reduce((a,b)=>{a[b.index]=b;return a},Array(g.length).fill("")).first().label:""}})(Object.values(e.options));break;case "SUBTABLE":p[m]={type:e.type,value:[{value:this.create(e,!1)}]};break;default:kb.field.reserved.includes(e.type)||(p[m]={type:e.type,value:""})}})(d.fields[m]);l&&(p.$id={type:"__ID__",value:""});return p}get(d,l,p){var m={error:!1,record:{}};if(!p)for(var e in l.fields)if(((g,a)=>{if(g)switch("SUBTABLE"!=
a.type&&(g=g.elm(".kb-field-value")),a.type){case "CHECK_BOX":case "MULTI_SELECT":a.required&&!g.elms("input").some(b=>b.checked)&&(g.alert(kb.constants.common.message.invalid.required[kb.operator.language]),m.error=!0);break;case "FILE":case "GROUP_SELECT":case "ORGANIZATION_SELECT":case "USER_SELECT":a.required&&(b=>{0==b.length&&(g.alert(kb.constants.common.message.invalid.required[kb.operator.language]),m.error=!0)})(g.elm("input").val()?JSON.parse(g.elm("input").val()):[]);break;case "SUBTABLE":break;
default:g.elms("input,select,textarea").each((b,f)=>{b.checkValidity()||(m.error=!0)})}})(d.elm('[field-id="'+CSS.escape(e)+'"]'),l.fields[e]),m.error)break;if(m.error)kb.alert(kb.constants.common.message.invalid.record[kb.operator.language]);else{for(e in l.fields)((g,a)=>{if(g)switch("SUBTABLE"!=a.type&&(g=g.elm(".kb-field-value")),a.type){case "CALC":m.record[a.code]={type:a.type,value:null};break;case "CHECK_BOX":case "MULTI_SELECT":m.record[a.code]={type:a.type,value:(()=>{var b=[];g.elms("input").each((f,
q)=>{f.checked&&!f.parentNode.hasClass("kb-hidden")&&b.push(f.val())});return b})()};break;case "CREATED_TIME":case "UPDATED_TIME":m.record[a.code]={type:a.type,value:g.elm("input").val()?g.elm("input").val():(new Date).format("ISO")};break;case "CREATOR":case "MODIFIER":m.record[a.code]={type:a.type,value:g.elm("input").val()?JSON.parse(g.elm("input").val()):{code:kb.operator.code,name:kb.operator.name}};break;case "DATETIME":m.record[a.code]={type:a.type,value:(()=>{var b="";g.elm("input").val()&&
(g.elm(".kb-hour").elm("select").val()||g.elm(".kb-hour").elm("select").val("00"),g.elm(".kb-minute").elm("select").val()||g.elm(".kb-minute").elm("select").val("00"));g.elm("input").val()&&g.elm(".kb-hour").elm("select").val()&&g.elm(".kb-minute").elm("select").val()&&(b=(g.elm("input").val()+" "+g.elm(".kb-hour").elm("select").val()+":"+g.elm(".kb-minute").elm("select").val()+":00").parseDateTime().format("ISO"));return b})()};break;case "DROP_DOWN":m.record[a.code]={type:a.type,value:g.elm("select").val()};
break;case "FILE":case "GROUP_SELECT":case "ORGANIZATION_SELECT":case "STATUS_ASSIGNEE":case "USER_SELECT":m.record[a.code]={type:a.type,value:g.elm("input").val()?JSON.parse(g.elm("input").val()):[]};break;case "MULTI_LINE_TEXT":case "RICH_TEXT":m.record[a.code]={type:a.type,value:g.elm("textarea").val()};break;case "NUMBER":m.record[a.code]={type:a.type,value:kb.isNumeric(g.elm("input").val())?parseFloat(g.elm("input").val()):g.elm("input").val()};break;case "RADIO_BUTTON":m.record[a.code]={type:a.type,
value:(()=>{var b="";g.elms("[data-name="+a.code+"]").each((f,q)=>{f.checked&&!f.parentNode.hasClass("kb-hidden")&&(b=f.val())});return b})()};break;case "RECORD_NUMBER":case "STATUS":m.record[a.code]={type:a.type,value:g.elm(".kb-guide").text()};break;case "SUBTABLE":m.record[a.code]={type:a.type,value:(()=>{var b=[];g.tr.each((f,q)=>{q=this.get(f,a,p);if(q.error)return m.error=q.error,KB_BREAK;b.push(f.hasAttribute("row-id")?{id:f.attr("row-id"),value:q.record}:{value:q.record})});return b})()};
break;case "TIME":m.record[a.code]={type:a.type,value:(()=>{var b="";g.elm(".kb-hour").elm("select").val()&&(g.elm(".kb-minute").elm("select").val()||g.elm(".kb-minute").elm("select").val("00"));g.elm(".kb-minute").elm("select").val()&&(g.elm(".kb-hour").elm("select").val()||g.elm(".kb-hour").elm("select").val("00"));g.elm(".kb-hour").elm("select").val()&&g.elm(".kb-minute").elm("select").val()&&(b=g.elm(".kb-hour").elm("select").val()+":"+g.elm(".kb-minute").elm("select").val());return b})()};break;
default:kb.field.reserved.includes(a.type)||(m.record[a.code]={type:a.type,value:g.elm("input").val()})}})(d.elm('[field-id="'+CSS.escape(e)+'"]'),l.fields[e]);d.elm("[data-type=id]")&&(m.record.$id={value:d.elm("[data-type=id]").val()?parseInt(d.elm("[data-type=id]").val()):d.elm("[data-type=id]").val()})}return m}set(d,l,p){return new Promise((m,e)=>{var g=(a,b,f,q)=>{var u=[],k;for(k in f)((h,r,c)=>{if(h&&c){"disabled"in c&&(c.disabled?h.addClass("kb-disabled"):h.removeClass("kb-disabled"));"hidden"in
c&&(c.hidden?h.addClass("kb-hidden"):h.removeClass("kb-hidden"));if("SUBTABLE"!=r.type)switch(h=h.elm(".kb-field-value"),"backcolor"in c&&(c.backcolor?h.addClass("kb-force-backcolor").elm(".kb-guide").css({backgroundColor:c.backcolor}):h.removeClass("kb-force-backcolor").elm(".kb-guide").css({backgroundColor:""})),"forecolor"in c&&(c.forecolor?h.addClass("kb-force-forecolor").elm(".kb-guide").css({color:c.forecolor}):h.removeClass("kb-force-forecolor").elm(".kb-guide").css({color:""})),"error"in c&&
(h.alert?h.alert(c.error):h.elms("input,select,textarea").each((n,t)=>{n.alert&&n.alert.elm("span").html(c.error).parentNode.show()})),r.type){case "CALC":case "CATEGORY":case "CHECK_BOX":case "CONDITION":case "CREATED_TIME":case "CREATOR":case "FILE":case "GROUP_SELECT":case "MODIFIER":case "MULTI_SELECT":case "ORGANIZATION_SELECT":case "RADIO_BUTTON":case "RECORD_NUMBER":case "REFERENCE_TABLE":case "SPACER":case "STATUS":case "STATUS_ASSIGNEE":case "UPDATED_TIME":case "USER_SELECT":"backcolor"in
c&&h.css({backgroundColor:c.backcolor?c.backcolor:""});"forecolor"in c&&h.css({color:c.forecolor?c.forecolor:""});break;default:h.elms("input,select,textarea").each((n,t)=>{"backcolor"in c&&n.css({backgroundColor:c.backcolor?c.backcolor:""});"forecolor"in c&&n.css({color:c.forecolor?c.forecolor:""})})}switch(r.type){case "CALC":switch(r.format){case "NUMBER":r.displayScale?kb.isNumeric(c.value)?h.elm(".kb-guide").html(Number(c.value).toFloor(parseInt(r.displayScale))):h.elm(".kb-guide").html(c.value):
h.elm(".kb-guide").html(c.value);r.unit&&("BEFORE"==r.unitPosition?h.elm(".kb-guide").html(r.unit+" "+h.elm(".kb-guide").text()):h.elm(".kb-guide").html(h.elm(".kb-guide").text()+" "+r.unit));break;case "NUMBER_DIGIT":kb.isNumeric(c.value)?h.elm(".kb-guide").html(Number(c.value).comma(r.displayScale)):h.elm(".kb-guide").html(c.value);r.unit&&("BEFORE"==r.unitPosition?h.elm(".kb-guide").html(r.unit+" "+h.elm(".kb-guide").text()):h.elm(".kb-guide").html(h.elm(".kb-guide").text()+" "+r.unit));break;
default:h.elm(".kb-guide").html(c.value)}break;case "CATEGORY":h.elm(".kb-guide").html(c.value.join("<br>"));break;case "CHECK_BOX":case "MULTI_SELECT":h.elms("input").each((n,t)=>n.parentNode.removeClass("kb-hidden"));h.elms("input").each((n,t)=>{c.options&&(c.options.includes(n.val())||n.parentNode.addClass("kb-hidden"));n.checked=c.value.includes(n.val())});h.elm(".kb-guide").html(c.value.join("<br>"));break;case "COLOR":h.css({backgroundColor:c.value?c.value:"transparent"}).elm("input").val(c.value);
h.elm(".kb-guide").html(c.value);break;case "CONDITION":h.elm(".kb-guide").empty();c.value?(h.elm("input").val(c.value),c.value.split(" and ").each((n,t)=>h.guide(n))):h.elm("input").val("");break;case "CREATOR":case "MODIFIER":h.elm("input").val(JSON.stringify(c.value));h.elm(".kb-guide").html(c.value.name);break;case "CREATED_TIME":case "UPDATED_TIME":c.value?(h.elm("input").val(c.value),h.elm(".kb-guide").html((new Date(c.value)).format("Y-m-d H:i"))):(h.elm("input").val(""),h.elm(".kb-guide").html(""));
break;case "DATETIME":if(c.value){var v=c.value.parseDateTime();h.elm("input").val(v.format("Y-m-d"));h.elm(".kb-hour").elm("select").val(v.format("H"));h.elm(".kb-minute").elm("select").val(v.format("i"));h.elm(".kb-guide").html(v.format("Y-m-d H:i"))}else h.elm("input").val(""),h.elm(".kb-hour").elm("select").val(""),h.elm(".kb-minute").elm("select").val(""),h.elm(".kb-guide").html("");break;case "DROP_DOWN":h.elm("select").filteroption(c.options).val(c.value);h.elm(".kb-guide").html(c.value);break;
case "FILE":case "GROUP_SELECT":case "ORGANIZATION_SELECT":case "USER_SELECT":h.elm(".kb-guide").empty();c.value?(h.elm("input").val(JSON.stringify(c.value)),c.value.each((n,t)=>h.guide(n))):h.elm("input").val("[]");break;case "LINK":h.elm("input").val(c.value);h.elm(".kb-guide").empty();if(c.value)switch(r.protocol){case "MAIL":h.elm(".kb-guide").append(kb.create("a").attr("href","mailto:"+c.value).html(c.value));break;case "CALL":h.elm(".kb-guide").append(kb.create("a").attr("href","tel:"+c.value).html(c.value));
break;case "WEB":h.elm(".kb-guide").append(kb.create("a").attr("href",c.value).attr("target","_blank").html(c.value))}break;case "MULTI_LINE_TEXT":case "RICH_TEXT":h.elm("textarea").val(c.value);h.elm(".kb-guide").html(String(c.value).replace(/\n/g,"<br>"));break;case "NUMBER":c.lookup?u.push({field:h,value:c.value}):(r.digit?kb.isNumeric(c.value)?(h.elm("input").val(Number(c.value).comma(r.displayScale)),h.elm(".kb-guide").html(Number(c.value).comma(r.displayScale))):(h.elm("input").val(c.value),
h.elm(".kb-guide").html(c.value)):r.displayScale?kb.isNumeric(c.value)?(h.elm("input").val(Number(c.value).toFloor(parseInt(r.displayScale))),h.elm(".kb-guide").html(Number(c.value).toFloor(parseInt(r.displayScale)))):(h.elm("input").val(c.value),h.elm(".kb-guide").html(c.value)):(h.elm("input").val(c.value),h.elm(".kb-guide").html(c.value)),r.unit&&("BEFORE"==r.unitPosition?h.elm(".kb-guide").html(r.unit+" "+h.elm(".kb-guide").text()):h.elm(".kb-guide").html(h.elm(".kb-guide").text()+" "+r.unit)));
break;case "RADIO_BUTTON":h.elms("[data-name="+k+"]").each((n,t)=>n.parentNode.removeClass("kb-hidden"));h.elms("[data-name="+k+"]").each((n,t)=>{c.options&&(c.options.includes(n.val())||n.parentNode.addClass("kb-hidden"));n.checked=c.value==n.val()});h.elm(".kb-guide").html(c.value);break;case "RECORD_NUMBER":case "STATUS":h.elm(".kb-guide").html(c.value);break;case "SPACER":break;case "STATUS_ASSIGNEE":h.elm(".kb-guide").empty();c.value?(h.elm("input").val(JSON.stringify(c.value)),c.value.each((n,
t)=>{h.elm(".kb-guide").append(kb.create("span").addClass("kb-guide-item").append(kb.create("span").addClass("kb-guide-item-label").html(n.name)))})):h.elm("input").val("[]");break;case "SUBTABLE":if(0==c.value.length)h.clearRows();else{h.tr.each((n,t)=>{c.value.length>t&&g(n,r,(w=>{if(c.disabled)for(var x in w)w[x].disabled=!0;return w})(c.value.map(w=>w.value)[t]),w=>u=u.concat(w))});for(v=h.tr.length;v<c.value.length;v++)g(h.addRow(),r,(n=>{if(c.disabled)for(var t in n)n[t].disabled=!0;return n})(c.value.map(n=>
n.value)[v]),n=>u=u.concat(n));h.tr.slice(c.value.length).each((n,t)=>h.delRow(n))}0==h.tr.length?(n=>{c.disabled&&g(n,r,(t=>{for(var w in t)t[w].disabled=!0;return t})(this.get(n,r,!0).record),t=>u=u.concat(t))})(h.addRow()):h.tr.each((n,t)=>{"id"in c.value[t]&&n.attr("row-id",c.value[t].id)});break;case "TIME":c.value?(h.elm(".kb-hour").elm("select").val(c.value.split(":")[0]),h.elm(".kb-minute").elm("select").val(c.value.split(":")[1]),h.elm(".kb-guide").html(c.value)):(h.elm(".kb-hour").elm("select").val(""),
h.elm(".kb-minute").elm("select").val(""),h.elm(".kb-guide").html(""));break;default:c.lookup?u.push({field:h,value:c.value}):(h.elm("input").val(c.value),h.elm(".kb-guide").html(c.value))}}})(a.elm('[field-id="'+CSS.escape(k)+'"]'),b.fields[k],f[k]);"$id"in f&&a.elm("[data-type=id]")&&a.elm("[data-type=id]").val(f.$id.value);q(u)};g(d,l,p,a=>{var b=(f,q)=>{0!=a.length?a[f].field.lookup(null,a[f].value).then(()=>{f++;f<a.length?b(f,q):q()}):q(!1)};b(0,()=>{d.hasOwnProperty("cleanup")&&d.cleanup();
m()})})})}simplify(d,l){var p={},m;for(m in d.fields)(e=>{switch(e.type){case "CATEGORY":case "CHECK_BOX":case "MULTI_SELECT":p[m]={value:m in l?Array.from(new Set(l[m].value.sort())):[]};break;case "CALC":case "CREATED_TIME":case "CREATOR":case "FILE":case "MODIFIER":case "RECORD_NUMBER":case "REFERENCE_TABLE":case "SPACER":case "STATUS":case "UPDATED_TIME":break;case "GROUP_SELECT":case "ORGANIZATION_SELECT":case "STATUS_ASSIGNEE":case "USER_SELECT":p[m]={value:m in l?Array.from(new Set(l[m].value.map(g=>
g.code).sort())):[]};break;case "NUMBER":p[m]={value:m in l?kb.isNumeric(l[m].value)?l[m].value.toString():"":""};break;case "SUBTABLE":p[m]={value:l[m].value.reduce((g,a)=>{g.push({value:this.simplify(e,a.value)});return g},[])};break;default:p[m]={value:m in l?(l[m].value||" ").toString().replace(/[\r\n]*/g,""):""}}})(d.fields[m]);return p}};
window.KintoneBoosterRecordBuilder=class extends KintoneBoosterDialog{constructor(){super(999996,!1,!1);this.table=this.handler=null;this.container.css({height:"calc(100% - 1em)",width:"55em"});this.contents.addClass("kb-recordbuilder").css({padding:"0"})}build(d,l,p){var m=g=>{g=[];g.push({code:"",label:""});for(var a in d){var b=d[a];switch(b.type){case "CALC":case "CATEGORY":case "CREATED_TIME":case "CREATOR":case "FILE":case "GROUP":case "HR":case "LABEL":case "MODIFIER":case "RECORD_NUMBER":case "REFERENCE_TABLE":case "SPACER":case "STATUS":case "STATUS_ASSIGNEE":case "SUBTABLE":case "UPDATED_TIME":break;
default:g.push({code:a,label:b.label})}}return g},e=()=>{this.table=kb.table.create({code:"fields",type:"SUBTABLE",label:"",noLabel:!0,fields:{field:{code:"field",type:"DROP_DOWN",label:"",required:!1,noLabel:!0,options:[]},value:{code:"value",type:"SPACER",label:"",required:!1,noLabel:!0,contents:""}}}).spread((g,a)=>{g.elm(".kb-table-row-add").on("click",b=>{this.table.insertRow(g)});g.elm(".kb-table-row-del").on("click",b=>{kb.confirm(kb.constants.common.message.confirm.delete[kb.operator.language],
()=>{this.table.delRow(g)})});(b=>{(f=>{f.field.empty().assignOption(m(),"label","code").on("change",q=>q.currentTarget.rebuild()).rebuild=()=>new Promise((q,u)=>{f.value.empty();f.field.val()&&(k=>{k.code="value";k.label="";k.required=!1;k.noLabel=!0;switch(k.type){case "NUMBER":k.unit="";break;case "USER_SELECT":k.loginuser=!0}f.value.append(kb.field.activate(kb.field.create(k),(h=>{h.fields[k.code]=k;return h})({id:"recordbuilder",fields:{}})));f.value.elms("input,select,textarea").each((h,r)=>
h.initialize());f.value.get=()=>kb.record.get(b,{fields:{value:k}},!0).record.value.value})(kb.extend({},d[f.field.val()]));q({})})})({field:b.elm("[field-id=field]").elm("select"),value:b.elm("[field-id=value]").css({padding:"0"})})})(g.addClass("kb-scope").attr("form-id","form_recordbuilder"))},(g,a)=>{0==g.tr.length&&g.addRow()},!1);this.contents.empty().append(this.table);this.handler&&this.ok.off("click",this.handler);this.handler=g=>{this.hide();p(this.table.tr.reduce((a,b)=>{var f=b.elm("[field-id=field]").elm("select");
b=b.elm("[field-id=value]");f.val()&&(b=b.get(),a[f.val()]={value:b},d[f.val()].lookup&&(a[f.val()].lookup=b?!0:"CLEAR"));return a},{}))};this.ok.on("click",this.handler);this.cancel.on("click",g=>this.hide());this.table.addRow();super.show()};0==kb.roleSet.user.length?kb.roleSet.load().then(()=>e()):e()}};
window.KintoneBoosterRecordPicker=class extends KintoneBoosterDialog{constructor(d,l,p){super(999997,!1,!l);this.multiSelect=l;this.prepend=p;this.type=d;this.limit=50;this.offset=0;this.table=null;this.fieldInfo={};this.records=[];this.selection=[];this.img=this.parts.icon.clone().css({top:"0px"});this.prev=this.img.clone().css({right:"4em"}).attr("src","data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADwAAAA8CAYAAAFN++nkAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAjZJREFUeNpiYKAJ6J8y8T+MzYIm0QCk6pHFmNA016ObhqKgMCefkfoOBggg6vr9Psz/LLgCBcVb6BI4gxSvQqJMAQggugYDinNYSNVAUDOxHmbCJghNRo2ENDMSG+VASoGq6RMggIY7Agbae6Limdh4ZyGgaT2QCiAphRGbyliwaALZtJ7s5EksYCTF2ehJE6fNUIUbqFIIUFQuYUskAwcAAmgUUTP3F5CUpSi0DD07TqCZxUDLQBXBfVL1sZBpmQCQoiiPsJCRIQWoES3ENAn2AykHaic+Rlr6GF8DgJGWcUx1i4lN1TS1GF8+HpC2FqGSa+QBgAAaRaNgFBBVcJDVm6BCL4uo2ouFShYaAKnzNG/6oFkKstCALm0uarS7mMi0tJ+ujT1i+79UtRhav/ZTKwewUDubULN5S5MRO4KJC9pu+kB3i6GWC4KoAWvQkxL0hFqYJOdjqIET6BLUWCwHBbsg3S2GWv4B6vsLdLUYyQGGQMqQ5omL2IKG6omL3tluFIwCkgFAgPbN6AZAGASi1XQQR3BD3aSrGhLilzZqoQK9iwu8RLnrUfFAEORKbla63NNSRbq21KPZOCQFqJIqC133wAxJt2FU+uZsCHRPF9d+QgFzq7FJlwymgHk/U3pCdgfmgpMm7PL3p5MVIU8bsTQUpbtxcRsxB6xtI9Ka02CaPL7SLdFSLUtrDi2TwJq2ZB5YOni4ApaIlm6Bvx4eQgC/8fVQwE9sLizwnc3hbwMIgobRAdIK28oCHbudAAAAAElFTkSuQmCC").on("click",
m=>{this.offset-=this.limit;this.search()});this.next=this.img.clone().css({right:"2em"}).attr("src","data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADwAAAA8CAYAAAFN++nkAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAi1JREFUeNpiYKAa6J8y8T8Q30cXZ0LjK4AU4lMANw3GZkGXLMzJZ2QgpIskABBAVPI/Xr9DA6gBn7/rcUri9DNJACCAaO9lXICRkGZ8HmQkxWZ0g5iIdGEjNhew4NHwAKhBkWaBCxBAwwUBo+o9sWqxRZUAsamMiUDJtJ4szVAQgM8VTMRmFiAOIEszLsBCjCJcOYuQzRvwZUkWUm2jWiIZOAAQQKMIW8QV0MJcRmKyExI3EJjsNgyExchAEeiIBwNhMTIQBDriw0BYDAMfgA4QHAiLkcEBoCMcKSo1aeFjallMchxTYjFFqZpUi6mWjwes5Bp5ACCARtEoGJlNn/+0KESI7RD0U7vRTEpPRADqewN6WwwD54GWnx/Ixh5Z9TBVOn1A8B7osP6BsBgECshplzENVLZjona2JzbbUdtiogdDaGHxB2K69dS2uJDe7WqSBy+o4eMJ5IyYUOpjsksuci2+ALTQkBIXk2OxIdDSC5TGDwuJ2USQWomRidrZZBSMggEHAAHaNaMbAEEYiBLDgo7AJo7gaI7gCI5giMSAn0LLNb0XBuAlhF4LXIQQU3Q/vZfcnsPI2jNPtSZck+e66W/utCjcpPzw/DC4vAjXZPHNk/DbDxT53YvwVz6pvecACNec5aY/vAg3zb5UmUMVFitzFoSHlrklOCMa2OPQI40qLHZpIQmrlKXZwurBI06SnBYtNYUhmgdpYbj2UEIYegAwStjMiIcQQkxxA49895hLUEtfAAAAAElFTkSuQmCC").on("click",
m=>{this.offset+=this.limit;this.search()});this.submit=this.img.clone().css({left:"0"}).attr("src","data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADwAAAA8CAYAAAFN++nkAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAA7BJREFUeNpiYKAa6J8yMQFK/yfbhP9Qej7RigkpOk+U1QABRLnf92MTZ4LSDkgKHbDpNiDoHZACvIqIChCAAKIIMeLwNtxHhTn5jCTFNHoo4FLPRISZ58mJNQdCwctIauIlKRzwAYAAGqKIkUBcNwIDp4GsRAIqFoC4gBiNAaTmEOQUZkBpWfCeXJtB4AFSMRgAYoNSE9Zyg5R0TVbaRteEnK4JZkn0TAA0rIGcwPxP+4KNWAAQQKO5mVCeg2WdA8DYP0Azi6FZTACILwAtMkQSB4ndxyZHjfbNf2LaE1RNsqBMQ4phUMsdSLEDV04+gBSkRJW3pMY5E45iA2RIIxC/x9cQhEbFeiB2pHqqhlYz/TikHUGOhLZXzpNS6TNSIT2A4nY/MQUuVS0mpibD5gCqt4NwOCARaPkCuhSJ0CyZMFo5wABAAI2iUTCwLRBoLVWAVBI10NRioIUK0JYG0UUhxRaj1TiBQEs2oLWu66FcQaDcB1ItZiHUu8bmK2hQw1op78kp85lw+HY9kUGpiFRnU24xEICaMwSDD+iwBzC3UstiEJhIpBlkta+ZqJAlBahtcT2RZhhQ0+IFxDRvkdrSgVSxGJhoEqHM9wRKs/1Q9RuoGdSCSL2E+WiW7oc5Cpbl8A3Jkduufo8jAT0AWqqIRQ1RDTtSuqmw+PwANPgCWm/CgNRWJTUa9Lja03gtp0Y+xpWi5+Nr3lJsMTRFJ5JqOTV8zAANUpyW08xiIiynncV4LBekW0MO1GQiawxwFAwrABCgXau9QRCIoYQJWMENdAJlBCZQJjCOwAZugE4AG+AGygSs4AjapJra8HF3HEcx96J/jCR91uu1r8+/PDw8/k+FUGw+jzhg9gGGT+iSMjJkLoMwzgxVS5v/xKG1Jp9tA+IfIIDOPDYRMZwRRgnozogq77dxysvZvwE2Z7E4wi17h2yMyMacI5Dl1dTZDjWCixjZZKyiiFm9EAmlmjrDOvMDlc5KE9FhQOwArHU3k1MSpqgtx3FzVbRMCW8tDnURq+AyzjCe108wO4uTZ8GOykNSlYYrqWEBJiMy25Dr7SvRiWs8WuQ7OIOpSveERalg9/j5/exJeqcVYeC7gUIUBd3i+Q9R7N5y8v0n/pDl7IRbyB/e733QvxmAwK+cQE+bSmHFVjC7F5RbVRQwirgI82vPrsE6cTFuXxTPc4NHtYiLszcbEofitlG5JUJphCFbuKdLNR77FM3lZdgw48om0MU49juIO1dMPDw8PJziBXvFttyY+HdhAAAAAElFTkSuQmCC").on("click",
m=>{this.offset=0;this.search()});this.input=this.parts.input.clone().css({paddingLeft:"2em",paddingRight:"4em"}).attr("placeholder",kb.constants.common.prompt.keyword[kb.operator.language]).attr("type","text").on("keydown",m=>{if(13==(m.keyCode||m.which))return this.offset=0,this.search(),m.stopPropagation(),m.preventDefault(),!1});this.container.css({height:"calc(34em + 16px)",minWidth:"16em"});this.contents.css({padding:"0px"});this.header.css({boxShadow:"none"}).append(this.input).append(this.next).append(this.prev).append(this.submit)}search(d){switch(this.type){case "record":kintone.api(kintone.api.url("/k/v1/records",
!0),"GET",{app:this.fieldInfo.app,query:(()=>{var p=[];this.fieldInfo.query&&p.push(this.fieldInfo.query);this.input.val()&&p.push((m=>{var e=[];m.each((g,a)=>{for(var b in this.fieldInfo.picker)switch(a=this.fieldInfo.picker[b],a.type){case "LINK":case "MULTI_LINE_TEXT":case "RICH_TEXT":case "SINGLE_LINE_TEXT":e.push(a.code+' like "'+g+'"')}});return 0!=e.length?"("+e.join(" or ")+")":""})(this.input.val().split(/[ \u3000]/).filter(m=>m)));return p.join(" and ")+" order by "+(this.fieldInfo.sort?
this.fieldInfo.sort:"$id asc")+" limit "+this.limit+" offset "+this.offset})(),totalCount:!0}).then(p=>{this.records=p.records;this.table.clearRows();this.records.each((m,e)=>{(g=>{kb.record.set(g,{fields:this.fieldInfo.picker},m);this.multiSelect&&this.selection.some(a=>a.$id.value==m.$id.value)&&g.css({backgroundColor:"rgba(66,165,245,0.5)",color:""})})(this.table.addRow())});0<this.offset?this.prev.show():this.prev.hide();this.offset+(this.limit==this.records.length?this.limit:this.records.length)<
parseInt(p.totalCount)?this.next.show():this.next.hide();d&&d()}).catch(p=>kb.alert(kb.error.parse(p)));break;default:var l=()=>{var p=(()=>{var m=this.prepend?this.prepend.concat(kb.roleSet[this.type]):kb.extend({},kb.roleSet[this.type]);this.input.val()&&(e=>{m=m.filter(g=>{var a=!1;g.name.value&&(a=e.some(b=>g.name.value.match(new RegExp(b,"ig"))));return a})})(this.input.val().replace(/[\u3000 ]+/g," ").split(" ").filter(e=>e));return m})();this.records=p.slice(this.offset,this.offset+this.limit);
this.table.clearRows();this.records.each((m,e)=>{(g=>{kb.record.set(g,{fields:this.fieldInfo.picker},m);this.multiSelect&&this.selection.some(a=>a.code.value==m.code.value)&&g.css({backgroundColor:"rgba(66,165,245,0.5)",color:""})})(this.table.addRow())});0<this.offset?this.prev.show():this.prev.hide();this.offset+(this.limit==this.records.length?this.limit:this.records.length)<p.length?this.next.show():this.next.hide();d&&d()};0==kb.roleSet.user.length?kb.roleSet.load().then(()=>l()):l()}}show(d,
l){var p=this.parts.div.clone().css({borderTop:"1px solid #42a5f5",borderBottom:"1px solid #42a5f5",lineHeight:"2em",padding:"0px 0.5em"}),m=this.parts.td.clone().css({cursor:"pointer",padding:"0",userSelect:"none"}),e=this.parts.th.clone().css({backgroundColor:kb.themeColor().backcolor});this.offset=0;this.fieldInfo=d;this.records=[];this.selection=[];this.input.val("");this.table=this.parts.table.clone().css({marginBottom:"0.5em"}).append(kb.create("thead").append(kb.create("tr"))).append(kb.create("tbody").append(kb.create("tr")));
for(var g in this.fieldInfo.picker)(a=>{this.table.elm("thead tr").append(e.clone().append(p.clone().html("label"in a?a.label:"")));var b=this.table.elm("tbody tr"),f=b.append,q=m.clone(),u=q.append,k=kb.field,h=k.create;a=kb.extend({},a);a.noLabel=!0;f.call(b,u.call(q,h.call(k,a).css({width:"100%"}).addClass("kb-picker kb-readonly")))})(this.fieldInfo.picker[g]);this.contents.empty().append(this.table.spread((a,b)=>{a.on("click",f=>{(q=>{this.multiSelect?(u=>{u.length==this.selection.length?(this.selection.push(kb.extend({},
q)),a.css({backgroundColor:"rgba(66,165,245,0.5)",color:""})):(this.selection=u,a.css({backgroundColor:"transparent",color:kb.themeColor().forecolor}))})(this.selection.filter(u=>"record"==this.type?u.$id.value!=q.$id.value:u.code.value!=q.code.value)):(l&&l(q),this.hide())})(this.records[b])});(f=>{a.addClass("kb-scope").elms(".kb-field").each((q,u)=>kb.field.activate(q,f))})({id:"recordPicker",fields:kb.extend({},this.fieldInfo.picker)})}));this.multiSelect&&(this.handler&&this.ok.off("click",this.handler),
this.handler=a=>{l&&l(this.selection);this.hide()},this.ok.on("click",this.handler),this.cancel.on("click",a=>this.hide()));this.search(()=>super.show())}};
window.KintoneBoosterTable=class{constructor(){}activate(d,l){return d.spread((p,m)=>{(e=>{p.elm(".kb-table-row-add").on("click",g=>{d.insertRow(p);kb.event.call("kb.row.add."+d.attr("field-id"),{container:d,record:kb.record.get(e,l,!0).record,rowindex:parseInt(p.attr("row-idx"))+1}).then(a=>{a.error?d.delRow(p):kb.event.call("kb.action.call",{container:e,record:a.record,mobile:location.href.match(/\/m\//g)?!0:!1,pattern:"change",field:d.attr("field-id"),workplace:e.closest(".kb-view")?"view":"record"}).then(b=>
{kb.event.call("kb.style.call",{container:e,record:b.record,mobile:b.mobile,pattern:"$id"in b.record?b.record.$id.value?"edit":"create":"create",workplace:b.workplace}).then(f=>{kb.event.call("kb.cascade.call",f).then(q=>{kb.record.set(e,l,q.record);q=new Event("change");e.attr("unsaved","unsaved").dispatchEvent(q)}).catch(()=>{})}).catch(()=>{})})})});p.elm(".kb-table-row-copy").on("click",g=>{d.insertRow(p);((a,b,f)=>{a[f].value[b+1]={value:kb.extend({},a[f].value[b].value)};kb.file.clone(Object.values(l.fields[f].fields).reduce((q,
u)=>{"FILE"==u.type&&Array.prototype.push.apply(q,a[f].value[b+1].value[u.code].value);return q},[])).then(()=>{kb.event.call("kb.row.copy."+f,{container:d,record:a,rowindex:parseInt(p.attr("row-idx"))+1}).then(q=>{q.error?d.delRow(p):kb.event.call("kb.action.call",{container:e,record:q.record,mobile:location.href.match(/\/m\//g)?!0:!1,pattern:"change",field:f,workplace:e.closest(".kb-view")?"view":"record"}).then(u=>{kb.event.call("kb.style.call",{container:e,record:u.record,mobile:u.mobile,pattern:"$id"in
u.record?u.record.$id.value?"edit":"create":"create",workplace:u.workplace}).then(k=>{kb.event.call("kb.cascade.call",k).then(h=>{kb.record.set(e,l,h.record);h=new Event("change");e.attr("unsaved","unsaved").dispatchEvent(h)}).catch(()=>{})}).catch(()=>{})})})})})(kb.record.get(e,l,!0).record,parseInt(p.attr("row-idx")),d.attr("field-id"))});p.elm(".kb-table-row-del").on("click",g=>{kb.confirm(kb.constants.common.message.confirm.delete[kb.operator.language],()=>{kb.event.call("kb.row.del."+d.attr("field-id"),
{container:d,record:kb.record.get(e,l,!0).record,rowindex:parseInt(p.attr("row-idx"))}).then(a=>{a.error||(d.delRow(p),kb.event.call("kb.action.call",{container:e,record:kb.record.get(e,l,!0).record,mobile:location.href.match(/\/m\//g)?!0:!1,pattern:"change",field:d.attr("field-id"),workplace:e.closest(".kb-view")?"view":"record"}).then(b=>{kb.event.call("kb.style.call",{container:e,record:b.record,mobile:b.mobile,pattern:"$id"in b.record?b.record.$id.value?"edit":"create":"create",workplace:b.workplace}).then(f=>
{kb.event.call("kb.cascade.call",f).then(q=>{kb.record.set(e,l,q.record);q=new Event("change");e.attr("unsaved","unsaved").dispatchEvent(q)}).catch(()=>{})}).catch(()=>{})}))})})});p.elms(".kb-field").each((g,a)=>kb.field.activate(g,l));d.tr.each((g,a)=>g.attr("row-idx",a))})(d.closest("[form-id=form_"+l.id+"]"))},(p,m)=>{0==p.tr.length?p.addRow():p.tr.each((e,g)=>e.attr("row-idx",g))},!1)}create(d,l,p,m,e){return(g=>{p||m||g.append(kb.create("thead").append(kb.create("tr")));g.append(kb.create("tbody").append(kb.create("tr").addClass("kb-scope").attr("row-idx",
"")));for(var a in d.fields)(b=>{p||m||g.elm("thead tr").append(kb.create("th").append(kb.create("span").html(b.label)));var f=g.elm("tbody tr"),q=f.append,u=kb.create("td"),k=u.append,h=kb.field,r=h.create;b=kb.extend({},b);m||(b.noLabel=!0);q.call(f,k.call(u,r.call(h,b,e)))})(d.fields[a]);p||m||g.elm("thead tr").append(kb.create("th").addClass("kb-table-button"+(l?" kb-table-button-extension":"")));g.elm("tbody tr").append(kb.create("td").addClass("kb-table-button"+(l?" kb-table-button-extension":
"")).append(kb.create("button").addClass("kb-icon kb-icon-add kb-table-row-add")).append(kb.create("button").addClass("kb-icon kb-icon-copy kb-table-row-copy").css({display:l?"inline-block":"none"})).append(kb.create("button").addClass("kb-icon kb-icon-del kb-table-row-del")));for(a in d.fields)(b=>{b.lookup&&b.lookup.fieldMappings.each((f,q)=>{f.field in d.fields&&g.elm('[field-id="'+CSS.escape(f.field)+'"]')&&g.elm('[field-id="'+CSS.escape(f.field)+'"]').addClass("kb-readonly")})})(d.fields[a]);
return g.attr("field-id",d.code)})(kb.create("table").addClass("kb-table"))}};
window.KintoneBoosterView=class{constructor(){this.records={delete:(d,l,p=!1)=>new Promise((m,e)=>{var g=(a,b)=>{0!=l.length?kintone.api(kintone.api.url("/k/v1/records",!0),"DELETE",{app:d,ids:l.slice(a,a+100)}).then(f=>{p||kb.progressUpdate();a+=100;0<l.slice(a,a+100).length?g(a,b):b()}).catch(f=>e(f)):b()};p||kb.progressStart(Math.ceil(l.length/100));g(0,()=>{p||kb.progressEnd();m()})}),get:(d,l,p)=>new Promise((m,e)=>{(g=>{var a=(b,f,q)=>{kintone.api(kintone.api.url("/k/v1/records",!0),"GET",{app:d,
query:l+" order by "+g+" limit 500 offset "+f.toString()}).then(u=>{Array.prototype.push.apply(b,u.records);f+=500;500==u.records.length?a(b,f,q):q(b)}).catch(u=>e(u))};kintone.api(kintone.api.url("/k/v1/records",!0),"GET",{app:d,query:l,totalCount:!0}).then(b=>{1E4>parseInt(b.totalCount)?a([],0,f=>m(f)):kintone.api(kintone.api.url("/k/v1/records/cursor",!0),"POST",{app:d,query:l+" order by "+g,size:500}).then(f=>{(q=>{var u=(k,h)=>{kintone.api(kintone.api.url("/k/v1/records/cursor",!0),"GET",{id:q}).then(r=>
{Array.prototype.push.apply(k,r.records);r.next?u(k,h):h(k)}).catch(r=>e(r))};u([],k=>m(k))})(f.id)}).catch(f=>e(f))}).catch(b=>e(b))})(p||"$id asc")}),set:(d,l,p=!1,m=!1)=>new Promise((e,g)=>{var a=(f,q)=>{0!=l.post.length?kintone.api(kintone.api.url("/k/v1/records",!0),"POST",{app:d,records:(u=>{m&&(u=u.map(k=>this.records.transform(k,"POST")));return u})(l.post.slice(f,f+100))}).then(u=>{p||kb.progressUpdate();f+=100;0<l.post.slice(f,f+100).length?a(f,q):q(u.ids.last())}).catch(u=>g(u)):q()},b=
(f,q)=>{0!=l.put.length?kintone.api(kintone.api.url("/k/v1/records",!0),"PUT",{app:d,records:(u=>{m&&(u=u.map(k=>this.records.transform(k.record)));return u})(l.put.slice(f,f+100))}).then(u=>{p||kb.progressUpdate();f+=100;0<l.put.slice(f,f+100).length?b(f,q):q()}).catch(u=>g(u)):q()};"post"in l||(l.post=[]);"put"in l||(l.put=[]);p||kb.progressStart(Math.ceil(l.post.length/100)+Math.ceil(l.put.length/100));a(0,f=>{b(0,()=>{p||kb.progressEnd();e(f)})})}),transform:(d,l="PUT")=>{var p=null;switch(l){case "POST":p=
(()=>{var m={},e;for(e in d)kb.field.reserved.includes(d[e].type)||(m[e]=d[e]);return m})();break;case "PUT":p={id:d.$id.value,record:(()=>{var m={},e;for(e in d)kb.field.reserved.includes(d[e].type)||(m[e]=d[e]);return m})()}}return p}}}create(d,l,p,m,e){var g={key:()=>"view_"+l.id+"_"+p+"_"+location.host.split(".").first(),set:a=>{var b=g.key(),f="[view-id=view_"+l.id+"_"+p+"] .kb-guide{min-width:auto !important;}";kb.elm("[view-id=view_"+l.id+"_"+p+"]").elms(".kb-view-head-resizer").each((q,u)=>
{u=q.closest(".kb-view-head-cell");if(!u.hasClass("kb-unuse")){q=u.attr("column-id");var k=150;if(!a){kb.elm(".kb_spread_style_"+CSS.escape(b))&&kb.elm(".kb_spread_style_"+CSS.escape(b)).text().match(new RegExp('\\[column-id="'+CSS.escape(q)+'"\\]',"g"))&&(k=u.outerWidth(!1));var h=d.elm('[field-id="'+CSS.escape(q)+'"]');h&&k<h.outerWidth(!1)&&(k=h.outerWidth(!1),u.css({maxWidth:"",width:""}))}u=k;f+="[view-id=view_"+l.id+"_"+p+'] [column-id="'+CSS.escape(q)+'"]{max-width:'+u+"px;width:"+u+"px;}";
f+="[view-id=view_"+l.id+"_"+p+'] [field-id="'+CSS.escape(q)+'"]{width:'+u+"px;}"}});kb.elm(".kb_spread_style_"+CSS.escape(b))&&kb.elm("head").removeChild(kb.elm(".kb_spread_style_"+CSS.escape(b)));kb.elm("head").append(kb.create("style").addClass("kb_spread_style_"+b).attr("type","text/css").text(f));localStorage.setItem(b,f)}};return d.append(((a,b,f)=>{var q=0,u=(r=>{var c="";m||(c=(r?2:0)+f.buttons.length,c="kb-view-button_shave"+c.toString());return c})("viewer"==f.mode),k={columns:[],fixes:[],
float:{offset:0,padding:0,fields:[],table:{code:"",zIndex:0},adjust:()=>{k.float.fields.each((r,c)=>{k.view.elms('[field-id="'+CSS.escape(r.code)+'"]').each((v,n)=>{v=v.closest("td");v.css({left:(r.left+Math.max(0,k.float.offset-window.pageXOffset)).toString()+"px",position:"fixed",top:v.parentNode.getBoundingClientRect().top.toString()+"px",zIndex:r.zIndex});v.elm(".kb-view-row-pillar")||v.append(kb.create("span").css({display:"inline-block"}).addClass("kb-view-row-pillar"))})})},resize:()=>{k.view.elms('[field-id="'+
CSS.escape(k.float.table.code)+'"]').each((r,c)=>{var v=r.parentNode,n=r.tr.length-1;r.tr.each((t,w)=>{((x,y)=>{t.elms(".kb-field").each((z,A)=>x=Math.max(x,z.outerHeight(!1)));t.elms(".kb-view-row-pillar").each((z,A)=>z.css({height:x.toString()+"px"}));n==y&&v.innerHeight()>r.outerHeight(!1)&&(x+=v.innerHeight()-r.outerHeight(!1),t.elms(".kb-view-row-pillar").each((z,A)=>z.css({height:x.toString()+"px"})))})(0,w)})})}},observe:{mutationObserver:null,resizeObserver:null,perform:()=>{k.fixes.each((r,
c)=>{switch(r.type){case "field":k.view.elms('[field-id="'+CSS.escape(r.code)+'"]').each((v,n)=>{k.float.fields.some(t=>t.code==r.code)||v.css(r.css.field)});break;case "table":k.view.elms('[field-id="'+CSS.escape(r.tableCode||r.code)+'"]').each((v,n)=>{v.closest(".kb-view-row-cell").css(r.css.field)});break;case "view":k.view.elms(".kb-view-guide").each((v,n)=>{v.css(r.css.column)})}});k.float.table.code&&(k.view.elms('[field-id="'+CSS.escape(k.float.table.code)+'"]').each((r,c)=>r.css({zIndex:k.float.table.zIndex})),
k.float.adjust(),(r=>{k.view.elms('[field-id="'+CSS.escape(r)+'"]').each((c,v)=>{c=c.closest("td").nextSibling;c.css({paddingLeft:k.float.padding.toString()+"px"});c.elm(".kb-view-row-pillar")||c.append(kb.create("span").css({display:"inline-block"}).addClass("kb-view-row-pillar"))})})(k.float.fields.last().code),k.float.resize())}},view:a,set:r=>{var c=kb.field.parallelize(b.fields),v=-1*window.pageXOffset,n=k.columns.length+1;if(e)if(window.off("scroll",k.float.adjust),0!=k.fixes.length&&(k.observe.mutationObserver.disconnect(),
k.observe.resizeObserver.disconnect(),k.view.elm(".kb-view-head-cell-fix-anchor").removeClass("kb-view-head-cell-fix-anchor"),k.fixes.each((t,w)=>{var x={left:"",zIndex:""},y={left:"",position:"",zIndex:""};switch(t.type){case "field":(z=>{z&&k.view.elms('[field-id="'+CSS.escape(k.float.table.code)+'"]').each((A,B)=>A.css({zIndex:""}));k.view.elms('[field-id="'+CSS.escape(t.code)+'"]').each((A,B)=>{z?A.closest("td").css(kb.extend({bottom:"",top:""},y)):A.css(y)});k.view.elm('[column-id="'+CSS.escape(t.code)+
'"]').removeClass("kb-view-head-cell-fix").css(x)})(c[t.code].tableCode);break;case "table":k.view.elms('[field-id="'+CSS.escape(t.tableCode||t.code)+'"]').each((z,A)=>{z.closest(".kb-view-row-cell").css(y)});Object.values(b.fields[t.tableCode||t.code].fields).each((z,A)=>{k.view.elm('[column-id="'+CSS.escape(z.code)+'"]').removeClass("kb-view-head-cell-fix").css(x)});"viewer"!=f.mode&&k.view.elm('[column-id="'+CSS.escape(t.code)+'"]').removeClass("kb-view-head-cell-fix").css(x);break;case "view":k.view.elms(".kb-view-guide").each((z,
A)=>{z.css(x)})}}),k.float.table.code&&(t=>{k.view.elms('[field-id="'+CSS.escape(t)+'"]').each((w,x)=>{w.closest("td").nextSibling.css({paddingLeft:""})});k.view.elms(".kb-view-row-pillar").each((w,x)=>w.parentNode.removeChild(w))})(k.float.fields.last().code)),0==k.fixes.length||k.fixes.last().code!=r.code){k.fixes=[];k.float.offset=0;k.float.padding=0;k.float.fields=[];k.float.table.code="";k.float.table.zIndex=0;k.columns.some(t=>{"table"==t.type&&(k.fixes=(w=>k.fixes.filter(x=>x.code in c?c[x.code].tableCode!=
w:!0))(t.tableCode||t.code));k.fixes.push(t);return t.code==r.code});k.view.elm('[column-id="'+CSS.escape(r.code)+'"]').addClass("kb-view-head-cell-fix-anchor");k.fixes.each((t,w)=>{t.css={column:{left:v.toString()+"px",position:"sticky",zIndex:n},field:{left:v.toString()+"px",position:"sticky",zIndex:n}};n--;switch(t.type){case "field":(x=>{x&&(k.float.offset=window.pageXOffset,k.float.fields.push({code:t.code,left:k.view.elm('[field-id="'+CSS.escape(t.code)+'"]').closest("td").getBoundingClientRect().left,
zIndex:n}),k.float.table.code=x,k.float.table.zIndex=n);k.view.elm('[column-id="'+CSS.escape(t.code)+'"]').addClass("kb-view-head-cell-fix").css(t.css.column);var y=k.view.elm('[column-id="'+CSS.escape(t.code)+'"]').outerWidth(!0);v+=y;x&&(k.float.padding+=y)})(c[t.code].tableCode);break;case "table":(x=>{Object.values(b.fields[t.tableCode||t.code].fields).each((y,z)=>{k.view.elm('[column-id="'+CSS.escape(y.code)+'"]').addClass("kb-view-head-cell-fix").css(x);v+=k.view.elm('[column-id="'+CSS.escape(y.code)+
'"]').outerWidth(!0);x.left=v.toString()+"px"})})(t.css.column);"viewer"!=f.mode&&(k.view.elm('[column-id="'+CSS.escape(t.code)+'"]').addClass("kb-view-head-cell-fix").css(t.css.column),v+=k.view.elm('[column-id="'+CSS.escape(t.code)+'"]').outerWidth(!0));break;case "view":v+=k.view.elm(".kb-view-guide").outerWidth(!0)}});if(k.float.table.code)window.on("scroll",k.float.adjust);k.observe.mutationObserver.observe(k.view,{characterData:!0,childList:!0,subtree:!0});k.observe.resizeObserver.observe(k.view)}else k.fixes=
[],k.float.offset=0,k.float.padding=0,k.float.fields=[],k.float.table.code="",k.float.table.zIndex=0}},h=(r,c)=>{var v=r.changedTouches?Array.from(r.changedTouches).first():r,n=r.currentTarget.closest(".kb-view-head-cell"),t=v.pageX,w=r.currentTarget.closest(".kb-view-head-cell").outerWidth(!1),x={move:y=>{var z=!1,A=y.changedTouches?Array.from(y.changedTouches).first():y,B=w+A.pageX-t;n.css({maxWidth:B.toString()+"px",width:B.toString()+"px"});a.elms('[field-id="'+CSS.escape(c)+'"]').each((C,D)=>
C.css({width:B.toString()+"px"}));a.elms('[field-id="'+CSS.escape(c)+'"]').each((C,D)=>{B<C.outerWidth(!1)&&(B=C.outerWidth(!1),z=!0)});z&&n.css({maxWidth:B.toString()+"px",width:B.toString()+"px"});y.stopPropagation();y.preventDefault()},end:y=>{g.set();kb.elm("body").removeClass("kb-resizing");window.off("mousemove,touchmove",x.move);window.off("mouseup,touchend",x.end);y.stopPropagation();y.preventDefault()}};n.hasClass("kb-view-head-cell-fix")||(kb.elm("body").addClass("kb-resizing"),window.on("mousemove,touchmove",
x.move),window.on("mouseup,touchend",x.end));r.stopPropagation();r.preventDefault()};e&&(k.observe.mutationObserver=new MutationObserver(k.observe.perform),k.observe.resizeObserver=new ResizeObserver(k.observe.perform));a.append(kb.create("thead").append(kb.create("tr").addClass("kb-view-head"))).append(kb.create("tbody").append(kb.create("tr").addClass("kb-view-row")));a.elm("thead tr").append(kb.create("th").addClass("kb-view-head-cell kb-view-button "+u+" kb-view-guide"));a.elm("tbody tr").append(kb.create("td").addClass("kb-view-button "+
u+" kb-view-guide").append(kb.create("a").addClass("kb-icon kb-icon-edit kb-view-row-edit"+(f.buttons.includes("detail")?" kb-unuse":""))).append(kb.create("button").addClass("kb-icon kb-icon-add kb-view-row-add"+(f.buttons.includes("add")||"viewer"==f.mode?" kb-unuse":""))).append(kb.create("button").addClass("kb-icon kb-icon-copy kb-view-row-copy"+(f.buttons.includes("clone")||"viewer"==f.mode?" kb-unuse":""))).append(kb.create("button").addClass("kb-icon kb-icon-del kb-view-row-del"+(f.buttons.includes("delete")?
" kb-unuse":""))));k.columns.push({code:"",type:"view"});(r=>{r.concat(Object.keys(b.fields).filter(c=>!r.includes(c))).each((c,v)=>{((n,t)=>{switch(n.type){case "SUBTABLE":for(var w in n.fields)a.elm("thead tr").append(((x,y)=>{t||q++;return x.addClass("kb-view-head-cell"+(t?" kb-unuse":"")).attr("column-id",y.code).append(kb.create("span").addClass("kb-view-head-caption").on("click",z=>k.set(y)).html(y.label)).append(kb.create("span").addClass("kb-view-head-resizer").on("mousedown,touchstart",z=>
h(z,y.code)))})(kb.create("th"),n.fields[w])),n.fields[w].noLabel=!m,"viewer"!=f.mode?k.columns.push({code:n.fields[w].code,type:"field"}):Object.keys(n.fields).last()==w?k.columns.push({code:n.fields[w].code,tableCode:n.code,type:"table"}):k.columns.push({code:n.fields[w].code,type:"field"});"viewer"!=f.mode&&(t||q++,a.elm("thead tr").append(kb.create("th").addClass("kb-view-head-cell kb-view-button kb-view-button-tables"+(t?" kb-unuse":"")).attr("column-id",n.code).append(kb.create("span").addClass("kb-view-head-caption").on("click",
x=>k.set(n)).html("&nbsp;"))),k.columns.push({code:n.code,type:"table"}));break;default:a.elm("thead tr").append((x=>{t||q++;return x.addClass("kb-view-head-cell"+(t?" kb-unuse":"")).attr("column-id",n.code).append(kb.create("span").addClass("kb-view-head-caption").on("click",y=>k.set(n)).html(n.label)).append(kb.create("span").addClass("kb-view-head-resizer").on("mousedown,touchstart",y=>h(y,n.code)))})(kb.create("th"))),n.noLabel=!m,k.columns.push({code:n.code,type:"field"})}})(b.fields[c],0!=f.fields.length?
!f.fields.includes(c):!1)});a.elm("tbody tr").append((c=>{r.concat(Object.keys(b.fields).filter(v=>!r.includes(v))).each((v,n)=>{n=b.fields[v];v=0!=f.fields.length?!f.fields.includes(v):!1;switch(n.type){case "SUBTABLE":c.append(kb.create("div").addClass("kb-view-row-cell"+(v?" kb-unuse":"")).append(kb.table.create(n,!0,!0,m,!0)));break;default:c.append(kb.field.create(n,!0).addClass("kb-view-row-cell"+(v?" kb-unuse":"")))}});return c.append(kb.create("input").attr("type","hidden").attr("data-type",
"id"))})(kb.create("td").addClass("kb-scope").attr("form-id","form_"+b.id).attr("colspan",q.toString())))})(0!=f.fields.length?f.fields:Object.keys(b.fields));"viewer"==f.mode?(a.elms(".kb-field").each((r,c)=>r.addClass("kb-readonly")),a.elms(".kb-table-button").each((r,c)=>r.addClass("kb-readonly"))):b.disables.each((r,c)=>{a.elm('[field-id="'+CSS.escape(r.code)+'"]')&&a.elm('[field-id="'+CSS.escape(r.code)+'"]').addClass("kb-readonly")});return a.spread((r,c)=>{r.elm("[form-id=form_"+b.id+"]").on("change",
v=>{r.addClass("kb-unsaved")});r.elm(".kb-view-row-add").on("click",v=>{(n=>{kb.event.call("kb.view.add",{container:n.elm("[form-id=form_"+b.id+"]"),record:kb.record.get(n.elm("[form-id=form_"+b.id+"]"),b,!0).record,viewId:p}).then(t=>{t.error?a.delRow(n):kb.event.call("kb.action.call",{container:n.elm("[form-id=form_"+b.id+"]"),record:t.record,mobile:m,pattern:"create",workplace:"view"}).then(w=>{kb.event.call("kb.style.call",{container:n.elm("[form-id=form_"+b.id+"]"),record:w.record,mobile:w.mobile,
pattern:w.pattern,workplace:w.workplace}).then(x=>{kb.event.call("kb.cascade.call",x).then(y=>{kb.record.set(n.elm("[form-id=form_"+b.id+"]").attr("unsaved","unsaved"),b,y.record).then(()=>{kb.event.call("kb.view.add.complete",{container:n.elm("[form-id=form_"+b.id+"]"),viewId:p})});(z=>{n.elm("[form-id=form_"+b.id+"]").dispatchEvent(z)})(new Event("change"))}).catch(()=>{})}).catch(()=>{})}).catch(()=>{})})})(a.insertRow(r))});r.elm(".kb-view-row-del").on("click",v=>{(n=>{n?kb.confirm(kb.constants.common.message.confirm.delete[kb.operator.language],
()=>{kb.event.call("kb.view.delete",{container:r.elm("[form-id=form_"+b.id+"]"),record:kb.record.get(r.elm("[form-id=form_"+b.id+"]"),b,!0).record,viewId:p}).then(t=>{t.error||kb.view.records.delete(b.id,[n]).then(w=>a.delRow(r)).catch(w=>kb.alert(kb.error.parse(w)))})}):a.delRow(r)})(r.elm("[data-type=id]").val())});r.elm(".kb-view-row-copy").on("click",v=>{kb.confirm(kb.constants.common.message.confirm.copy[kb.operator.language],()=>{((n,t)=>{var w=Object.values(kb.field.parallelize(b.fields)).reduce((x,
y)=>{"FILE"==y.type&&(y.tableCode?n[y.tableCode].value.each((z,A)=>{Array.prototype.push.apply(x,z.value[y.code].value)}):Array.prototype.push.apply(x,n[y.code].value));return x},[]);kb.file.clone(w).then(()=>{kb.event.call("kb.view.copy",{container:t.elm("[form-id=form_"+b.id+"]"),record:(x=>{x.$id.value="";return x})(n),viewId:p}).then(x=>{x.error?a.delRow(t):kb.event.call("kb.action.call",{container:t.elm("[form-id=form_"+b.id+"]"),record:x.record,mobile:m,pattern:"reuse",workplace:"view"}).then(y=>
{kb.event.call("kb.style.call",{container:t.elm("[form-id=form_"+b.id+"]"),record:y.record,mobile:y.mobile,pattern:"create",workplace:y.workplace}).then(z=>{kb.event.call("kb.cascade.call",z).then(A=>{kb.record.set(t.elm("[form-id=form_"+b.id+"]").attr("unsaved","unsaved"),b,A.record).then(()=>{t.elms(".kb-table").each((B,C)=>{B.tr.each((D,E)=>{D.hasAttribute("row-id")&&D.removeAttr("row-id")})});kb.event.call("kb.view.copy.complete",{container:t.elm("[form-id=form_"+b.id+"]"),viewId:p})});(B=>{t.elm("[form-id=form_"+
b.id+"]").dispatchEvent(B)})(new Event("change"))}).catch(()=>{})}).catch(()=>{})}).catch(()=>{})})})})(kb.record.get(r.elm("[form-id=form_"+b.id+"]"),b,!0).record,a.insertRow(r))})});r.elms(".kb-field").each((v,n)=>{v.closest(".kb-scope").hasAttribute("form-id")&&kb.field.activate(v,b)});r.elms(".kb-table").each((v,n)=>{kb.table.activate(v,b).clearRows();v.addRow()})},(r,c)=>{},!1)})(kb.create("table").addClass("kb-view").attr("view-id","view_"+l.id+"_"+p),kb.extend({},l),kb.extend({},l).view)).on("show",
a=>{a=g.key();m||kb.elm(".kb_spread_style_"+CSS.escape(a))||(localStorage.getItem(a)?(kb.elm("head").append(kb.create("style").addClass("kb_spread_style_"+a).attr("type","text/css").text(localStorage.getItem(a))),g.set()):0!=kb.elm("[view-id=view_"+l.id+"_"+p+"]").elm("tbody").elms("tr").length&&g.set(!0))})}load(d){return new Promise((l,p)=>{kintone.api(kintone.api.url("/k/v1/app/views",!0),"GET",{app:d}).then(m=>{(e=>{l({origin:e,calendar:e.filter(g=>"CALENDAR"==g.type),custom:e.filter(g=>"CUSTOM"==
g.type),list:e.filter(g=>"LIST"==g.type)})})(Object.values(m.views).sort((e,g)=>e.index-g.index))}).catch(m=>kb.alert(kb.error.parse(m)))})}};window.kb.attachment||(window.kb.attachment=new KintoneBoosterAttachment);window.kb.record||(window.kb.record=new KintoneBoosterRecord,window.kb.record.builder=new KintoneBoosterRecordBuilder);window.kb.button||(window.kb.button=new KintoneBoosterButton);window.kb.field||(window.kb.field=new KintoneBoosterField);window.kb.icon||(window.kb.icon=new KintoneBoosterIcon);
window.kb.table||(window.kb.table=new KintoneBoosterTable);window.kb.view||(window.kb.view=new KintoneBoosterView);
kb.constants=kb.extend({common:{caption:{button:{cancel:{en:"Cancel",ja:"\u30ad\u30e3\u30f3\u30bb\u30eb",zh:"\u53d6\u6d88","zh-TW":"\u53d6\u6d88"},submit:{en:"Submit",ja:"\u4fdd\u5b58",zh:"\u4fdd\u5b58","zh-TW":"\u4fdd\u5b58"}},sort:{asc:{en:"asc",ja:"\u6607\u9806",zh:"\u5347\u5e8f","zh-TW":"\u5347\u5e8f"},desc:{en:"desc",ja:"\u964d\u9806",zh:"\u964d\u5e8f","zh-TW":"\u964d\u5e8f"}}},message:{confirm:{changed:{en:"Changes have not been saved.<br>Do you want to leave the page?",ja:"\u5909\u66f4\u304c\u4fdd\u5b58\u3055\u308c\u3066\u3044\u307e\u305b\u3093\u3002<br>\u3053\u306e\u307e\u307e\u30da\u30fc\u30b8\u3092\u79fb\u52d5\u3057\u307e\u3059\u304b\uff1f",
zh:"\u66f4\u6539\u5c1a\u672a\u4fdd\u5b58\u3002<br>\u60a8\u662f\u5426\u8981\u79bb\u5f00\u6b64\u9875\u9762\uff1f","zh-TW":"\u66f4\u6539\u5c1a\u672a\u4fdd\u5b58\u3002<br>\u60a8\u662f\u5426\u8981\u96e2\u958b\u6b64\u9801\u9762\uff1f"},cancel:{en:"The edits you made will be lost. Are you sure?",ja:"\u7de8\u96c6\u3057\u305f\u5185\u5bb9\u304c\u5931\u308f\u308c\u307e\u3059\u304c\u3001\u3088\u308d\u3057\u3044\u3067\u3059\u304b\uff1f",zh:"\u60a8\u7f16\u8f91\u7684\u5185\u5bb9\u5c06\u4f1a\u4e22\u5931\uff0c\u786e\u5b9a\u5417\uff1f",
"zh-TW":"\u60a8\u7de8\u8f2f\u7684\u5167\u5bb9\u5c07\u6703\u4e1f\u5931\uff0c\u78ba\u5b9a\u55ce\uff1f"},copy:{en:"Are you sure on copy?",ja:"\u30b3\u30d4\u30fc\u3057\u3066\u3082\u3088\u308d\u3057\u3044\u3067\u3059\u304b\uff1f",zh:"\u6211\u53ef\u4ee5\u590d\u5236\u5417\uff1f","zh-TW":"\u78ba\u5b9a\u8981\u8907\u88fd\u55ce\uff1f"},delete:{en:"Are you sure on delete?",ja:"\u524a\u9664\u3057\u3066\u3082\u3088\u308d\u3057\u3044\u3067\u3059\u304b\uff1f",zh:"\u6211\u53ef\u4ee5\u5220\u9664\u5417\uff1f","zh-TW":"\u78ba\u5b9a\u8981\u522a\u9664\u55ce\uff1f"},
save:{en:"Are you sure on copy?",ja:"\u4fdd\u5b58\u3057\u3066\u3082\u3088\u308d\u3057\u3044\u3067\u3059\u304b\uff1f",zh:"\u6211\u53ef\u4ee5\u4fdd\u5b58\u5417\uff1f","zh-TW":"\u78ba\u5b9a\u8981\u5132\u5b58\u55ce\uff1f"},submit:{en:"Are you sure on submit?",ja:"\u9001\u4fe1\u3057\u3066\u3082\u3088\u308d\u3057\u3044\u3067\u3059\u304b\uff1f",zh:"\u6211\u53ef\u4ee5\u53d1\u9001\u5417\uff1f","zh-TW":"\u78ba\u5b9a\u8981\u9001\u51fa\u55ce\uff1f"}},invalid:{record:{en:"There is an error in the input data.",
ja:"\u5165\u529b\u5185\u5bb9\u306b\u8aa4\u308a\u304c\u3042\u308a\u307e\u3059\u3002",zh:"\u8f93\u5165\u5185\u5bb9\u6709\u8bef\u3002","zh-TW":"\u8f38\u5165\u5167\u5bb9\u6709\u8aa4\u3002"},submit:{en:"No data to submit was found.",ja:"\u7de8\u96c6\u4e2d\u306e\u30c7\u30fc\u30bf\u304c\u3042\u308a\u307e\u305b\u3093\u3002",zh:"\u6b63\u5728\u7f16\u8f91\u7684\u6570\u636e\u4e0d\u5b58\u5728\u3002","zh-TW":"\u6b63\u5728\u7de8\u8f2f\u7684\u6578\u64da\u4e0d\u5b58\u5728\u3002"}}}},picker:{caption:{name:{en:"Name",
ja:"\u8868\u793a\u540d",zh:"\u663e\u793a\u540d\u79f0","zh-TW":"\u986f\u793a\u540d\u7a31"},recordnumber:{en:"Record number",ja:"\u30ec\u30b3\u30fc\u30c9\u756a\u53f7",zh:"\u8bb0\u5f55\u53f7","zh-TW":"\u8a18\u9304\u865f"}}}},kb.constants);
