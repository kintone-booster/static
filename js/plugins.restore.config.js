/*
* FileName "plugins.restore.config.js"
* Version: 1.0.0
* Copyright (c) 2023 Pandafirm LLC
* Distributed under the terms of the GNU Lesser General Public License.
* https://opensource.org/licenses/LGPL-2.1
*/
'use strict';(h=>{var f={};kb.field.load(kintone.app.getId()).then(g=>{kb.config[h].build({submit:(k,e)=>{try{var b=!1;e.tab=[];e.flat={};var c={id:f.app.id,fields:f.app.fields.flat},d=kb.record.get(k.main.elm(".kb-flat"),c);d.error?(kb.alert(kb.constants.common.message.invalid.record[kb.operator.language]),b=!0):e.flat=d.record;e.tab=JSON.stringify(e.tab);e.flat=JSON.stringify(e.flat);return b?!1:e}catch(a){return kb.alert(kb.error.parse(a)),!1}}},(k,e)=>{try{f.app={id:h,fields:{tab:{},flat:{backupID:{code:"backupID",
type:"DROP_DOWN",label:"",required:!0,noLabel:!0,options:[]},backupFile:{code:"backupFile",type:"DROP_DOWN",label:"",required:!0,noLabel:!0,options:[]},backupRecord:{code:"backupRecord",type:"DROP_DOWN",label:"",required:!0,noLabel:!0,options:[]}}}},(b=>{k.main.append(kb.create("div").addClass("kb-flat kb-scope").attr("form-id","form_"+b.id).append(kb.create("h1").html(kb.constants.config.caption.backup.id[kb.operator.language])).append(kb.create("section").append(kb.create("p").html(kb.constants.config.description.backup.id[kb.operator.language])).append(kb.field.activate((c=>
{c.elm("select").empty().assignOption(kb.config[h].ui.options.fields(g,(d,a)=>{if(!g.disables.includes(a.code)&&!a.tableCode)switch(a.type){case "NUMBER":d.push({code:a.code,label:a.label})}return d}),"label","code");return c})(kb.field.create(b.fields.backupID)),b))).append(kb.create("h1").html(kb.constants.config.caption.backup.file[kb.operator.language])).append(kb.create("section").append(kb.create("p").html(kb.constants.config.description.backup.file[kb.operator.language])).append(kb.field.activate((c=>
{c.elm("select").empty().assignOption(kb.config[h].ui.options.fields(g,(d,a)=>{if(!g.disables.includes(a.code)&&!a.tableCode)switch(a.type){case "FILE":d.push({code:a.code,label:a.label})}return d}),"label","code");return c})(kb.field.create(b.fields.backupFile)),b))).append(kb.create("h1").html(kb.constants.config.caption.backup.record[kb.operator.language])).append(kb.create("section").append(kb.create("p").html(kb.constants.config.description.backup.record[kb.operator.language])).append(kb.field.activate((c=>
{c.elm("select").empty().assignOption(kb.config[h].ui.options.fields(g,(d,a)=>{if(!g.disables.includes(a.code)&&!a.tableCode)switch(a.type){case "MULTI_LINE_TEXT":d.push({code:a.code,label:a.label})}return d}),"label","code");return c})(kb.field.create(b.fields.backupRecord)),b))));k.main.elms("input,select,textarea").each((c,d)=>c.initialize())})({id:f.app.id,fields:f.app.fields.flat}),Object.keys(e).length!=0&&(b=>{var c={id:f.app.id,fields:f.app.fields.flat};kb.record.set(k.main.elm(".kb-flat"),
c,b)})(JSON.parse(e.flat))}catch(b){kb.alert(kb.error.parse(b))}})})})(kintone.$PLUGIN_ID);
kb.constants=kb.extend({config:{caption:{backup:{file:{en:"Deleted Attachment Save Field",ja:"\u524a\u9664\u6dfb\u4ed8\u30d5\u30a1\u30a4\u30eb\u4fdd\u5b58\u30d5\u30a3\u30fc\u30eb\u30c9",zh:"\u5220\u9664\u9644\u4ef6\u4fdd\u5b58\u5b57\u6bb5","zh-TW":"\u522a\u9664\u9644\u4ef6\u4fdd\u5b58\u6b04\u4f4d"},id:{en:"App ID Save Field",ja:"\u30a2\u30d7\u30eaID\u4fdd\u5b58\u30d5\u30a3\u30fc\u30eb\u30c9",zh:"\u5e94\u7528ID\u4fdd\u5b58\u5b57\u6bb5","zh-TW":"\u61c9\u7528ID\u4fdd\u5b58\u6b04\u4f4d"},record:{en:"Deleted Record Save Field",
ja:"\u524a\u9664\u30ec\u30b3\u30fc\u30c9\u4fdd\u5b58\u30d5\u30a3\u30fc\u30eb\u30c9",zh:"\u5220\u9664\u8bb0\u5f55\u4fdd\u5b58\u5b57\u6bb5","zh-TW":"\u522a\u9664\u8a18\u9304\u4fdd\u5b58\u6b04\u4f4d"}}},description:{backup:{file:{en:"Please specify the field where the deleted attachment is saved.",ja:"\u524a\u9664\u6dfb\u4ed8\u30d5\u30a1\u30a4\u30eb\u304c\u4fdd\u5b58\u3055\u308c\u3066\u3044\u308b\u30d5\u30a3\u30fc\u30eb\u30c9\u3092\u6307\u5b9a\u3057\u3066\u4e0b\u3055\u3044\u3002",zh:"\u8bf7\u6307\u5b9a\u4fdd\u5b58\u5df2\u5220\u9664\u9644\u4ef6\u7684\u5b57\u6bb5\u3002",
"zh-TW":"\u8acb\u6307\u5b9a\u4fdd\u5b58\u5df2\u522a\u9664\u9644\u4ef6\u7684\u6b04\u4f4d\u3002"},id:{en:"Please specify the field where the App ID is saved.",ja:"\u30a2\u30d7\u30eaID\u304c\u4fdd\u5b58\u3055\u308c\u3066\u3044\u308b\u30d5\u30a3\u30fc\u30eb\u30c9\u3092\u6307\u5b9a\u3057\u3066\u4e0b\u3055\u3044\u3002",zh:"\u8bf7\u6307\u5b9a\u4fdd\u5b58\u5e94\u7528ID\u7684\u5b57\u6bb5\u3002","zh-TW":"\u8acb\u6307\u5b9a\u4fdd\u5b58\u61c9\u7528ID\u7684\u6b04\u4f4d\u3002"},record:{en:"Please specify the field where the deleted record is saved.",
ja:"\u524a\u9664\u30ec\u30b3\u30fc\u30c9\u304c\u4fdd\u5b58\u3055\u308c\u3066\u3044\u308b\u30d5\u30a3\u30fc\u30eb\u30c9\u3092\u6307\u5b9a\u3057\u3066\u4e0b\u3055\u3044\u3002",zh:"\u8bf7\u6307\u5b9a\u4fdd\u5b58\u5df2\u5220\u9664\u8bb0\u5f55\u7684\u5b57\u6bb5\u3002","zh-TW":"\u8acb\u6307\u5b9a\u4fdd\u5b58\u5df2\u522a\u9664\u8a18\u9304\u7684\u6b04\u4f4d\u3002"}}}}},kb.constants);