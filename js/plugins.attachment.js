/*
* FileName "plugins.attachment.js"
* Version: 1.0.0
* Copyright (c) 2023 Pandafirm LLC
* Distributed under the terms of the GNU Lesser General Public License.
* https://opensource.org/licenses/LGPL-2.1
*/
'use strict';(D=>{var f={},J=c=>{var r={};if(c.useMultiline.value.includes("use")&&!f.mobile)for(var E in f.fieldInfos.tables)(z=>{var B=Object.keys(z.fields).filter(x=>c.multilines.value.map(v=>v.value.field.value).includes(x));0!=B.length&&(r[z.id]={tableInfo:z,lines:Object.keys(z.fields).reduce((x,v)=>{B.includes(v)&&0!=x.last().length&&x.push([]);x.last().push(f.fieldInfos.parallelize[v].id);return x},[[]])})})(f.fieldInfos.tables[E]);return[c,r]},G=(c,r,E)=>{if(["create","edit"].includes(f.type))kintone.events.on(["app.record.create.change."+
c.code,"app.record.edit.change."+c.code],E);if(kb.elms(".subtable-"+c.id+" tbody tr").length!=r[c.code].value.length){let z=new MutationObserver(()=>{kb.elms(".subtable-"+c.id+" tbody tr").length==r[c.code].value.length&&(E({record:r}),z.disconnect())});z.observe(kb.elm(".subtable-"+c.id),{childList:!0,subtree:!0})}else E({record:r})};kintone.events.on(["app.record.create.show","app.record.edit.show","mobile.app.record.create.show","mobile.app.record.edit.show"],c=>new Promise((r,E)=>{((z,B)=>{f.mobile=
z;f.type=B;kb.config[D].config.get().then(x=>{0!=Object.keys(x).length?kb.field.load(kb.config[D].app,!0).then(v=>{f.app={id:kb.config[D].app,fields:v.origin};f.fieldInfos=v;try{(([t,C])=>{t.useLookupNavi.value.includes("use")&&Object.values(f.fieldInfos.parallelize).filter(d=>d.lookup).each((d,n)=>{(u=>{d.tableCode?G(f.fieldInfos.tables[d.tableCode],c.record,u):u({record:c.record})})(u=>{(h=>{h&&(Array.isArray(h)?h:[h]).each((k,p)=>{k.value.parentNode.elm(".kb-attachment-lookup-operation")||k.value.parentNode.css({alignItems:"center"}).insertBefore(kb.create("button").addClass("kb-icon kb-icon-open kb-attachment-lookup-operation").on("click",
m=>{((a,w)=>{a?kb.view.records.get(w,kb.filter.query.create({code:d.lookup.relatedKeyField},"=",{type:d.type,value:a})).then(b=>{0!=b.length&&window.open(kb.record.page.detail(f.mobile,w,b.first().$id.value))}).catch(b=>kb.alert(kb.error.parse(b))):window.open(kb.record.page.add(f.mobile,w))})(k.value.elm("input[type=text]").val(),d.lookup.relatedApp.app)}),k.value.nextSibling)})})(kb.field.get(d,f.mobile,f.type))})});t.usePlaceholder.value.includes("use")&&t.placeholders.value.map(d=>d.value).each((d,
n)=>{d.field.value in f.fieldInfos.parallelize&&(u=>{(h=>{u.tableCode?G(f.fieldInfos.tables[u.tableCode],c.record,h):h({record:c.record})})(h=>{(k=>{k&&(Array.isArray(k)?k:[k]).each((p,m)=>{f.mobile?p.value.attr("placeholder",d.text.value):p.value.elm("input[type=text],textarea").attr("placeholder",d.text.value)})})(kb.field.get(u,f.mobile,f.type))})})(f.fieldInfos.parallelize[d.field.value])});t.useAlignTableButtons.value.includes("use")&&!f.mobile&&Object.values(v.tables).filter(d=>!Object.keys(C).includes(d.id)).each((d,
n)=>{((u,h)=>{(k=>{k.prepend(k.elm('[class^="subtable-operation-gaia"]'))})(h.addClass("kb-attachment-subtable-operation").elm("thead").elm("tr"));G(u,c.record,k=>{h.elms("tbody tr").each((p,m)=>{Array.from(p.elms("td").last().classList).some(a=>a.startsWith("subtable-operation-gaia"))&&p.prepend(p.elm('[class^="subtable-operation-gaia"]'))})})})(d,kb.elm(".subtable-"+d.id))});if(t.useMultiline.value.includes("use")&&!f.mobile)for(var F in C)((d,n)=>{var u=(h,k,p)=>{k.elms("tr").each((m,a)=>{m.hasClass("kb-attachment-subtable-multi")||
(w=>{t.useAlignTableButtons.value.includes("use")?m.addClass("kb-attachment-subtable-multi").append(w):m.addClass("kb-attachment-subtable-multi").prepend(w);h.lines.each((b,g)=>{w.append((q=>{b.each((l,y)=>{var e={};y==b.length-1&&(e.flex="1");p?l?q.append(m.elm(".label-"+l).addClass("kb-attachment-subtable-multi-cell").css(e)):q.append(kb.create("th").addClass("subtable-label-gaia kb-attachment-subtable-multi-cell").css(e)):(e.width=n.elm("thead").elm(".label-"+l).css("width"),l?q.append(m.elm(".field-"+
l).closest("td").addClass("kb-attachment-subtable-multi-cell").css(e)):q.append(kb.create("td").addClass("kb-attachment-subtable-multi-cell").css(e)))});return q})(kb.create("div").css({alignItems:"center",display:"flex"})))})})(p?kb.create("th").addClass("subtable-label-gaia"):kb.create("td"))})};t.useAlignTableButtons.value.includes("use")&&n.addClass("kb-attachment-subtable-operation");u(d,n.elm("thead"),!0);G(d.tableInfo,c.record,h=>{u(d,n.elm("tbody"),!1)})})(C[F],kb.elm(".subtable-"+C[F].tableInfo.id))})(J(JSON.parse(x.flat))),
r(c)}catch(t){kb.alert(kb.error.parse(t)),r(c)}}).catch(v=>r(c)):r(c)}).catch(x=>r(c))})("mobile"==c.type.split(".").first(),c.type.split(".").slice(-2).first())}));kintone.events.on(["app.record.detail.show","mobile.app.record.detail.show"],c=>new Promise((r,E)=>{((z,B)=>{f.mobile=z;f.type=B;kb.config[D].config.get().then(x=>{0!=Object.keys(x).length?kb.field.load(kb.config[D].app,!0).then(v=>{f.app={id:kb.config[D].app,fields:v.origin};f.fieldInfos=v;try{(([t,C])=>{t.useAttachmentViewer.value.includes("use")&&
Object.values(f.fieldInfos.parallelize).filter(d=>"FILE"==d.type).each((d,n)=>{(u=>{d.tableCode?G(f.fieldInfos.tables[d.tableCode],c.record,u):u({record:c.record})})(u=>{(h=>{h&&(Array.isArray(h)?h:[h]).each((k,p)=>{(m=>{(f.mobile?kb.children(k.value):k.value.elm("ul").elms("li")).each((a,w)=>{a.elm("a")&&(b=>{0!=b.length&&(a.prepend(kb.create("span").addClass("kb-attachment-file-operation").html(b.first().name).on("click",g=>kb.attachment.show(b.first(),!t.onlyView.value.includes("onlyView")))),
m=m.filter(g=>g!=b.first()))})(m.filter(b=>b.name==a.elm("a").html()))})})(d.tableCode?u.record[d.tableCode].value[p].value[d.code].value:u.record[d.code].value)})})(kb.field.get(d,f.mobile,f.type))})});if(t.useMultiline.value.includes("use")&&!f.mobile)for(var F in C)((d,n)=>{var u=(h,k,p)=>{k.elms("tr").each((m,a)=>{m.hasClass("kb-attachment-subtable-multi")||(w=>{m.addClass("kb-attachment-subtable-multi").prepend(w);h.lines.each((b,g)=>{w.append((q=>{b.each((l,y)=>{var e={};y==b.length-1&&(e.flex=
"1");p?l?q.append(m.elm(".label-"+l).addClass("kb-attachment-subtable-multi-cell").css(e)):q.append(kb.create("th").addClass("subtable-label-gaia kb-attachment-subtable-multi-cell").css(e)):(e.width=n.elm("thead").elm(".label-"+l).css("width"),l?q.append(m.elm(".field-"+l).closest("td").addClass("kb-attachment-subtable-multi-cell").css(e)):q.append(kb.create("td").addClass("kb-attachment-subtable-multi-cell").css(e)))});return q})(kb.create("div").css({alignItems:"center",display:"flex"})))})})(p?
kb.create("th").addClass("subtable-label-gaia"):kb.create("td"))})};u(d,n.elm("thead"),!0);G(d.tableInfo,c.record,h=>{u(d,n.elm("tbody"),!1)})})(C[F],kb.elm(".subtable-"+C[F].tableInfo.id))})(J(JSON.parse(x.flat))),r(c)}catch(t){kb.alert(kb.error.parse(t)),r(c)}}).catch(v=>r(c)):r(c)}).catch(x=>r(c))})("mobile"==c.type.split(".").first(),c.type.split(".").slice(-2).first())}));kintone.events.on(["app.record.index.show","mobile.app.record.index.show"],c=>new Promise((r,E)=>{((z,B)=>{f.mobile=z;f.type=
B;kb.config[D].config.get().then(x=>{0!=Object.keys(x).length?kb.field.load(kb.config[D].app,!0).then(v=>{f.app={id:kb.config[D].app,fields:v.origin};f.fieldInfos=v;try{(t=>{var C=()=>{t.useSearchBox.value.includes("use")&&"list"==c.viewType?kb.view.load(f.app.id).then(F=>{(d=>{0==kb.roleSet.user.length?kb.roleSet.load().then(()=>d()):d()})(()=>{(d=>{var n=(()=>{var h={},k={},p=(a=>Object.keys(a).reduce((w,b)=>{"NONE"!=a[b]&&w.push(b);return w},[]))(cybozu.data.page.FIELD_ACCESSIBILITY||cybozu.data.page.FIELD_ACCESS_CONTROL.right.fields),
m=a=>{var w={CREATED_AT:"CREATED_TIME",DECIMAL:"NUMBER",EDITOR:"RICH_TEXT",MODIFIED_AT:"UPDATED_TIME",MULTIPLE_CHECK:"CHECK_BOX",MULTIPLE_SELECT:"MULTI_SELECT",MULTIPLE_LINE_TEXT:"MULTI_LINE_TEXT",RECORD_ID:"RECORD_NUMBER",SINGLE_CHECK:"RADIO_BUTTON",SINGLE_SELECT:"DROP_DOWN"};return a in w?w[a]:a};Object.values(cybozu.data.page.FORM_DATA.schema.table.fieldList).each((a,w)=>{if(p.includes(a.id))if("REFERENCE_TABLE"==a.type)k[a.id]=a.var;else switch(h[a.var]={id:"f"+a.id,type:m(a.type)},h[a.var].type){case "CHECK_BOX":case "DROP_DOWN":case "MULTI_SELECT":case "RADIO_BUTTON":h[a.var].option=
(()=>{var b={};"options"in a.properties&&Array.isArray(a.properties.options)&&a.properties.options.each((g,q)=>{g.valid&&(b[g.label]=g.id)});return b})();break;case "STATUS":h[a.var].status=(()=>{var b={};(g=>{("string"===typeof g.useStatus?"true"==g.useStatus:g.useStatus)&&g.states.each((q,l)=>{q.valid&&(b[q.label]=q.id)})})(cybozu.data.page.STATUS_DATA);return b})()}});Object.values(cybozu.data.page.FORM_DATA.schema.subTable).map(a=>Object.values(a.fieldList)).flat().each((a,w)=>{if(p.includes(a.id))switch(h[a.var]=
{id:"f"+a.id,type:m(a.type)},h[a.var].type){case "CHECK_BOX":case "DROP_DOWN":case "MULTI_SELECT":case "RADIO_BUTTON":h[a.var].option=(()=>{var b={};"options"in a.properties&&Array.isArray(a.properties.options)&&a.properties.options.each((g,q)=>{g.valid&&(b[g.label]=g.id)});return b})()}});cybozu.data.page.FORM_DATA.referenceTables.each((a,w)=>{a.masterApp.schema&&p.includes(a.fieldId)&&((b,g,q)=>{Object.values(a.masterApp.schema.table.fieldList).each((l,y)=>{if(!b.includes(l.id))switch(h[k[g]+"."+
l.var]={id:"f"+g+".f"+l.id,type:m(l.type)},h[k[g]+"."+l.var].type){case "CHECK_BOX":case "DROP_DOWN":case "MULTI_SELECT":case "RADIO_BUTTON":h[k[g]+"."+l.var].option=(()=>{var e={};"options"in l.properties&&Array.isArray(l.properties.options)&&l.properties.options.each((A,I)=>{A.valid&&(e[A.label]=A.id)});return e})();break;case "STATUS":h[k[g]+"."+l.var].status=(()=>{var e={};("string"===typeof q.useStatus?"true"==q.useStatus:q.useStatus)&&q.states.each((A,I)=>{A.valid&&(e[A.label]=A.id)});return e})()}})})(a.masterApp.unAccessibleFieldIds,
a.fieldId,a.masterApp.status)});return h})(),u={build:h=>{var k=d.filterCond.match(/ and /g)?" and ":" or ",p=d.filterCond.split(k).filter(a=>a),m=(a,w)=>{0!=p.length?(b=>{if(b.info){var g=RegExp("[/\\\\^$*+?.()|[\\]{}]","g"),q=function(y){var e={groups:[],organizations:[],users:[]},A="";y.match(/ in /g)&&(I=>{I.each((H,K)=>{if(H.replace(/^[ ]+/g,"").replace(/[ ]+$/g,"").match(/^"/g))switch(H=H.replace(/^[ "]+/g,"").replace(/[ "]+$/g,""),H){case "GROUP":A="groups";break;case "ORGANIZATION":A="organizations";
break;case "USER":A="users";break;default:A||="users",e[A].push(H)}})})(y.split(" in ").last().replace(/^\(/g,"").replace(/\)$/g,"").split(","));return e};switch(b.info.type){case "CHECK_BOX":case "DROP_DOWN":case "MULTI_SELECT":case "RADIO_BUTTON":for(var l in b.info.option)b.query.match(new RegExp('"'+l.replace(g,"\\$&")+'"'))&&(b.query=b.query.replace(new RegExp('"'+l.replace(g,"\\$&")+'"'),'"'+b.info.option[l]+'"'));break;case "CREATOR":case "MODIFIER":case "USER_SELECT":(y=>{kb.roleSet.group.filter(e=>
y.groups.includes(e.code.value)).each((e,A)=>{b.query.match(new RegExp('"'+e.code.value.replace(g,"\\$&")+'"'))&&(b.query=b.query.replace(new RegExp('"'+e.code.value.replace(g,"\\$&")+'"'),'"'+e.info.id+'"'))});kb.roleSet.organization.filter(e=>y.organizations.includes(e.code.value)).each((e,A)=>{b.query.match(new RegExp('"'+e.code.value.replace(g,"\\$&")+'"'))&&(b.query=b.query.replace(new RegExp('"'+e.code.value.replace(g,"\\$&")+'"'),'"'+e.info.id+'"'))});kb.roleSet.user.filter(e=>y.users.includes(e.code.value)).each((e,
A)=>{b.query.match(new RegExp('"'+e.code.value.replace(g,"\\$&")+'"'))&&(b.query=b.query.replace(new RegExp('"'+e.code.value.replace(g,"\\$&")+'"'),'"'+e.info.id+'"'))})})(q(b.query));break;case "GROUP_SELECT":(y=>{kb.roleSet.group.filter(e=>y.groups.includes(e.code.value)).each((e,A)=>{b.query.match(new RegExp('"'+e.code.value.replace(g,"\\$&")+'"'))&&(b.query=b.query.replace(new RegExp('"'+e.code.value.replace(g,"\\$&")+'"'),'"'+e.info.id+'"'))})})(q(b.query));break;case "ORGANIZATION_SELECT":(y=>
{kb.roleSet.organization.filter(e=>y.organizations.includes(e.code.value)).each((e,A)=>{b.query.match(new RegExp('"'+e.code.value.replace(g,"\\$&")+'"'))&&(b.query=b.query.replace(new RegExp('"'+e.code.value.replace(g,"\\$&")+'"'),'"'+e.info.id+'"'))})})(q(b.query));break;case "STATUS":for(l in b.info.status)b.query.match(new RegExp('"'+l.replace(g,"\\$&")+'"'))&&(b.query=b.query.replace(new RegExp('"'+l.replace(g,"\\$&")+'"'),'"'+b.info.status[l]+'"'))}p[a]=b.query}else p[a]="";a++;a<p.length?m(a,
w):w(p.filter(y=>y).join(k))})((b=>{var g={info:null,query:""};1<b.length&&b.last()in n&&(g.info=n[b.last()],g.query=p[a].replace(new RegExp(b.last().replace(/[\/\\^$*+?.()|\[\]{}]/g,"\\$&")),g.info.id));return g})(p[a].match(/^([^ ]+)/))):w("")};m(0,a=>{h(a)})},search:h=>{var k=kb.elm(".kb-attachment-search-operation").elm(".kb-keyword").elm("input"),p=kb.elm(".kb-attachment-search-operation").elm(".kb-target").elm("select"),m=kintone.api.url("/k/",!0).replace(/\.json/g,"")+(f.mobile?"m/"+f.app.id:
f.app.id)+"/?view="+c.viewId.toString();if(k.val()){var a=(w=>{var b=(p.val()?[d.fields[p.val()]]:Object.values(d.fields)).reduce((g,q)=>{g.push(w.map(l=>{var y=l.match(/^!/g);l=l.replace(/^!/g,"");var e="";if("EMPTY"==l)switch(q.type){case "CHECK_BOX":case "DROP_DOWN":case "MULTI_SELECT":case "RADIO_BUTTON":case "STATUS":e=n[q.code].id+(y?" not":"")+' in ("")';break;case "FILE":case "LINK":case "MULTI_LINE_TEXT":case "RICH_TEXT":case "SINGLE_LINE_TEXT":e=n[q.code].id+(y?" !":" ")+'= ""'}else switch(q.type){case "CHECK_BOX":case "DROP_DOWN":case "MULTI_SELECT":case "RADIO_BUTTON":l in
n[q.code].option&&(e=n[q.code].id+(y?" not":"")+' in ("'+n[q.code].option[l].replace(/"/g,'\\"')+'")');break;case "FILE":case "LINK":case "MULTI_LINE_TEXT":case "RICH_TEXT":case "SINGLE_LINE_TEXT":e=n[q.code].id+(y?" not":"")+' like "'+l.replace(/"/g,'\\"')+'"';break;case "STATUS":l in n[q.code].status&&(e=n[q.code].id+(y?" not":"")+' in ("'+n[q.code].status[l].replace(/"/g,'\\"')+'")')}return e}).join(" or "));return g.filter(l=>l)},[]).map(g=>"("+g+")");return h?["("+h+")"].concat(b.join(" or ")).join(" and "):
b.join(" or ")})(k.val().split(/[ \u3000]/).filter(w=>w));window.location.href=a?m+"&keyword="+k.val()+"&target="+p.val()+"&q="+encodeURIComponent(a):m}else window.location.href=m}};d.fields=d.fields.reduce((h,k)=>{if(k in n)switch(f.fieldInfos.parallelize[k].type){case "CHECK_BOX":case "DROP_DOWN":case "FILE":case "LINK":case "MULTI_LINE_TEXT":case "MULTI_SELECT":case "RADIO_BUTTON":case "RICH_TEXT":case "SINGLE_LINE_TEXT":h[k]=f.fieldInfos.parallelize[k]}return h},{});0!=Object.keys(d.fields).length?
u.build(h=>{(k=>{k.elm(".kb-attachment-search-operation")||(p=>{k.addClass("kb-scope").attr("form-id","form_"+p.id).append(kb.create("div").addClass("kb-attachment-search-operation"+(f.mobile?" kb-mobile":"")).append(kb.field.activate((m=>{m.elm("select").empty().assignOption([{code:"",label:"All"}].concat(Object.values(d.fields).map(a=>({code:a.code,label:a.label}))),"label","code");return m})(kb.field.create(p.fields.target).addClass("kb-target")),p)).append(kb.field.activate(kb.field.create(p.fields.keyword).addClass("kb-keyword"),
p)).append(kb.create("button").addClass("kb-icon kb-icon-lookup").on("click",m=>{u.search(h)})).append(kb.create("button").addClass("kb-icon kb-icon-del").on("click",m=>{m.currentTarget.parentNode.elm(".kb-keyword").elm("input").val("");u.search(h)})));kb.record.set(k,p,(m=>{var a={};"keyword"in m&&(a.keyword={value:m.keyword});"target"in m&&(a.target={value:m.target});return a})(kb.queries()));kb.event.on("kb.change.keyword",m=>{m.container==k&&u.search(h);return m})})({id:"AttachmentSearch",fields:{target:{code:"target",
type:"DROP_DOWN",label:"",required:!1,noLabel:!0,options:[{index:0,label:"open"},{index:1,label:"close"}]},keyword:{code:"keyword",type:"SINGLE_LINE_TEXT",label:"",required:!1,noLabel:!0,placeholder:""}}})})(f.mobile?kintone.mobile.app.getHeaderSpaceElement():kintone.app.getHeaderMenuSpaceElement());r(c)}):r(c)})(F.list.reduce((d,n)=>{n.id==c.viewId.toString()&&(d=n);return d},{fields:Object.values(f.fieldInfos.parallelize).reduce((d,n)=>{n.tableCode||d.push(n.code);return d},[]),filterCond:""}))})}):
r(c)};"useBulkUpdate"in t||(kb.alert(kb.error.config.update("Boost! Attachment")),t.useBulkUpdate={value:[]});t.useBulkUpdate.value.includes("use")&&"list"==c.viewType?kb.filter.auth(t.permitUser.value,t.permitOrganization.value,t.permitGroup.value).then(F=>{F&&kb.icon.create(f.mobile,f.type,"kb-attachment-button","refresh",()=>{kb.record.builder.build(Object.values(f.fieldInfos.placed).reduce((d,n)=>{f.fieldInfos.disables.includes(n.code)||n.tableCode||(d[n.code]=n);return d},{}),null,d=>{kb.view.records.get(f.app.id,
(f.mobile?kintone.mobile.app:kintone.app).getQueryCondition()).then(n=>{0!=n.length?kb.confirm(kb.constants.common.message.confirm.submit[kb.operator.language],()=>{kb.view.records.set(f.app.id,{put:n.map(u=>({id:u.$id.value,record:kb.extend({},d)}))}).then(u=>kb.alert("Done!",()=>window.location.reload(!0))).catch(u=>kb.alert(kb.error.parse(u)))}):kb.alert("There are no records.")}).catch(n=>kb.alert(kb.error.parse(n)))})});C()}).catch(F=>C()):C()})(JSON.parse(x.flat))}catch(t){kb.alert(kb.error.parse(t)),
r(c)}}).catch(v=>r(c)):r(c)}).catch(x=>r(c))})("mobile"==c.type.split(".").first(),c.type.split(".").slice(-2).first())}));kintone.events.on(["app.report.show","mobile.app.report.show"],c=>new Promise((r,E)=>{((z,B)=>{f.mobile=z;f.type=B;kb.config[D].config.get().then(x=>{if(0!=Object.keys(x).length)try{var v=JSON.parse(x.flat);"usePivotTranspose"in v||(kb.alert(kb.error.config.update("Boost! Attachment")),v.usePivotTranspose={value:[]});v.usePivotTranspose.value.includes("use")&&(kb.elm(".kb-pivottranspose-style")||
kb.elm("head").append(kb.create("style").addClass("kb-pivottranspose-style").attr("media","screen").attr("type","text/css").text("\n.gaia-report-crosstable{\n\tborder:1px solid #e3e7e8;\n\tborder-collapse:collapse;\n\tborder-spacing:0;\n\twriting-mode:vertical-lr;\n}\n.gaia-report-crosstable :is(colgroup,tr){\n\tbackground-color:transparent !important;\n\tborder:none !important;\n}\n.gaia-report-crosstable tr :is(td,th){\n\tborder:1px solid #e3e7e8;\n\twriting-mode:horizontal-tb;\n\twhite-space:nowrap;\n}\n.gaia-report-crosstable tr>td:first-child{\n\tbackground-color:transparent !important;\n}\n.gaia-report-crosstable .gaia-report-crosstable-row-group .gaia-report-crosstable-groupname{\n\tbackground-color:transparent !important;\n}\n.gaia-report-crosstable .gaia-report-crosstable-row-total .gaia-report-crosstable-groupname{\n\tbackground-color:transparent !important;\n}\n.gaia-report-crosstable .gaia-report-crosstable-row-subtotal .gaia-report-crosstable-groupvalue{\n\tbackground-color:transparent !important;\n}\n.gaia-report-crosstable:has(td[rowspan]) .gaia-report-crosstable-row-group>td:nth-child(2n+1){\n\tbackground-color:#f5f5f5;\n}\n.gaia-report-crosstable:has(td[rowspan]) .gaia-report-crosstable-row-total>td:nth-child(2n+1){\n\tbackground-color:#f5f5f5;\n}\n.gaia-report-crosstable:has(td[rowspan]) .gaia-report-crosstable-row-subtotal:has(td[rowspan])>td:nth-child(2n+1){\n\tbackground-color:#f5f5f5;\n}\n.gaia-report-crosstable:has(td[rowspan]) .gaia-report-crosstable-row-subtotal:not(:has(td[rowspan]))>td:nth-child(2n){\n\tbackground-color:#f5f5f5;\n}\n.gaia-report-crosstable:not(:has(td[rowspan])) .gaia-report-crosstable-row-group>td:nth-child(2n){\n\tbackground-color:#f5f5f5;\n}\n.gaia-report-crosstable:not(:has(td[rowspan])) .gaia-report-crosstable-row-total>td:nth-child(2n){\n\tbackground-color:#f5f5f5;\n}\n.gaia-report-crosstable:not(:has(td[rowspan])) .gaia-report-crosstable-row-subtotal>td:nth-child(2n){\n\tbackground-color:#f5f5f5;\n}\n")));
r(c)}catch(t){kb.alert(kb.error.parse(t)),r(c)}else r(c)}).catch(x=>r(c))})("mobile"==c.type.split(".").first(),c.type.split(".").slice(-2).first())}));kb.event.on("kb.attachment.call",c=>new Promise((r,E)=>{kb.config[D].config.get().then(z=>{if(0!=Object.keys(z).length)try{(B=>{switch(c.mode){case "download":c.downloadable=B.useAttachmentViewer.value.includes("use")?!B.onlyView.value.includes("onlyView"):!0;break;case "placeholder":B.usePlaceholder.value.includes("use")&&(x=>{B.placeholders.value.map(v=>
v.value).each((v,t)=>{v.field.value in x&&(t=x[v.field.value],t.tableCode?c.fields[t.tableCode].fields[t.code].placeholder=v.text.value:c.fields[t.code].placeholder=v.text.value)})})(kb.field.parallelize(c.fields))}r(c)})(JSON.parse(z.flat))}catch(B){kb.alert(kb.error.parse(B)),r(c)}else r(c)}).catch(z=>r(c))}))})(kintone.$PLUGIN_ID);