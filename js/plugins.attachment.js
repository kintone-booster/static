/*
* FileName "plugins.attachment.js"
* Version: 1.0.0
* Copyright (c) 2023 Pandafirm LLC
* Distributed under the terms of the GNU Lesser General Public License.
* https://opensource.org/licenses/LGPL-2.1
*/
'use strict';(E=>{var d={handlers:{}},J=c=>{var q={};if(c.useMultiline.value.includes("use")&&!d.mobile)for(var F in d.fieldInfos.tables)(A=>{var B=Object.keys(A.fields).filter(v=>c.multilines.value.map(t=>t.value.field.value).includes(v));B.length!=0&&(q[A.id]={tableInfo:A,lines:Object.keys(A.fields).reduce((v,t)=>{B.includes(t)&&v.last().length!=0&&v.push([]);v.last().push(d.fieldInfos.parallelize[t].id);return v},[[]])})})(d.fieldInfos.tables[F]);return[c,q]},G=(c,q,F)=>{["create","edit"].includes(d.type)&&
((A,B)=>{kintone.events.on(A,B);A.each((v,t)=>{v in d.handlers||(d.handlers[v]=[]);d.handlers[v].push(B)})})(["app.record.create.change."+c.code,"app.record.edit.change."+c.code],F);if(kb.elms(".subtable-"+c.id+" tbody tr").length!=q[c.code].value.length&&q[c.code].value.length!=0){let A=new MutationObserver(()=>{kb.elms(".subtable-"+c.id+" tbody tr").length==q[c.code].value.length&&(F({record:q}),A.disconnect())});A.observe(kb.elm(".subtable-"+c.id),{childList:!0,subtree:!0})}else F({record:q})};
kintone.events.on(["app.record.create.show","app.record.edit.show","mobile.app.record.create.show","mobile.app.record.edit.show"],c=>new Promise((q,F)=>{((A,B)=>{d.mobile=A;d.type=B;for(var v in d.handlers)d.handlers[v].each((t,u)=>{kintone.events.off(v,t)});kb.config[E].config.get().then(t=>{Object.keys(t).length!=0?kb.field.load(kb.config[E].app,!0).then(u=>{d.app={id:kb.config[E].app,fields:u.origin};d.fieldInfos=u;try{(([C,D])=>{C.useLookupNavi.value.includes("use")&&Object.values(d.fieldInfos.parallelize).filter(e=>
e.lookup).each((e,x)=>{(h=>{e.tableCode?G(d.fieldInfos.tables[e.tableCode],c.record,h):h({record:c.record})})(h=>{(n=>{n&&(Array.isArray(n)?n:[n]).each((l,k)=>{l.value.parentNode.elm(".kb-attachment-lookup-operation")||l.value.parentNode.css({alignItems:"center"}).insertBefore(kb.create("button").addClass("kb-icon kb-icon-open kb-attachment-lookup-operation").on("click",a=>{((y,b)=>{y?kb.view.records.get(b,kb.filter.query.create({code:e.lookup.relatedKeyField},"=",{type:e.type,value:y})).then(f=>
{f.length!=0&&window.open(kb.record.page.detail(d.mobile,b,f.first().$id.value))}).catch(f=>kb.alert(kb.error.parse(f))):window.open(kb.record.page.add(d.mobile,b))})(l.value.elm("input[type=text]").val(),e.lookup.relatedApp.app)}),l.value.nextSibling)})})(kb.field.get(e,d.mobile,d.type))})});C.usePlaceholder.value.includes("use")&&C.placeholders.value.map(e=>e.value).each((e,x)=>{e.field.value in d.fieldInfos.parallelize&&(h=>{(n=>{h.tableCode?G(d.fieldInfos.tables[h.tableCode],c.record,n):n({record:c.record})})(n=>
{(l=>{l&&(Array.isArray(l)?l:[l]).each((k,a)=>{d.mobile?k.value.attr("placeholder",e.text.value):k.value.elm("input[type=text],textarea").attr("placeholder",e.text.value)})})(kb.field.get(h,d.mobile,d.type))})})(d.fieldInfos.parallelize[e.field.value])});C.useAlignTableButtons.value.includes("use")&&!d.mobile&&Object.values(u.tables).filter(e=>!Object.keys(D).includes(e.id)).each((e,x)=>{((h,n)=>{(l=>{l.prepend(l.elm('[class^="subtable-operation-gaia"]'))})(n.addClass("kb-attachment-subtable-operation").elm("thead").elm("tr"));
G(h,c.record,l=>{n.elms("tbody tr").each((k,a)=>{Array.from(k.elms("td").last().classList).some(y=>y.startsWith("subtable-operation-gaia"))&&k.prepend(k.elm('[class^="subtable-operation-gaia"]'))})})})(e,kb.elm(".subtable-"+e.id))});if(C.useMultiline.value.includes("use")&&!d.mobile)for(var p in D)((e,x)=>{var h=(n,l,k)=>{l.elms("tr").each((a,y)=>{a.hasClass("kb-attachment-subtable-multi")||(b=>{C.useAlignTableButtons.value.includes("use")?a.addClass("kb-attachment-subtable-multi").append(b):a.addClass("kb-attachment-subtable-multi").prepend(b);
n.lines.each((f,r)=>{b.append((m=>{f.each((w,g)=>{var z={};g==f.length-1&&(z.flex="1");k?w?m.append(a.elm(".label-"+w).addClass("kb-attachment-subtable-multi-cell").css(z)):m.append(kb.create("th").addClass("subtable-label-gaia kb-attachment-subtable-multi-cell").css(z)):(z.width=x.elm("thead").elm(".label-"+w).css("width"),w?m.append(a.elm(".field-"+w).closest("td").addClass("kb-attachment-subtable-multi-cell").css(z)):m.append(kb.create("td").addClass("kb-attachment-subtable-multi-cell").css(z)))});
return m})(kb.create("div").css({alignItems:"center",display:"flex"})))})})(k?kb.create("th").addClass("subtable-label-gaia"):kb.create("td"))})};C.useAlignTableButtons.value.includes("use")&&x.addClass("kb-attachment-subtable-operation");h(e,x.elm("thead"),!0);G(e.tableInfo,c.record,n=>{h(e,x.elm("tbody"),!1)})})(D[p],kb.elm(".subtable-"+D[p].tableInfo.id))})(J(JSON.parse(t.flat))),q(c)}catch(C){kb.alert(kb.error.parse(C)),q(c)}}).catch(u=>q(c)):q(c)}).catch(t=>q(c))})(c.type.split(".").first()==
"mobile",c.type.split(".").slice(-2).first())}));kintone.events.on(["app.record.detail.show","mobile.app.record.detail.show"],c=>new Promise((q,F)=>{((A,B)=>{d.mobile=A;d.type=B;kb.config[E].config.get().then(v=>{Object.keys(v).length!=0?kb.field.load(kb.config[E].app,!0).then(t=>{d.app={id:kb.config[E].app,fields:t.origin};d.fieldInfos=t;try{(([u,C])=>{u.useAttachmentViewer.value.includes("use")&&Object.values(d.fieldInfos.parallelize).filter(p=>p.type=="FILE").each((p,e)=>{(x=>{p.tableCode?G(d.fieldInfos.tables[p.tableCode],
c.record,x):x({record:c.record})})(x=>{(h=>{h&&(Array.isArray(h)?h:[h]).each((n,l)=>{(k=>{(d.mobile?kb.children(n.value):n.value.elm("ul").elms("li")).each((a,y)=>{a.elm("a")&&(b=>{b.length!=0&&(a.prepend(kb.create("span").addClass("kb-attachment-file-operation").html(b.first().name).on("click",f=>kb.attachment.show(b.first(),!u.onlyView.value.includes("onlyView")))),k=k.filter(f=>f!=b.first()))})(k.filter(b=>b.name==a.elm("a").html()))})})(p.tableCode?x.record[p.tableCode].value[l].value[p.code].value:
x.record[p.code].value)})})(kb.field.get(p,d.mobile,d.type))})});if(u.useMultiline.value.includes("use")&&!d.mobile)for(var D in C)((p,e)=>{var x=(h,n,l)=>{n.elms("tr").each((k,a)=>{k.hasClass("kb-attachment-subtable-multi")||(y=>{k.addClass("kb-attachment-subtable-multi").prepend(y);h.lines.each((b,f)=>{y.append((r=>{b.each((m,w)=>{var g={};w==b.length-1&&(g.flex="1");l?m?r.append(k.elm(".label-"+m).addClass("kb-attachment-subtable-multi-cell").css(g)):r.append(kb.create("th").addClass("subtable-label-gaia kb-attachment-subtable-multi-cell").css(g)):
(g.width=e.elm("thead").elm(".label-"+m).css("width"),m?r.append(k.elm(".field-"+m).closest("td").addClass("kb-attachment-subtable-multi-cell").css(g)):r.append(kb.create("td").addClass("kb-attachment-subtable-multi-cell").css(g)))});return r})(kb.create("div").css({alignItems:"center",display:"flex"})))})})(l?kb.create("th").addClass("subtable-label-gaia"):kb.create("td"))})};x(p,e.elm("thead"),!0);G(p.tableInfo,c.record,h=>{x(p,e.elm("tbody"),!1)})})(C[D],kb.elm(".subtable-"+C[D].tableInfo.id))})(J(JSON.parse(v.flat))),
q(c)}catch(u){kb.alert(kb.error.parse(u)),q(c)}}).catch(t=>q(c)):q(c)}).catch(v=>q(c))})(c.type.split(".").first()=="mobile",c.type.split(".").slice(-2).first())}));kintone.events.on(["app.record.index.show","mobile.app.record.index.show"],c=>new Promise((q,F)=>{((A,B)=>{d.mobile=A;d.type=B;kb.config[E].config.get().then(v=>{Object.keys(v).length!=0?kb.field.load(kb.config[E].app,!0).then(t=>{d.app={id:kb.config[E].app,fields:t.origin};d.fieldInfos=t;try{(u=>{var C=()=>{u.useSearchBox.value.includes("use")&&
c.viewType=="list"?kb.view.load(d.app.id).then(D=>{(p=>{kb.roleSet.user.length==0?kb.roleSet.load().then(()=>p()):p()})(()=>{(p=>{var e=(()=>{var h={},n={},l=(a=>Object.keys(a).reduce((y,b)=>{a[b]!="NONE"&&y.push(b);return y},[]))(cybozu.data.page.FIELD_ACCESSIBILITY||cybozu.data.page.FIELD_ACCESS_CONTROL.right.fields),k=a=>{var y={CREATED_AT:"CREATED_TIME",DECIMAL:"NUMBER",EDITOR:"RICH_TEXT",MODIFIED_AT:"UPDATED_TIME",MULTIPLE_CHECK:"CHECK_BOX",MULTIPLE_SELECT:"MULTI_SELECT",MULTIPLE_LINE_TEXT:"MULTI_LINE_TEXT",
RECORD_ID:"RECORD_NUMBER",SINGLE_CHECK:"RADIO_BUTTON",SINGLE_SELECT:"DROP_DOWN"};return a in y?y[a]:a};Object.values(cybozu.data.page.FORM_DATA.schema.table.fieldList).each((a,y)=>{if(l.includes(a.id))if(a.type=="REFERENCE_TABLE")n[a.id]=a.var;else switch(h[a.var]={id:"f"+a.id,type:k(a.type)},h[a.var].type){case "CHECK_BOX":case "DROP_DOWN":case "MULTI_SELECT":case "RADIO_BUTTON":h[a.var].option=(()=>{var b={};"options"in a.properties&&Array.isArray(a.properties.options)&&a.properties.options.each((f,
r)=>{f.valid&&(b[f.label]=f.id)});return b})();break;case "STATUS":h[a.var].status=(()=>{var b={};(f=>{(typeof f.useStatus==="string"?f.useStatus=="true":f.useStatus)&&f.states.each((r,m)=>{r.valid&&(b[r.label]=r.id)})})(cybozu.data.page.STATUS_DATA);return b})()}});Object.values(cybozu.data.page.FORM_DATA.schema.subTable).map(a=>Object.values(a.fieldList)).flat().each((a,y)=>{if(l.includes(a.id))switch(h[a.var]={id:"f"+a.id,type:k(a.type)},h[a.var].type){case "CHECK_BOX":case "DROP_DOWN":case "MULTI_SELECT":case "RADIO_BUTTON":h[a.var].option=
(()=>{var b={};"options"in a.properties&&Array.isArray(a.properties.options)&&a.properties.options.each((f,r)=>{f.valid&&(b[f.label]=f.id)});return b})()}});cybozu.data.page.FORM_DATA.referenceTables.each((a,y)=>{a.masterApp.schema&&l.includes(a.fieldId)&&((b,f,r)=>{Object.values(a.masterApp.schema.table.fieldList).each((m,w)=>{if(!b.includes(m.id))switch(h[n[f]+"."+m.var]={id:"f"+f+".f"+m.id,type:k(m.type)},h[n[f]+"."+m.var].type){case "CHECK_BOX":case "DROP_DOWN":case "MULTI_SELECT":case "RADIO_BUTTON":h[n[f]+
"."+m.var].option=(()=>{var g={};"options"in m.properties&&Array.isArray(m.properties.options)&&m.properties.options.each((z,I)=>{z.valid&&(g[z.label]=z.id)});return g})();break;case "STATUS":h[n[f]+"."+m.var].status=(()=>{var g={};(typeof r.useStatus==="string"?r.useStatus=="true":r.useStatus)&&r.states.each((z,I)=>{z.valid&&(g[z.label]=z.id)});return g})()}})})(a.masterApp.unAccessibleFieldIds,a.fieldId,a.masterApp.status)});return h})(),x={build:h=>{var n=p.filterCond.match(/ and /g)?" and ":" or ",
l=p.filterCond.split(n).filter(a=>a),k=(a,y)=>{l.length!=0?(b=>{if(b.info){var f=RegExp("[/\\\\^$*+?.()|[\\]{}]","g"),r=function(w){var g={groups:[],organizations:[],users:[]},z="";w.match(/ in /g)&&(I=>{I.each((H,K)=>{if(H.replace(/^[ ]+/g,"").replace(/[ ]+$/g,"").match(/^"/g))switch(H=H.replace(/^[ "]+/g,"").replace(/[ "]+$/g,""),H){case "GROUP":z="groups";break;case "ORGANIZATION":z="organizations";break;case "USER":z="users";break;default:z||="users",g[z].push(H)}})})(w.split(" in ").last().replace(/^\(/g,
"").replace(/\)$/g,"").split(","));return g};switch(b.info.type){case "CHECK_BOX":case "DROP_DOWN":case "MULTI_SELECT":case "RADIO_BUTTON":for(var m in b.info.option)b.query.match(new RegExp('"'+m.replace(f,"\\$&")+'"'))&&(b.query=b.query.replace(new RegExp('"'+m.replace(f,"\\$&")+'"'),'"'+b.info.option[m]+'"'));break;case "CREATOR":case "MODIFIER":case "USER_SELECT":(w=>{kb.roleSet.group.filter(g=>w.groups.includes(g.code.value)).each((g,z)=>{b.query.match(new RegExp('"'+g.code.value.replace(f,"\\$&")+
'"'))&&(b.query=b.query.replace(new RegExp('"'+g.code.value.replace(f,"\\$&")+'"'),'"'+g.info.id+'"'))});kb.roleSet.organization.filter(g=>w.organizations.includes(g.code.value)).each((g,z)=>{b.query.match(new RegExp('"'+g.code.value.replace(f,"\\$&")+'"'))&&(b.query=b.query.replace(new RegExp('"'+g.code.value.replace(f,"\\$&")+'"'),'"'+g.info.id+'"'))});kb.roleSet.user.filter(g=>w.users.includes(g.code.value)).each((g,z)=>{b.query.match(new RegExp('"'+g.code.value.replace(f,"\\$&")+'"'))&&(b.query=
b.query.replace(new RegExp('"'+g.code.value.replace(f,"\\$&")+'"'),'"'+g.info.id+'"'))})})(r(b.query));break;case "GROUP_SELECT":(w=>{kb.roleSet.group.filter(g=>w.groups.includes(g.code.value)).each((g,z)=>{b.query.match(new RegExp('"'+g.code.value.replace(f,"\\$&")+'"'))&&(b.query=b.query.replace(new RegExp('"'+g.code.value.replace(f,"\\$&")+'"'),'"'+g.info.id+'"'))})})(r(b.query));break;case "ORGANIZATION_SELECT":(w=>{kb.roleSet.organization.filter(g=>w.organizations.includes(g.code.value)).each((g,
z)=>{b.query.match(new RegExp('"'+g.code.value.replace(f,"\\$&")+'"'))&&(b.query=b.query.replace(new RegExp('"'+g.code.value.replace(f,"\\$&")+'"'),'"'+g.info.id+'"'))})})(r(b.query));break;case "STATUS":for(m in b.info.status)b.query.match(new RegExp('"'+m.replace(f,"\\$&")+'"'))&&(b.query=b.query.replace(new RegExp('"'+m.replace(f,"\\$&")+'"'),'"'+b.info.status[m]+'"'))}l[a]=b.query}else l[a]="";a++;a<l.length?k(a,y):y(l.filter(w=>w).join(n))})((b=>{var f={info:null,query:""};b.length>1&&b.last()in
e&&(f.info=e[b.last()],f.query=l[a].replace(new RegExp(b.last().replace(/[\/\\^$*+?.()|\[\]{}]/g,"\\$&")),f.info.id));return f})(l[a].match(/^([^ ]+)/))):y("")};k(0,a=>{h(a)})},search:h=>{var n=kb.elm(".kb-attachment-search-operation").elm(".kb-keyword").elm("input"),l=kb.elm(".kb-attachment-search-operation").elm(".kb-target").elm("select"),k=kintone.api.url("/k/",!0).replace(/\.json/g,"")+(d.mobile?"m/"+d.app.id:d.app.id)+"/?view="+c.viewId.toString();if(n.val()){var a=(y=>{var b=(l.val()?[p.fields[l.val()]]:
Object.values(p.fields)).reduce((f,r)=>{f.push(y.map(m=>{var w=m.match(/^!/g);m=m.replace(/^!/g,"");var g="";if(m=="EMPTY")switch(r.type){case "CHECK_BOX":case "DROP_DOWN":case "MULTI_SELECT":case "RADIO_BUTTON":case "STATUS":g=e[r.code].id+(w?" not":"")+' in ("")';break;case "FILE":case "LINK":case "MULTI_LINE_TEXT":case "RICH_TEXT":case "SINGLE_LINE_TEXT":g=e[r.code].id+(w?" !":" ")+'= ""'}else switch(r.type){case "CHECK_BOX":case "DROP_DOWN":case "MULTI_SELECT":case "RADIO_BUTTON":m in e[r.code].option&&
(g=e[r.code].id+(w?" not":"")+' in ("'+e[r.code].option[m].replace(/"/g,'\\"')+'")');break;case "FILE":case "LINK":case "MULTI_LINE_TEXT":case "RICH_TEXT":case "SINGLE_LINE_TEXT":g=e[r.code].id+(w?" not":"")+' like "'+m.replace(/"/g,'\\"')+'"';break;case "STATUS":m in e[r.code].status&&(g=e[r.code].id+(w?" not":"")+' in ("'+e[r.code].status[m].replace(/"/g,'\\"')+'")')}return g}).join(" or "));return f.filter(m=>m)},[]).map(f=>"("+f+")");return h?["("+h+")"].concat(b.join(" or ")).join(" and "):b.join(" or ")})(n.val().split(/[ \u3000]/).filter(y=>
y));window.location.href=a?k+"&keyword="+n.val()+"&target="+l.val()+"&q="+encodeURIComponent(a):k}else window.location.href=k}};p.fields=p.fields.reduce((h,n)=>{if(n in e)switch(d.fieldInfos.parallelize[n].type){case "CHECK_BOX":case "DROP_DOWN":case "FILE":case "LINK":case "MULTI_LINE_TEXT":case "MULTI_SELECT":case "RADIO_BUTTON":case "RICH_TEXT":case "SINGLE_LINE_TEXT":h[n]=d.fieldInfos.parallelize[n]}return h},{});Object.keys(p.fields).length!=0?x.build(h=>{(n=>{n.elm(".kb-attachment-search-operation")||
(l=>{n.addClass("kb-scope").attr("form-id","form_"+l.id).append(kb.create("div").addClass("kb-attachment-search-operation"+(d.mobile?" kb-mobile":"")).append(kb.field.activate((k=>{k.elm("select").empty().assignOption([{code:"",label:"All"}].concat(Object.values(p.fields).map(a=>({code:a.code,label:a.label}))),"label","code");return k})(kb.field.create(l.fields.target).addClass("kb-target")),l)).append(kb.field.activate(kb.field.create(l.fields.keyword).addClass("kb-keyword"),l)).append(kb.create("button").addClass("kb-icon kb-icon-lookup").on("click",
k=>{x.search(h)})).append(kb.create("button").addClass("kb-icon kb-icon-del").on("click",k=>{k.currentTarget.parentNode.elm(".kb-keyword").elm("input").val("");x.search(h)})));kb.record.set(n,l,(k=>{var a={};"keyword"in k&&(a.keyword={value:k.keyword});"target"in k&&(a.target={value:k.target});return a})(kb.queries()));kb.event.on("kb.change.keyword",k=>{k.container==n&&x.search(h);return k})})({id:"AttachmentSearch",fields:{target:{code:"target",type:"DROP_DOWN",label:"",required:!1,noLabel:!0,options:[{index:0,
label:"open"},{index:1,label:"close"}]},keyword:{code:"keyword",type:"SINGLE_LINE_TEXT",label:"",required:!1,noLabel:!0,placeholder:""}}})})(d.mobile?kintone.mobile.app.getHeaderSpaceElement():kintone.app.getHeaderMenuSpaceElement());q(c)}):q(c)})(D.list.reduce((p,e)=>{e.id==c.viewId.toString()&&(p=e);return p},{fields:Object.values(d.fieldInfos.parallelize).reduce((p,e)=>{e.tableCode||p.push(e.code);return p},[]),filterCond:""}))})}):q(c)};"useBulkUpdate"in u||(kb.alert(kb.error.config.update("Boost! Attachment")),
u.useBulkUpdate={value:[]});u.useBulkUpdate.value.includes("use")&&c.viewType=="list"?kb.filter.auth(u.permitUser.value,u.permitOrganization.value,u.permitGroup.value).then(D=>{D&&kb.icon.create(d.mobile,d.type,"kb-attachment-button","refresh",()=>{kb.record.builder.build(Object.values(d.fieldInfos.placed).reduce((p,e)=>{d.fieldInfos.disables.includes(e.code)||e.tableCode||(p[e.code]=e);return p},{}),null,p=>{kb.view.records.get(d.app.id,(d.mobile?kintone.mobile.app:kintone.app).getQueryCondition()).then(e=>
{e.length!=0?kb.confirm(kb.constants.common.message.confirm.submit[kb.operator.language],()=>{kb.view.records.set(d.app.id,{put:e.map(x=>({id:x.$id.value,record:kb.extend({},p)}))}).then(x=>kb.alert("Done!",()=>window.location.reload(!0))).catch(x=>kb.alert(kb.error.parse(x)))}):kb.alert("There are no records.")}).catch(e=>kb.alert(kb.error.parse(e)))})});C()}).catch(D=>C()):C()})(JSON.parse(v.flat))}catch(u){kb.alert(kb.error.parse(u)),q(c)}}).catch(t=>q(c)):q(c)}).catch(v=>q(c))})(c.type.split(".").first()==
"mobile",c.type.split(".").slice(-2).first())}));kintone.events.on(["app.report.show","mobile.app.report.show"],c=>new Promise((q,F)=>{((A,B)=>{d.mobile=A;d.type=B;kb.config[E].config.get().then(v=>{if(Object.keys(v).length!=0)try{var t=JSON.parse(v.flat);"usePivotTranspose"in t||(kb.alert(kb.error.config.update("Boost! Attachment")),t.usePivotTranspose={value:[]});t.usePivotTranspose.value.includes("use")&&(kb.elm(".kb-pivottranspose-style")||kb.elm("head").append(kb.create("style").addClass("kb-pivottranspose-style").attr("media",
"screen").attr("type","text/css").text("\n.gaia-report-crosstable{\n\tborder:1px solid #e3e7e8;\n\tborder-collapse:collapse;\n\tborder-spacing:0;\n\twriting-mode:vertical-lr;\n}\n.gaia-report-crosstable :is(colgroup,tr){\n\tbackground-color:transparent !important;\n\tborder:none !important;\n}\n.gaia-report-crosstable tr :is(td,th){\n\tborder:1px solid #e3e7e8;\n\twriting-mode:horizontal-tb;\n\twhite-space:nowrap;\n}\n.gaia-report-crosstable tr>td:first-child{\n\tbackground-color:transparent !important;\n}\n.gaia-report-crosstable .gaia-report-crosstable-row-group .gaia-report-crosstable-groupname{\n\tbackground-color:transparent !important;\n}\n.gaia-report-crosstable .gaia-report-crosstable-row-total .gaia-report-crosstable-groupname{\n\tbackground-color:transparent !important;\n}\n.gaia-report-crosstable .gaia-report-crosstable-row-subtotal .gaia-report-crosstable-groupvalue{\n\tbackground-color:transparent !important;\n}\n.gaia-report-crosstable:has(td[rowspan]) .gaia-report-crosstable-row-group>td:nth-child(2n+1){\n\tbackground-color:#f5f5f5;\n}\n.gaia-report-crosstable:has(td[rowspan]) .gaia-report-crosstable-row-total>td:nth-child(2n+1){\n\tbackground-color:#f5f5f5;\n}\n.gaia-report-crosstable:has(td[rowspan]) .gaia-report-crosstable-row-subtotal:has(td[rowspan])>td:nth-child(2n+1){\n\tbackground-color:#f5f5f5;\n}\n.gaia-report-crosstable:has(td[rowspan]) .gaia-report-crosstable-row-subtotal:not(:has(td[rowspan]))>td:nth-child(2n){\n\tbackground-color:#f5f5f5;\n}\n.gaia-report-crosstable:not(:has(td[rowspan])) .gaia-report-crosstable-row-group>td:nth-child(2n){\n\tbackground-color:#f5f5f5;\n}\n.gaia-report-crosstable:not(:has(td[rowspan])) .gaia-report-crosstable-row-total>td:nth-child(2n){\n\tbackground-color:#f5f5f5;\n}\n.gaia-report-crosstable:not(:has(td[rowspan])) .gaia-report-crosstable-row-subtotal>td:nth-child(2n){\n\tbackground-color:#f5f5f5;\n}\n")));
q(c)}catch(u){kb.alert(kb.error.parse(u)),q(c)}else q(c)}).catch(v=>q(c))})(c.type.split(".").first()=="mobile",c.type.split(".").slice(-2).first())}));kb.event.on("kb.attachment.call",c=>new Promise((q,F)=>{kb.config[E].config.get().then(A=>{if(Object.keys(A).length!=0)try{(B=>{switch(c.mode){case "download":c.downloadable=B.useAttachmentViewer.value.includes("use")?!B.onlyView.value.includes("onlyView"):!0;break;case "placeholder":B.usePlaceholder.value.includes("use")&&(v=>{B.placeholders.value.map(t=>
t.value).each((t,u)=>{t.field.value in v&&(u=v[t.field.value],u.tableCode?c.fields[u.tableCode].fields[u.code].placeholder=t.text.value:c.fields[u.code].placeholder=t.text.value)})})(kb.field.parallelize(c.fields))}q(c)})(JSON.parse(A.flat))}catch(B){kb.alert(kb.error.parse(B)),q(c)}else q(c)}).catch(A=>q(c))}))})(kintone.$PLUGIN_ID);