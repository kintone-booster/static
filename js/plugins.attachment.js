/*
* FileName "plugins.attachment.js"
* Version: 1.0.0
* Copyright (c) 2023 Pandafirm LLC
* Distributed under the terms of the GNU Lesser General Public License.
* https://opensource.org/licenses/LGPL-2.1
*/
'use strict';(D=>{var e={},J=c=>{var q={};if(c.useMultiline.value.includes("use")&&!e.mobile)for(var E in e.fieldInfos.tables)(z=>{var B=Object.keys(z.fields).filter(w=>c.multilines.value.map(u=>u.value.field.value).includes(w));0!=B.length&&(w=>{q[z.id]={tableInfo:z,colspans:(u=>w.map(r=>u-r.length))(Math.max(...w.map(u=>u.length))),lines:w}})(Object.keys(z.fields).reduce((w,u)=>{B.includes(u)&&0!=w.last().length&&w.push([]);w.last().push(e.fieldInfos.parallelize[u].id);return w},[[]]))})(e.fieldInfos.tables[E]);
return[c,q]},G=(c,q,E)=>{if(["create","edit"].includes(e.type))kintone.events.on(["app.record.create.change."+c.code,"app.record.edit.change."+c.code],E);if(kb.elms(".subtable-"+c.id+" tbody tr").length!=q[c.code].value.length){let z=new MutationObserver(()=>{kb.elms(".subtable-"+c.id+" tbody tr").length==q[c.code].value.length&&(E({record:q}),z.disconnect())});z.observe(kb.elm(".subtable-"+c.id),{childList:!0,subtree:!0})}else E({record:q})};kintone.events.on(["app.record.create.show","app.record.edit.show",
"mobile.app.record.create.show","mobile.app.record.edit.show"],c=>new Promise((q,E)=>{((z,B)=>{e.mobile=z;e.type=B;kb.config[D].config.get().then(w=>{0!=Object.keys(w).length?kb.field.load(kb.config[D].app,!0).then(u=>{e.app={id:kb.config[D].app,fields:u.origin};e.fieldInfos=u;try{(([r,C])=>{r.useLookupNavi.value.includes("use")&&Object.values(e.fieldInfos.parallelize).filter(d=>d.lookup).each((d,m)=>{(v=>{d.tableCode?G(e.fieldInfos.tables[d.tableCode],c.record,v):v({record:c.record})})(v=>{(g=>{g&&
(Array.isArray(g)?g:[g]).each((l,n)=>{l.value.parentNode.elm(".kb-attachment-lookup-operation")||l.value.parentNode.css({alignItems:"center"}).insertBefore(kb.create("button").addClass("kb-icon kb-icon-open kb-attachment-lookup-operation").on("click",p=>{((b,y)=>{b?kb.view.records.get(y,kb.filter.query.create({code:d.lookup.relatedKeyField},"=",{type:d.type,value:b})).then(a=>{0!=a.length&&window.open(kb.record.page.detail(e.mobile,y,a.first().$id.value))}).catch(a=>kb.alert(kb.error.parse(a))):window.open(kb.record.page.add(e.mobile,
y))})(l.value.elm("input[type=text]").val(),d.lookup.relatedApp.app)}),l.value.nextSibling)})})(kb.field.get(d,e.mobile,e.type))})});r.usePlaceholder.value.includes("use")&&r.placeholders.value.map(d=>d.value).each((d,m)=>{d.field.value in e.fieldInfos.parallelize&&(v=>{(g=>{v.tableCode?G(e.fieldInfos.tables[v.tableCode],c.record,g):g({record:c.record})})(g=>{(l=>{l&&(Array.isArray(l)?l:[l]).each((n,p)=>{e.mobile?n.value.attr("placeholder",d.text.value):n.value.elm("input[type=text],textarea").attr("placeholder",
d.text.value)})})(kb.field.get(v,e.mobile,e.type))})})(e.fieldInfos.parallelize[d.field.value])});r.useAlignTableButtons.value.includes("use")&&!e.mobile&&Object.values(u.tables).filter(d=>!Object.keys(C).includes(d.id)).each((d,m)=>{((v,g)=>{(l=>{l.prepend(l.elm(".subtable-operation-gaia"))})(g.addClass("kb-attachment-subtable-operation").elm("thead").elm("tr"));G(v,c.record,l=>{g.elms("tbody tr").each((n,p)=>{n.elms("td").last().hasClass("subtable-operation-gaia")&&n.prepend(n.elm(".subtable-operation-gaia"))})})})(d,
kb.elm(".subtable-"+d.id))});if(r.useMultiline.value.includes("use")&&!e.mobile)for(var F in C)((d,m)=>{var v=(g,l,n)=>{l.elms("tr").each((p,b)=>{p.hasClass("kb-attachment-subtable-multi")||((y,a)=>{g.lines.each((f,t)=>{0==t?r.useAlignTableButtons.value.includes("use")&&a.prepend(a.elm(".subtable-operation-gaia")):(l.insertBefore((h=>{r.useAlignTableButtons.value.includes("use")&&(n?h.append(kb.create("th").addClass("subtable-operation-gaia")):h.append(kb.create("td").addClass("subtable-operation-gaia")));
f.each((x,k)=>{n?x?h.append(y.elm(".label-"+x)):h.append(kb.create("th").addClass("subtable-label-gaia")):x?h.append(y.elm(".field-"+x).closest("td")):h.append(kb.create("td"))});return h})(kb.create("tr").addClass("kb-attachment-subtable-multi")),a.nextSibling),a=a.nextSibling);0!=g.colspans[t]&&(h=>{n?a.elm(".label-"+f.last()).attr("colspan",h):a.elm(".field-"+f.last()).closest("td").attr("colspan",h)})((g.colspans[t]+1).toString())})})(p.addClass("kb-attachment-subtable-multi"),p.addClass("kb-attachment-subtable-multi"))})};
r.useAlignTableButtons.value.includes("use")&&m.addClass("kb-attachment-subtable-operation");v(d,m.elm("thead"),!0);G(d.tableInfo,c.record,g=>{v(d,m.elm("tbody"),!1)})})(C[F],kb.elm(".subtable-"+C[F].tableInfo.id))})(J(JSON.parse(w.flat))),q(c)}catch(r){kb.alert(kb.error.parse(r)),q(c)}}).catch(u=>q(c)):q(c)}).catch(w=>q(c))})("mobile"==c.type.split(".").first(),c.type.split(".").slice(-2).first())}));kintone.events.on(["app.record.detail.show","mobile.app.record.detail.show"],c=>new Promise((q,E)=>
{((z,B)=>{e.mobile=z;e.type=B;kb.config[D].config.get().then(w=>{0!=Object.keys(w).length?kb.field.load(kb.config[D].app,!0).then(u=>{e.app={id:kb.config[D].app,fields:u.origin};e.fieldInfos=u;try{(([r,C])=>{r.useAttachmentViewer.value.includes("use")&&Object.values(e.fieldInfos.parallelize).filter(d=>"FILE"==d.type).each((d,m)=>{(v=>{d.tableCode?G(e.fieldInfos.tables[d.tableCode],c.record,v):v({record:c.record})})(v=>{(g=>{g&&(Array.isArray(g)?g:[g]).each((l,n)=>{(p=>{(e.mobile?kb.children(l.value):
l.value.elm("ul").elms("li")).each((b,y)=>{b.elm("a")&&(a=>{0!=a.length&&(b.prepend(kb.create("span").addClass("kb-attachment-file-operation").html(a.first().name).on("click",f=>kb.attachment.show(a.first(),!r.onlyView.value.includes("onlyView")))),p=p.filter(f=>f!=a.first()))})(p.filter(a=>a.name==b.elm("a").html()))})})(d.tableCode?v.record[d.tableCode].value[n].value[d.code].value:v.record[d.code].value)})})(kb.field.get(d,e.mobile,e.type))})});if(r.useMultiline.value.includes("use")&&!e.mobile)for(var F in C)((d,
m)=>{var v=(g,l,n)=>{l.elms("tr").each((p,b)=>{p.hasClass("kb-attachment-subtable-multi")||((y,a)=>{g.lines.each((f,t)=>{0!=t&&(l.insertBefore((h=>{f.each((x,k)=>{n?x?h.append(y.elm(".label-"+x)):h.append(kb.create("th").addClass("subtable-label-gaia")):x?h.append(y.elm(".field-"+x).closest("td")):h.append(kb.create("td"))});return h})(kb.create("tr").addClass("kb-attachment-subtable-multi")),a.nextSibling),a=a.nextSibling);0!=g.colspans[t]&&(h=>{n?a.elm(".label-"+f.last()).attr("colspan",h):a.elm(".field-"+
f.last()).closest("td").attr("colspan",h)})((g.colspans[t]+1).toString())})})(p.addClass("kb-attachment-subtable-multi"),p.addClass("kb-attachment-subtable-multi"))})};v(d,m.elm("thead"),!0);G(d.tableInfo,c.record,g=>{v(d,m.elm("tbody"),!1)})})(C[F],kb.elm(".subtable-"+C[F].tableInfo.id))})(J(JSON.parse(w.flat))),q(c)}catch(r){kb.alert(kb.error.parse(r)),q(c)}}).catch(u=>q(c)):q(c)}).catch(w=>q(c))})("mobile"==c.type.split(".").first(),c.type.split(".").slice(-2).first())}));kintone.events.on(["app.record.index.show",
"mobile.app.record.index.show"],c=>new Promise((q,E)=>{((z,B)=>{e.mobile=z;e.type=B;kb.config[D].config.get().then(w=>{0!=Object.keys(w).length?kb.field.load(kb.config[D].app,!0).then(u=>{e.app={id:kb.config[D].app,fields:u.origin};e.fieldInfos=u;try{(r=>{var C=()=>{r.useSearchBox.value.includes("use")&&"list"==c.viewType?kb.view.load(e.app.id).then(F=>{(d=>{0==kb.roleSet.user.length?kb.roleSet.load().then(()=>d()):d()})(()=>{(d=>{var m=(()=>{var g={},l={},n=(b=>Object.keys(b).reduce((y,a)=>{"NONE"!=
b[a]&&y.push(a);return y},[]))(cybozu.data.page.FIELD_ACCESSIBILITY||cybozu.data.page.FIELD_ACCESS_CONTROL.right.fields),p=b=>{var y={CREATED_AT:"CREATED_TIME",DECIMAL:"NUMBER",EDITOR:"RICH_TEXT",MODIFIED_AT:"UPDATED_TIME",MULTIPLE_CHECK:"CHECK_BOX",MULTIPLE_SELECT:"MULTI_SELECT",MULTIPLE_LINE_TEXT:"MULTI_LINE_TEXT",RECORD_ID:"RECORD_NUMBER",SINGLE_CHECK:"RADIO_BUTTON",SINGLE_SELECT:"DROP_DOWN"};return b in y?y[b]:b};Object.values(cybozu.data.page.FORM_DATA.schema.table.fieldList).each((b,y)=>{if(n.includes(b.id))if("REFERENCE_TABLE"==
b.type)l[b.id]=b.var;else switch(g[b.var]={id:"f"+b.id,type:p(b.type)},g[b.var].type){case "CHECK_BOX":case "DROP_DOWN":case "MULTI_SELECT":case "RADIO_BUTTON":g[b.var].option=(()=>{var a={};"options"in b.properties&&Array.isArray(b.properties.options)&&b.properties.options.each((f,t)=>{f.valid&&(a[f.label]=f.id)});return a})();break;case "STATUS":g[b.var].status=(()=>{var a={};(f=>{("string"===typeof f.useStatus?"true"==f.useStatus:f.useStatus)&&f.states.each((t,h)=>{t.valid&&(a[t.label]=t.id)})})(cybozu.data.page.STATUS_DATA);
return a})()}});Object.values(cybozu.data.page.FORM_DATA.schema.subTable).map(b=>Object.values(b.fieldList)).flat().each((b,y)=>{if(n.includes(b.id))switch(g[b.var]={id:"f"+b.id,type:p(b.type)},g[b.var].type){case "CHECK_BOX":case "DROP_DOWN":case "MULTI_SELECT":case "RADIO_BUTTON":g[b.var].option=(()=>{var a={};"options"in b.properties&&Array.isArray(b.properties.options)&&b.properties.options.each((f,t)=>{f.valid&&(a[f.label]=f.id)});return a})()}});cybozu.data.page.FORM_DATA.referenceTables.each((b,
y)=>{b.masterApp.schema&&n.includes(b.fieldId)&&((a,f,t)=>{Object.values(b.masterApp.schema.table.fieldList).each((h,x)=>{if(!a.includes(h.id))switch(g[l[f]+"."+h.var]={id:"f"+f+".f"+h.id,type:p(h.type)},g[l[f]+"."+h.var].type){case "CHECK_BOX":case "DROP_DOWN":case "MULTI_SELECT":case "RADIO_BUTTON":g[l[f]+"."+h.var].option=(()=>{var k={};"options"in h.properties&&Array.isArray(h.properties.options)&&h.properties.options.each((A,I)=>{A.valid&&(k[A.label]=A.id)});return k})();break;case "STATUS":g[l[f]+
"."+h.var].status=(()=>{var k={};("string"===typeof t.useStatus?"true"==t.useStatus:t.useStatus)&&t.states.each((A,I)=>{A.valid&&(k[A.label]=A.id)});return k})()}})})(b.masterApp.unAccessibleFieldIds,b.fieldId,b.masterApp.status)});return g})(),v={build:g=>{var l=d.filterCond.match(/ and /g)?" and ":" or ",n=d.filterCond.split(l).filter(b=>b),p=(b,y)=>{0!=n.length?(a=>{if(a.info){var f=RegExp("[/\\\\^$*+?.()|[\\]{}]","g"),t=function(x){var k={groups:[],organizations:[],users:[]},A="";x.match(/ in /g)&&
(I=>{I.each((H,K)=>{if(H.replace(/^[ ]+/g,"").replace(/[ ]+$/g,"").match(/^"/g))switch(H=H.replace(/^[ "]+/g,"").replace(/[ "]+$/g,""),H){case "GROUP":A="groups";break;case "ORGANIZATION":A="organizations";break;case "USER":A="users";break;default:A||="users",k[A].push(H)}})})(x.split(" in ").last().replace(/^\(/g,"").replace(/\)$/g,"").split(","));return k};switch(a.info.type){case "CHECK_BOX":case "DROP_DOWN":case "MULTI_SELECT":case "RADIO_BUTTON":for(var h in a.info.option)a.query.match(new RegExp('"'+
h.replace(f,"\\$&")+'"'))&&(a.query=a.query.replace(new RegExp('"'+h.replace(f,"\\$&")+'"'),'"'+a.info.option[h]+'"'));break;case "CREATOR":case "MODIFIER":case "USER_SELECT":(x=>{kb.roleSet.group.filter(k=>x.groups.includes(k.code.value)).each((k,A)=>{a.query.match(new RegExp('"'+k.code.value.replace(f,"\\$&")+'"'))&&(a.query=a.query.replace(new RegExp('"'+k.code.value.replace(f,"\\$&")+'"'),'"'+k.info.id+'"'))});kb.roleSet.organization.filter(k=>x.organizations.includes(k.code.value)).each((k,A)=>
{a.query.match(new RegExp('"'+k.code.value.replace(f,"\\$&")+'"'))&&(a.query=a.query.replace(new RegExp('"'+k.code.value.replace(f,"\\$&")+'"'),'"'+k.info.id+'"'))});kb.roleSet.user.filter(k=>x.users.includes(k.code.value)).each((k,A)=>{a.query.match(new RegExp('"'+k.code.value.replace(f,"\\$&")+'"'))&&(a.query=a.query.replace(new RegExp('"'+k.code.value.replace(f,"\\$&")+'"'),'"'+k.info.id+'"'))})})(t(a.query));break;case "GROUP_SELECT":(x=>{kb.roleSet.group.filter(k=>x.groups.includes(k.code.value)).each((k,
A)=>{a.query.match(new RegExp('"'+k.code.value.replace(f,"\\$&")+'"'))&&(a.query=a.query.replace(new RegExp('"'+k.code.value.replace(f,"\\$&")+'"'),'"'+k.info.id+'"'))})})(t(a.query));break;case "ORGANIZATION_SELECT":(x=>{kb.roleSet.organization.filter(k=>x.organizations.includes(k.code.value)).each((k,A)=>{a.query.match(new RegExp('"'+k.code.value.replace(f,"\\$&")+'"'))&&(a.query=a.query.replace(new RegExp('"'+k.code.value.replace(f,"\\$&")+'"'),'"'+k.info.id+'"'))})})(t(a.query));break;case "STATUS":for(h in a.info.status)a.query.match(new RegExp('"'+
h.replace(f,"\\$&")+'"'))&&(a.query=a.query.replace(new RegExp('"'+h.replace(f,"\\$&")+'"'),'"'+a.info.status[h]+'"'))}n[b]=a.query}else n[b]="";b++;b<n.length?p(b,y):y(n.filter(x=>x).join(l))})((a=>{var f={info:null,query:""};1<a.length&&a.last()in m&&(f.info=m[a.last()],f.query=n[b].replace(new RegExp(a.last().replace(/[\/\\^$*+?.()|\[\]{}]/g,"\\$&")),f.info.id));return f})(n[b].match(/^([^ ]+)/))):y("")};p(0,b=>{g(b)})},search:g=>{var l=kb.elm(".kb-attachment-search-operation").elm(".kb-keyword").elm("input"),
n=kb.elm(".kb-attachment-search-operation").elm(".kb-target").elm("select"),p=kintone.api.url("/k/",!0).replace(/\.json/g,"")+(e.mobile?"m/"+e.app.id:e.app.id)+"/?view="+c.viewId.toString();if(l.val()){var b=(y=>{var a=(n.val()?[d.fields[n.val()]]:Object.values(d.fields)).reduce((f,t)=>{f.push(y.map(h=>{var x=h.match(/^!/g);h=h.replace(/^!/g,"");var k="";if("EMPTY"==h)switch(t.type){case "CHECK_BOX":case "DROP_DOWN":case "MULTI_SELECT":case "RADIO_BUTTON":case "STATUS":k=m[t.code].id+(x?" not":"")+
' in ("")';break;case "FILE":case "LINK":case "MULTI_LINE_TEXT":case "RICH_TEXT":case "SINGLE_LINE_TEXT":k=m[t.code].id+(x?" !":" ")+'= ""'}else switch(t.type){case "CHECK_BOX":case "DROP_DOWN":case "MULTI_SELECT":case "RADIO_BUTTON":h in m[t.code].option&&(k=m[t.code].id+(x?" not":"")+' in ("'+m[t.code].option[h].replace(/"/g,'\\"')+'")');break;case "FILE":case "LINK":case "MULTI_LINE_TEXT":case "RICH_TEXT":case "SINGLE_LINE_TEXT":k=m[t.code].id+(x?" not":"")+' like "'+h.replace(/"/g,'\\"')+'"';
break;case "STATUS":h in m[t.code].status&&(k=m[t.code].id+(x?" not":"")+' in ("'+m[t.code].status[h].replace(/"/g,'\\"')+'")')}return k}).join(" or "));return f.filter(h=>h)},[]).map(f=>"("+f+")");return g?["("+g+")"].concat(a.join(" or ")).join(" and "):a.join(" or ")})(l.val().split(/[ \u3000]/).filter(y=>y));window.location.href=b?p+"&keyword="+l.val()+"&target="+n.val()+"&q="+encodeURIComponent(b):p}else window.location.href=p}};d.fields=d.fields.reduce((g,l)=>{if(l in m)switch(e.fieldInfos.parallelize[l].type){case "CHECK_BOX":case "DROP_DOWN":case "FILE":case "LINK":case "MULTI_LINE_TEXT":case "MULTI_SELECT":case "RADIO_BUTTON":case "RICH_TEXT":case "SINGLE_LINE_TEXT":g[l]=
e.fieldInfos.parallelize[l]}return g},{});0!=Object.keys(d.fields).length?v.build(g=>{(l=>{l.elm(".kb-attachment-search-operation")||(n=>{l.addClass("kb-scope").attr("form-id","form_"+n.id).append(kb.create("div").addClass("kb-attachment-search-operation"+(e.mobile?" kb-mobile":"")).append(kb.field.activate((p=>{p.elm("select").empty().assignOption([{code:"",label:"All"}].concat(Object.values(d.fields).map(b=>({code:b.code,label:b.label}))),"label","code");return p})(kb.field.create(n.fields.target).addClass("kb-target")),
n)).append(kb.field.activate(kb.field.create(n.fields.keyword).addClass("kb-keyword"),n)).append(kb.create("button").addClass("kb-icon kb-icon-lookup").on("click",p=>{v.search(g)})).append(kb.create("button").addClass("kb-icon kb-icon-del").on("click",p=>{p.currentTarget.parentNode.elm(".kb-keyword").elm("input").val("");v.search(g)})));kb.record.set(l,n,(p=>{var b={};"keyword"in p&&(b.keyword={value:p.keyword});"target"in p&&(b.target={value:p.target});return b})(kb.queries()));kb.event.on("kb.change.keyword",
p=>{p.container==l&&v.search(g);return p})})({id:"AttachmentSearch",fields:{target:{code:"target",type:"DROP_DOWN",label:"",required:!1,noLabel:!0,options:[{index:0,label:"open"},{index:1,label:"close"}]},keyword:{code:"keyword",type:"SINGLE_LINE_TEXT",label:"",required:!1,noLabel:!0,placeholder:""}}})})(e.mobile?kintone.mobile.app.getHeaderSpaceElement():kintone.app.getHeaderMenuSpaceElement());q(c)}):q(c)})(F.list.reduce((d,m)=>{m.id==c.viewId.toString()&&(d=m);return d},{fields:Object.values(e.fieldInfos.parallelize).reduce((d,
m)=>{m.tableCode||d.push(m.code);return d},[]),filterCond:""}))})}):q(c)};"useBulkUpdate"in r||(kb.alert(kb.error.config.update("Boost! Attachment")),r.useBulkUpdate={value:[]});r.useBulkUpdate.value.includes("use")&&"list"==c.viewType?kb.filter.auth(r.permitUser.value,r.permitOrganization.value,r.permitGroup.value).then(F=>{F&&kb.icon.create(e.mobile,e.type,"kb-attachment-button","refresh",()=>{kb.record.builder.build(Object.values(e.fieldInfos.placed).reduce((d,m)=>{e.fieldInfos.disables.includes(m.code)||
m.tableCode||(d[m.code]=m);return d},{}),null,d=>{kb.view.records.get(e.app.id,(e.mobile?kintone.mobile.app:kintone.app).getQueryCondition()).then(m=>{0!=m.length?kb.confirm(kb.constants.common.message.confirm.submit[kb.operator.language],()=>{kb.view.records.set(e.app.id,{put:m.map(v=>({id:v.$id.value,record:kb.extend({},d)}))}).then(v=>kb.alert("Done!",()=>window.location.reload(!0))).catch(v=>kb.alert(kb.error.parse(v)))}):kb.alert("There are no records.")}).catch(m=>kb.alert(kb.error.parse(m)))})});
C()}).catch(F=>C()):C()})(JSON.parse(w.flat))}catch(r){kb.alert(kb.error.parse(r)),q(c)}}).catch(u=>q(c)):q(c)}).catch(w=>q(c))})("mobile"==c.type.split(".").first(),c.type.split(".").slice(-2).first())}));kintone.events.on(["app.report.show","mobile.app.report.show"],c=>new Promise((q,E)=>{((z,B)=>{e.mobile=z;e.type=B;kb.config[D].config.get().then(w=>{if(0!=Object.keys(w).length)try{var u=JSON.parse(w.flat);"usePivotTranspose"in u||(kb.alert(kb.error.config.update("Boost! Attachment")),u.usePivotTranspose=
{value:[]});u.usePivotTranspose.value.includes("use")&&(kb.elm(".kb-pivottranspose-style")||kb.elm("head").append(kb.create("style").addClass("kb-pivottranspose-style").attr("media","screen").attr("type","text/css").text("\n.gaia-report-crosstable{\n\tborder:1px solid #e3e7e8;\n\tborder-collapse:collapse;\n\tborder-spacing:0;\n\twriting-mode:vertical-lr;\n}\n.gaia-report-crosstable :is(colgroup,tr){\n\tbackground-color:transparent !important;\n\tborder:none !important;\n}\n.gaia-report-crosstable tr :is(td,th){\n\tborder:1px solid #e3e7e8;\n\twriting-mode:horizontal-tb;\n\twhite-space:nowrap;\n}\n.gaia-report-crosstable tr>td:first-child{\n\tbackground-color:transparent !important;\n}\n.gaia-report-crosstable .gaia-report-crosstable-row-group .gaia-report-crosstable-groupname{\n\tbackground-color:transparent !important;\n}\n.gaia-report-crosstable .gaia-report-crosstable-row-total .gaia-report-crosstable-groupname{\n\tbackground-color:transparent !important;\n}\n.gaia-report-crosstable .gaia-report-crosstable-row-subtotal .gaia-report-crosstable-groupvalue{\n\tbackground-color:transparent !important;\n}\n.gaia-report-crosstable:has(td[rowspan]) .gaia-report-crosstable-row-group>td:nth-child(2n+1){\n\tbackground-color:#f5f5f5;\n}\n.gaia-report-crosstable:has(td[rowspan]) .gaia-report-crosstable-row-total>td:nth-child(2n+1){\n\tbackground-color:#f5f5f5;\n}\n.gaia-report-crosstable:has(td[rowspan]) .gaia-report-crosstable-row-subtotal:has(td[rowspan])>td:nth-child(2n+1){\n\tbackground-color:#f5f5f5;\n}\n.gaia-report-crosstable:has(td[rowspan]) .gaia-report-crosstable-row-subtotal:not(:has(td[rowspan]))>td:nth-child(2n){\n\tbackground-color:#f5f5f5;\n}\n.gaia-report-crosstable:not(:has(td[rowspan])) .gaia-report-crosstable-row-group>td:nth-child(2n){\n\tbackground-color:#f5f5f5;\n}\n.gaia-report-crosstable:not(:has(td[rowspan])) .gaia-report-crosstable-row-total>td:nth-child(2n){\n\tbackground-color:#f5f5f5;\n}\n.gaia-report-crosstable:not(:has(td[rowspan])) .gaia-report-crosstable-row-subtotal>td:nth-child(2n){\n\tbackground-color:#f5f5f5;\n}\n")));
q(c)}catch(r){kb.alert(kb.error.parse(r)),q(c)}else q(c)}).catch(w=>q(c))})("mobile"==c.type.split(".").first(),c.type.split(".").slice(-2).first())}));kb.event.on("kb.attachment.call",c=>new Promise((q,E)=>{kb.config[D].config.get().then(z=>{if(0!=Object.keys(z).length)try{(B=>{switch(c.mode){case "download":c.downloadable=B.useAttachmentViewer.value.includes("use")?!B.onlyView.value.includes("onlyView"):!0;break;case "placeholder":B.usePlaceholder.value.includes("use")&&(w=>{B.placeholders.value.map(u=>
u.value).each((u,r)=>{u.field.value in w&&(r=w[u.field.value],r.tableCode?c.fields[r.tableCode].fields[r.code].placeholder=u.text.value:c.fields[r.code].placeholder=u.text.value)})})(kb.field.parallelize(c.fields))}q(c)})(JSON.parse(z.flat))}catch(B){kb.alert(kb.error.parse(B)),q(c)}else q(c)}).catch(z=>q(c))}))})(kintone.$PLUGIN_ID);